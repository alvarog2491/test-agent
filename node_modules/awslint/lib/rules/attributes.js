"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.attributesLinter = void 0;
const resource_1 = require("./resource");
const linter_1 = require("../linter");
exports.attributesLinter = new linter_1.Linter(a => {
    const result = new Array();
    for (const resource of resource_1.ResourceReflection.findAll(a)) {
        for (const attr of resource.attributes) {
            result.push(new AttributeReflection(resource, attr));
        }
    }
    return result;
});
class AttributeReflection {
    resource;
    attr;
    fqn;
    constructor(resource, attr) {
        this.resource = resource;
        this.attr = attr;
        this.fqn = resource.fqn + '.' + attr.property.name;
    }
}
exports.attributesLinter.add({
    code: 'attribute-readonly',
    message: 'attribute property must be readonly',
    eval: e => {
        e.assert(e.ctx.attr.property.immutable, e.ctx.fqn);
    },
});
exports.attributesLinter.add({
    code: 'attribute-tag',
    message: 'attribute properties must have an "@attribute" doctag on: ',
    eval: e => {
        const tag = e.ctx.attr.property.docs.customTag('attribute');
        e.assert(tag, e.ctx.fqn, `${e.ctx.attr.property.parentType.fqn}.${e.ctx.attr.property.name}`);
    },
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXR0cmlidXRlcy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImF0dHJpYnV0ZXMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQUEseUNBQTJEO0FBQzNELHNDQUFtQztBQUV0QixRQUFBLGdCQUFnQixHQUFHLElBQUksZUFBTSxDQUFDLENBQUMsQ0FBQyxFQUFFO0lBQzdDLE1BQU0sTUFBTSxHQUFHLElBQUksS0FBSyxFQUF1QixDQUFDO0lBQ2hELEtBQUssTUFBTSxRQUFRLElBQUksNkJBQWtCLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUM7UUFDckQsS0FBSyxNQUFNLElBQUksSUFBSSxRQUFRLENBQUMsVUFBVSxFQUFFLENBQUM7WUFDdkMsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLG1CQUFtQixDQUFDLFFBQVEsRUFBRSxJQUFJLENBQUMsQ0FBQyxDQUFDO1FBQ3ZELENBQUM7SUFDSCxDQUFDO0lBQ0QsT0FBTyxNQUFNLENBQUM7QUFDaEIsQ0FBQyxDQUFDLENBQUM7QUFFSCxNQUFNLG1CQUFtQjtJQUdLO0lBQThDO0lBRjFELEdBQUcsQ0FBUztJQUU1QixZQUE0QixRQUE0QixFQUFrQixJQUFlO1FBQTdELGFBQVEsR0FBUixRQUFRLENBQW9CO1FBQWtCLFNBQUksR0FBSixJQUFJLENBQVc7UUFDdkYsSUFBSSxDQUFDLEdBQUcsR0FBRyxRQUFRLENBQUMsR0FBRyxHQUFHLEdBQUcsR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQztJQUNyRCxDQUFDO0NBQ0Y7QUFFRCx3QkFBZ0IsQ0FBQyxHQUFHLENBQUM7SUFDbkIsSUFBSSxFQUFFLG9CQUFvQjtJQUMxQixPQUFPLEVBQUUscUNBQXFDO0lBQzlDLElBQUksRUFBRSxDQUFDLENBQUMsRUFBRTtRQUNSLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLFNBQVMsRUFBRSxDQUFDLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQ3JELENBQUM7Q0FDRixDQUFDLENBQUM7QUFFSCx3QkFBZ0IsQ0FBQyxHQUFHLENBQUM7SUFDbkIsSUFBSSxFQUFFLGVBQWU7SUFDckIsT0FBTyxFQUFFLDREQUE0RDtJQUNyRSxJQUFJLEVBQUUsQ0FBQyxDQUFDLEVBQUU7UUFDUixNQUFNLEdBQUcsR0FBRyxDQUFDLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxXQUFXLENBQUMsQ0FBQztRQUM1RCxDQUFDLENBQUMsTUFBTSxDQUFDLEdBQUcsRUFBRSxDQUFDLENBQUMsR0FBRyxDQUFDLEdBQUcsRUFBRSxHQUFHLENBQUMsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxVQUFVLENBQUMsR0FBRyxJQUFJLENBQUMsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDO0lBQ2hHLENBQUM7Q0FDRixDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBdHRyaWJ1dGUsIFJlc291cmNlUmVmbGVjdGlvbiB9IGZyb20gJy4vcmVzb3VyY2UnO1xuaW1wb3J0IHsgTGludGVyIH0gZnJvbSAnLi4vbGludGVyJztcblxuZXhwb3J0IGNvbnN0IGF0dHJpYnV0ZXNMaW50ZXIgPSBuZXcgTGludGVyKGEgPT4ge1xuICBjb25zdCByZXN1bHQgPSBuZXcgQXJyYXk8QXR0cmlidXRlUmVmbGVjdGlvbj4oKTtcbiAgZm9yIChjb25zdCByZXNvdXJjZSBvZiBSZXNvdXJjZVJlZmxlY3Rpb24uZmluZEFsbChhKSkge1xuICAgIGZvciAoY29uc3QgYXR0ciBvZiByZXNvdXJjZS5hdHRyaWJ1dGVzKSB7XG4gICAgICByZXN1bHQucHVzaChuZXcgQXR0cmlidXRlUmVmbGVjdGlvbihyZXNvdXJjZSwgYXR0cikpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gcmVzdWx0O1xufSk7XG5cbmNsYXNzIEF0dHJpYnV0ZVJlZmxlY3Rpb24ge1xuICBwdWJsaWMgcmVhZG9ubHkgZnFuOiBzdHJpbmc7XG5cbiAgY29uc3RydWN0b3IocHVibGljIHJlYWRvbmx5IHJlc291cmNlOiBSZXNvdXJjZVJlZmxlY3Rpb24sIHB1YmxpYyByZWFkb25seSBhdHRyOiBBdHRyaWJ1dGUpIHtcbiAgICB0aGlzLmZxbiA9IHJlc291cmNlLmZxbiArICcuJyArIGF0dHIucHJvcGVydHkubmFtZTtcbiAgfVxufVxuXG5hdHRyaWJ1dGVzTGludGVyLmFkZCh7XG4gIGNvZGU6ICdhdHRyaWJ1dGUtcmVhZG9ubHknLFxuICBtZXNzYWdlOiAnYXR0cmlidXRlIHByb3BlcnR5IG11c3QgYmUgcmVhZG9ubHknLFxuICBldmFsOiBlID0+IHtcbiAgICBlLmFzc2VydChlLmN0eC5hdHRyLnByb3BlcnR5LmltbXV0YWJsZSwgZS5jdHguZnFuKTtcbiAgfSxcbn0pO1xuXG5hdHRyaWJ1dGVzTGludGVyLmFkZCh7XG4gIGNvZGU6ICdhdHRyaWJ1dGUtdGFnJyxcbiAgbWVzc2FnZTogJ2F0dHJpYnV0ZSBwcm9wZXJ0aWVzIG11c3QgaGF2ZSBhbiBcIkBhdHRyaWJ1dGVcIiBkb2N0YWcgb246ICcsXG4gIGV2YWw6IGUgPT4ge1xuICAgIGNvbnN0IHRhZyA9IGUuY3R4LmF0dHIucHJvcGVydHkuZG9jcy5jdXN0b21UYWcoJ2F0dHJpYnV0ZScpO1xuICAgIGUuYXNzZXJ0KHRhZywgZS5jdHguZnFuLCBgJHtlLmN0eC5hdHRyLnByb3BlcnR5LnBhcmVudFR5cGUuZnFufS4ke2UuY3R4LmF0dHIucHJvcGVydHkubmFtZX1gKTtcbiAgfSxcbn0pO1xuIl19