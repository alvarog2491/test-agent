"use strict";
var _a, _b;
Object.defineProperty(exports, "__esModule", { value: true });
exports.Guardrail = exports.GuardrailBase = void 0;
const JSII_RTTI_SYMBOL_1 = Symbol.for("jsii.rtti");
/**
 *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.
 *
 *  Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except in compliance
 *  with the License. A copy of the License is located at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 *  or in the 'license' file accompanying this file. This file is distributed on an 'AS IS' BASIS, WITHOUT WARRANTIES
 *  OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing permissions
 *  and limitations under the License.
 */
const fs = require("fs");
const aws_cdk_lib_1 = require("aws-cdk-lib");
const bedrock = require("aws-cdk-lib/aws-bedrock");
const aws_cloudwatch_1 = require("aws-cdk-lib/aws-cloudwatch");
const iam = require("aws-cdk-lib/aws-iam");
const aws_kms_1 = require("aws-cdk-lib/aws-kms");
const helpers_internal_1 = require("aws-cdk-lib/core/lib/helpers-internal");
/**
 * Abstract base class for a Guardrail.
 * Contains methods and attributes valid for Guardrails either created with CDK or imported.
 */
class GuardrailBase extends aws_cdk_lib_1.Resource {
    /**
     * Return the given named metric for all guardrails.
     *
     * By default, the metric will be calculated as a sum over a period of 5 minutes.
     * You can customize this by using the `statistic` and `period` properties.
     */
    static metricAll(metricName, props) {
        return new aws_cloudwatch_1.Metric({
            namespace: 'AWS/Bedrock/Guardrails',
            dimensionsMap: { Operation: 'ApplyGuardrail' },
            metricName,
            ...props,
        });
    }
    /**
     * Return the invocations metric for all guardrails.
     */
    static metricAllInvocations(props) {
        return this.metricAll('Invocations', props);
    }
    /**
     * Return the text unit count metric for all guardrails.
     */
    static metricAllTextUnitCount(props) {
        return this.metricAll('TextUnitCount', props);
    }
    /**
     * Return the invocations intervened metric for all guardrails.
     */
    static metricAllInvocationsIntervened(props) {
        return this.metricAll('InvocationsIntervened', props);
    }
    /**
     * Return the invocation latency metric for all guardrails.
     */
    static metricAllInvocationLatency(props) {
        return this.metricAll('InvocationLatency', props);
    }
    /**
     * Grant the given principal identity permissions to perform actions on this agent alias.
     */
    grant(grantee, ...actions) {
        return iam.Grant.addToPrincipal({
            grantee,
            actions,
            resourceArns: [this.guardrailArn],
            scope: this,
        });
    }
    /**
     * Grant the given identity permissions to apply the guardrail.
     */
    grantApply(grantee) {
        const baseGrant = this.grant(grantee, 'bedrock:ApplyGuardrail');
        if (this.kmsKey) {
            // If KMS key exists, create encryption grant and combine with base grant
            const kmsGrant = this.kmsKey.grantEncryptDecrypt(grantee);
            return kmsGrant.combine(baseGrant);
        }
        else {
            // If no KMS key exists, return only the base grant
            return baseGrant;
        }
    }
    /**
     * Return the given named metric for this guardrail.
     *
     * By default, the metric will be calculated as a sum over a period of 5 minutes.
     * You can customize this by using the `statistic` and `period` properties.
     */
    metric(metricName, props) {
        const metricProps = {
            namespace: 'AWS/Bedrock/Guardrails',
            metricName,
            dimensionsMap: { GuardrailArn: this.guardrailArn, GuardrailVersion: this.guardrailVersion },
            ...props,
        };
        return this.configureMetric(metricProps);
    }
    /**
     * Return the invocations metric for this guardrail.
     */
    metricInvocations(props) {
        return this.metric('Invocations', props);
    }
    /**
     * Return the invocation latency metric for this guardrail.
     */
    metricInvocationLatency(props) {
        return this.metric('InvocationLatency', props);
    }
    /**
     * Return the invocation client errors metric for this guardrail.
     */
    metricInvocationClientErrors(props) {
        return this.metric('InvocationClientErrors', props);
    }
    /**
     * Return the invocation server errors metric for this guardrail.
     */
    metricInvocationServerErrors(props) {
        return this.metric('InvocationServerErrors', props);
    }
    /**
     * Return the invocation throttles metric for this guardrail.
     */
    metricInvocationThrottles(props) {
        return this.metric('InvocationThrottles', props);
    }
    /**
     * Return the text unit count metric for this guardrail.
     */
    metricTextUnitCount(props) {
        return this.metric('TextUnitCount', props);
    }
    /**
     * Return the invocations intervened metric for this guardrail.
     */
    metricInvocationsIntervened(props) {
        return this.metric('InvocationsIntervened', props);
    }
    configureMetric(props) {
        return new aws_cloudwatch_1.Metric({
            ...props,
            region: props?.region ?? this.stack.region,
            account: props?.account ?? this.stack.account,
        });
    }
}
exports.GuardrailBase = GuardrailBase;
_a = JSII_RTTI_SYMBOL_1;
GuardrailBase[_a] = { fqn: "@cdklabs/generative-ai-cdk-constructs.bedrock.GuardrailBase", version: "0.1.312" };
/******************************************************************************
 *                        NEW CONSTRUCT DEFINITION
 *****************************************************************************/
/**
 * Class to create a Guardrail with CDK.
 * @cloudformationResource AWS::Bedrock::Guardrail
 */
class Guardrail extends GuardrailBase {
    /**
     * Import a guardrail given its attributes
     */
    static fromGuardrailAttributes(scope, id, attrs) {
        class Import extends GuardrailBase {
            constructor() {
                super(...arguments);
                this.guardrailArn = attrs.guardrailArn;
                this.guardrailId = aws_cdk_lib_1.Arn.split(attrs.guardrailArn, aws_cdk_lib_1.ArnFormat.SLASH_RESOURCE_NAME).resourceName;
                this.guardrailVersion = attrs.guardrailVersion ?? 'DRAFT';
                this.kmsKey = attrs.kmsKey;
                this.lastUpdated = undefined;
            }
        }
        return new Import(scope, id);
    }
    /**
     * Import a low-level L1 Cfn Guardrail
     */
    static fromCfnGuardrail(cfnGuardrail) {
        return new (class extends GuardrailBase {
            constructor() {
                super(...arguments);
                this.guardrailArn = cfnGuardrail.attrGuardrailArn;
                this.guardrailId = cfnGuardrail.attrGuardrailId;
                this.guardrailVersion = cfnGuardrail.attrVersion;
                this.kmsKey = cfnGuardrail.kmsKeyArn
                    ? aws_kms_1.Key.fromKeyArn(this, '@FromCfnGuardrailKey', cfnGuardrail.kmsKeyArn)
                    : undefined;
                this.lastUpdated = cfnGuardrail.attrUpdatedAt;
            }
        })(cfnGuardrail, '@FromCfnGuardrail');
    }
    constructor(scope, id, props) {
        super(scope, id, {
            physicalName: props.name,
        });
        // ------------------------------------------------------
        // Set properties or defaults
        // ------------------------------------------------------
        this.name = this.physicalName;
        this.contentFilters = props.contentFilters ?? [];
        this.piiFilters = props.piiFilters ?? [];
        this.regexFilters = props.regexFilters ?? [];
        this.deniedTopics = props.deniedTopics ?? [];
        this.contextualGroundingFilters = props.contextualGroundingFilters ?? [];
        this.wordFilters = props.wordFilters ?? [];
        this.managedWordListFilters = props.managedWordListFilters ?? [];
        const defaultBlockedInputMessaging = 'Sorry, your query violates our usage policy.';
        const defaultBlockedOutputsMessaging = 'Sorry, I am unable to answer your question because of our usage policy.';
        // ------------------------------------------------------
        // CFN Props - With Lazy support
        // ------------------------------------------------------
        let cfnProps = {
            name: this.name,
            description: props.description,
            kmsKeyArn: props.kmsKey?.keyArn,
            blockedInputMessaging: props.blockedInputMessaging ?? defaultBlockedInputMessaging,
            blockedOutputsMessaging: props.blockedOutputsMessaging ?? defaultBlockedOutputsMessaging,
            // Lazy props
            contentPolicyConfig: this.generateCfnContentPolicyConfig(),
            contextualGroundingPolicyConfig: this.generateCfnContextualPolicyConfig(),
            topicPolicyConfig: this.generateCfnTopicPolicy(),
            wordPolicyConfig: this.generateCfnWordPolicyConfig(),
            sensitiveInformationPolicyConfig: this.generateCfnSensitiveInformationPolicyConfig(),
        };
        // Hash calculation useful for versioning of the guardrail
        this.hash = (0, helpers_internal_1.md5hash)(JSON.stringify(cfnProps));
        // ------------------------------------------------------
        // L1 Instantiation
        // ------------------------------------------------------
        this.__resource = new bedrock.CfnGuardrail(this, 'MyGuardrail', cfnProps);
        this.guardrailId = this.__resource.attrGuardrailId;
        this.guardrailArn = this.__resource.attrGuardrailArn;
        this.guardrailVersion = this.__resource.attrVersion;
        this.lastUpdated = this.__resource.attrUpdatedAt;
    }
    // ------------------------------------------------------
    // METHODS
    // ------------------------------------------------------
    /**
     * Adds a content filter to the guardrail.
     * @param filter The content filter to add.
     */
    addContentFilter(filter) {
        this.contentFilters.push(filter);
    }
    /**
     * Adds a PII filter to the guardrail.
     * @param filter The PII filter to add.
     */
    addPIIFilter(filter) {
        this.piiFilters.push(filter);
    }
    /**
     * Adds a regex filter to the guardrail.
     * @param filter The regex filter to add.
     */
    addRegexFilter(filter) {
        this.regexFilters.push(filter);
    }
    /**
     * Adds a denied topic filter to the guardrail.
     * @param filter The denied topic filter to add.
     */
    addDeniedTopicFilter(filter) {
        this.deniedTopics.push(filter);
    }
    /**
     * Adds a contextual grounding filter to the guardrail.
     * @param filter The contextual grounding filter to add.
     */
    addContextualGroundingFilter(filter) {
        this.contextualGroundingFilters.push(filter);
    }
    /**
     * Adds a word filter to the guardrail.
     * @param filter The word filter to add.
     */
    addWordFilter(filter) {
        this.wordFilters.push(filter);
    }
    /**
     * Adds a word filter to the guardrail.
     * @param filePath The location of the word filter file.
     */
    addWordFilterFromFile(filePath, inputAction, outputAction, inputEnabled, outputEnabled) {
        const fileContents = fs.readFileSync(filePath, 'utf8');
        const words = fileContents.trim().split(',');
        for (const word of words)
            this.addWordFilter({ text: word, inputAction, outputAction, inputEnabled, outputEnabled });
    }
    /**
     * Adds a managed word list filter to the guardrail.
     * @param filter The managed word list filter to add.
     */
    addManagedWordListFilter(filter) {
        this.managedWordListFilters.push(filter);
    }
    /**
     * Create a version for the guardrail.
     * @param description The description of the version.
     * @returns The guardrail version.
     */
    createVersion(description) {
        const cfnVersion = new bedrock.CfnGuardrailVersion(this, `GuardrailVersion-${this.hash.slice(0, 16)}`, {
            description: description,
            guardrailIdentifier: this.guardrailId,
        });
        this.guardrailVersion = cfnVersion.attrVersion;
        return this.guardrailVersion;
    }
    // ------------------------------------------------------
    // CFN Generators
    // ------------------------------------------------------
    /**
     * Returns the content filters applied to the guardrail. This method defers the computation
     * to synth time.
     */
    generateCfnContentPolicyConfig() {
        return aws_cdk_lib_1.Lazy.any({
            produce: () => {
                if (this.contentFilters.length > 0) {
                    return { filtersConfig: this.contentFilters };
                }
                else {
                    return undefined;
                }
            },
        });
    }
    /**
     * Returns the topic filters applied to the guardrail. This method defers the computation
     * to synth time.
     */
    generateCfnTopicPolicy() {
        return aws_cdk_lib_1.Lazy.any({
            produce: () => {
                if (this.deniedTopics.length > 0) {
                    return {
                        topicsConfig: this.deniedTopics.flatMap((topic) => {
                            return {
                                definition: topic.definition,
                                name: topic.name,
                                examples: topic.examples,
                                type: 'DENY',
                            };
                        }),
                    };
                }
                else {
                    return undefined;
                }
            },
        });
    }
    /**
     * Returns the contectual filters applied to the guardrail. This method defers the computation
     * to synth time.
     */
    generateCfnContextualPolicyConfig() {
        return aws_cdk_lib_1.Lazy.any({
            produce: () => {
                if (this.contextualGroundingFilters.length > 0) {
                    return {
                        filtersConfig: this.contextualGroundingFilters.flatMap((filter) => {
                            return {
                                type: filter.type,
                                threshold: filter.threshold,
                            };
                        }),
                    };
                }
                else {
                    return undefined;
                }
            },
        });
    }
    /**
     * Returns the word config applied to the guardrail. This method defers the computation
     * to synth time.
     */
    generateCfnWordPolicyConfig() {
        return aws_cdk_lib_1.Lazy.any({
            produce: () => {
                if (this.wordFilters.length > 0 || this.managedWordListFilters.length > 0) {
                    return {
                        wordsConfig: this.generateCfnWordConfig(),
                        managedWordListsConfig: this.generateCfnManagedWordListsConfig(),
                    };
                }
                else {
                    return undefined;
                }
            },
        });
    }
    /**
     * Returns the word filters applied to the guardrail. This method defers the computation
     * to synth time.
     */
    generateCfnWordConfig() {
        return aws_cdk_lib_1.Lazy.any({
            produce: () => {
                return this.wordFilters.flatMap((word) => {
                    return {
                        text: word.text,
                        inputAction: word.inputAction,
                        inputEnabled: word.inputEnabled,
                        outputAction: word.outputAction,
                        outputEnabled: word.outputEnabled,
                    };
                });
            },
        }, { omitEmptyArray: true });
    }
    /**
     * Returns the word filters applied to the guardrail. This method defers the computation
     * to synth time.
     */
    generateCfnManagedWordListsConfig() {
        return aws_cdk_lib_1.Lazy.any({
            produce: () => {
                return this.managedWordListFilters.flatMap((filter) => {
                    return {
                        type: filter.type,
                        inputAction: filter.inputAction,
                        inputEnabled: filter.inputEnabled,
                        outputAction: filter.outputAction,
                        outputEnabled: filter.outputEnabled,
                    };
                });
            },
        }, { omitEmptyArray: true });
    }
    /**
     * Returns the sensitive information config applied to the guardrail. This method defers the computation
     * to synth time.
     */
    generateCfnSensitiveInformationPolicyConfig() {
        return aws_cdk_lib_1.Lazy.any({
            produce: () => {
                if (this.regexFilters.length > 0 || this.piiFilters.length > 0) {
                    return {
                        regexesConfig: this.generateCfnRegexesConfig(),
                        piiEntitiesConfig: this.generateCfnPiiEntitiesConfig(),
                    };
                }
                else {
                    return undefined;
                }
            },
        }, { omitEmptyArray: true });
    }
    /**
     * Returns the regex filters applied to the guardrail. This method defers the computation
     * to synth time.
     */
    generateCfnRegexesConfig() {
        return aws_cdk_lib_1.Lazy.any({
            produce: () => {
                return this.regexFilters.flatMap((regex) => {
                    return {
                        name: regex.name,
                        description: regex.description,
                        pattern: regex.pattern,
                        action: regex.action,
                    };
                });
            },
        }, { omitEmptyArray: true });
    }
    /**
     * Returns the Pii filters applied to the guardrail. This method defers the computation
     * to synth time.
     */
    generateCfnPiiEntitiesConfig() {
        return aws_cdk_lib_1.Lazy.any({
            produce: () => {
                return this.piiFilters.flatMap((filter) => {
                    return {
                        type: filter.type,
                        action: filter.action,
                    };
                });
            },
        }, { omitEmptyArray: true });
    }
}
exports.Guardrail = Guardrail;
_b = JSII_RTTI_SYMBOL_1;
Guardrail[_b] = { fqn: "@cdklabs/generative-ai-cdk-constructs.bedrock.Guardrail", version: "0.1.312" };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ3VhcmRyYWlscy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9jZGstbGliL2JlZHJvY2svZ3VhcmRyYWlscy9ndWFyZHJhaWxzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUE7Ozs7Ozs7Ozs7O0dBV0c7QUFFSCx5QkFBeUI7QUFDekIsNkNBQXFGO0FBQ3JGLG1EQUFtRDtBQUNuRCwrREFBZ0Y7QUFDaEYsMkNBQTJDO0FBQzNDLGlEQUFnRDtBQUNoRCw0RUFBZ0U7QUFxRmhFOzs7R0FHRztBQUNILE1BQXNCLGFBQWMsU0FBUSxzQkFBUTtJQUNsRDs7Ozs7T0FLRztJQUNJLE1BQU0sQ0FBQyxTQUFTLENBQUMsVUFBa0IsRUFBRSxLQUFxQjtRQUMvRCxPQUFPLElBQUksdUJBQU0sQ0FBQztZQUNoQixTQUFTLEVBQUUsd0JBQXdCO1lBQ25DLGFBQWEsRUFBRSxFQUFFLFNBQVMsRUFBRSxnQkFBZ0IsRUFBRTtZQUM5QyxVQUFVO1lBQ1YsR0FBRyxLQUFLO1NBQ1QsQ0FBQyxDQUFDO0lBQ0wsQ0FBQztJQUVEOztPQUVHO0lBQ0ksTUFBTSxDQUFDLG9CQUFvQixDQUFDLEtBQXFCO1FBQ3RELE9BQU8sSUFBSSxDQUFDLFNBQVMsQ0FBQyxhQUFhLEVBQUUsS0FBSyxDQUFDLENBQUM7SUFDOUMsQ0FBQztJQUVEOztPQUVHO0lBQ0ksTUFBTSxDQUFDLHNCQUFzQixDQUFDLEtBQXFCO1FBQ3hELE9BQU8sSUFBSSxDQUFDLFNBQVMsQ0FBQyxlQUFlLEVBQUUsS0FBSyxDQUFDLENBQUM7SUFDaEQsQ0FBQztJQUVEOztPQUVHO0lBQ0ksTUFBTSxDQUFDLDhCQUE4QixDQUFDLEtBQXFCO1FBQ2hFLE9BQU8sSUFBSSxDQUFDLFNBQVMsQ0FBQyx1QkFBdUIsRUFBRSxLQUFLLENBQUMsQ0FBQztJQUN4RCxDQUFDO0lBRUQ7O09BRUc7SUFDSSxNQUFNLENBQUMsMEJBQTBCLENBQUMsS0FBcUI7UUFDNUQsT0FBTyxJQUFJLENB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QUcsRUFBRTtnQkFDWixPQUFPLElBQUksQ0FBQyxVQUFVLENBQUMsT0FBTyxDQUFDLENBQUMsTUFBeUIsRUFBRSxFQUFFO29CQUMzRCxPQUFPO3dCQUNMLElBQUksRUFBRSxNQUFNLENBQUMsSUFBSTt3QkFDakIsTUFBTSxFQUFFLE1BQU0sQ0FBQyxNQUFNO3FCQUMwQixDQUFDO2dCQUNwRCxDQUFDLENBQUMsQ0FBQztZQUNMLENBQUM7U0FDRixFQUNELEVBQUUsY0FBYyxFQUFFLElBQUksRUFBRSxDQUN6QixDQUFDO0lBQ0osQ0FBQzs7QUFoYkgsOEJBaWJDIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiAgQ29weXJpZ2h0IEFtYXpvbi5jb20sIEluYy4gb3IgaXRzIGFmZmlsaWF0ZXMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIikuIFlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2VcbiAqICB3aXRoIHRoZSBMaWNlbnNlLiBBIGNvcHkgb2YgdGhlIExpY2Vuc2UgaXMgbG9jYXRlZCBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogIG9yIGluIHRoZSAnbGljZW5zZScgZmlsZSBhY2NvbXBhbnlpbmcgdGhpcyBmaWxlLiBUaGlzIGZpbGUgaXMgZGlzdHJpYnV0ZWQgb24gYW4gJ0FTIElTJyBCQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTXG4gKiAgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZXhwcmVzcyBvciBpbXBsaWVkLiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnNcbiAqICBhbmQgbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0ICogYXMgZnMgZnJvbSAnZnMnO1xuaW1wb3J0IHsgQXJuLCBBcm5Gb3JtYXQsIElSZXNvbHZhYmxlLCBJUmVzb3VyY2UsIExhenksIFJlc291cmNlIH0gZnJvbSAnYXdzLWNkay1saWInO1xuaW1wb3J0ICogYXMgYmVkcm9jayBmcm9tICdhd3MtY2RrLWxpYi9hd3MtYmVkcm9jayc7XG5pbXBvcnQgeyBNZXRyaWMsIE1ldHJpY09wdGlvbnMsIE1ldHJpY1Byb3BzIH0gZnJvbSAnYXdzLWNkay1saWIvYXdzLWNsb3Vkd2F0Y2gnO1xuaW1wb3J0ICogYXMgaWFtIGZyb20gJ2F3cy1jZGstbGliL2F3cy1pYW0nO1xuaW1wb3J0IHsgSUtleSwgS2V5IH0gZnJvbSAnYXdzLWNkay1saWIvYXdzLWttcyc7XG5pbXBvcnQgeyBtZDVoYXNoIH0gZnJvbSAnYXdzLWNkay1saWIvY29yZS9saWIvaGVscGVycy1pbnRlcm5hbCc7XG5pbXBvcnQgeyBDb25zdHJ1Y3QgfSBmcm9tICdjb25zdHJ1Y3RzJztcbmltcG9ydCAqIGFzIGZpbHRlcnMgZnJvbSAnLi9ndWFyZHJhaWwtZmlsdGVycyc7XG5cbi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ09NTU9OXG4gKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4vKipcbiAqIFJlcHJlc2VudHMgYSBHdWFyZHJhaWwsIGVpdGhlciBjcmVhdGVkIHdpdGggQ0RLIG9yIGltcG9ydGVkLlxuICovXG5leHBvcnQgaW50ZXJmYWNlIElHdWFyZHJhaWwgZXh0ZW5kcyBJUmVzb3VyY2Uge1xuICAvKipcbiAgICogVGhlIEFSTiBvZiB0aGUgZ3VhcmRyYWlsLlxuICAgKiBAYXR0cmlidXRlXG4gICAqL1xuICByZWFkb25seSBndWFyZHJhaWxBcm46IHN0cmluZztcbiAgLyoqXG4gICAqIFRoZSBJRCBvZiB0aGUgZ3VhcmRyYWlsLlxuICAgKiBAYXR0cmlidXRlXG4gICAqL1xuICByZWFkb25seSBndWFyZHJhaWxJZDogc3RyaW5nO1xuICAvKipcbiAgICogT3B0aW9uYWwgS01TIGVuY3J5cHRpb24ga2V5IGFzc29jaWF0ZWQgd2l0aCB0aGlzIGd1YXJkcmFpbFxuICAgKi9cbiAgcmVhZG9ubHkga21zS2V5PzogSUtleTtcbiAgLyoqXG4gICAqIFdoZW4gdGhpcyBndWFyZHJhaWwgd2FzIGxhc3QgdXBkYXRlZC5cbiAgICovXG4gIHJlYWRvbmx5IGxhc3RVcGRhdGVkPzogc3RyaW5nO1xuICAvKipcbiAgICogVGhlIHZlcnNpb24gb2YgdGhlIGd1YXJkcmFpbC4gSWYgbm8gZXhwbGljaXQgdmVyc2lvbiBpcyBjcmVhdGVkLFxuICAgKiB0aGlzIHdpbGwgZGVmYXVsdCB0byBcIkRSQUZUXCJcbiAgICovXG4gIGd1YXJkcmFpbFZlcnNpb246IHN0cmluZztcblxuICAvKipcbiAgICogR3JhbnQgdGhlIGdpdmVuIHByaW5jaXBhbCBpZGVudGl0eSBwZXJtaXNzaW9ucyB0byBwZXJmb3JtIGFjdGlvbnMgb24gdGhpcyBndWFyZHJhaWwuXG4gICAqL1xuICBncmFudChncmFudGVlOiBpYW0uSUdyYW50YWJsZSwgLi4uYWN0aW9uczogc3RyaW5nW10pOiBpYW0uR3JhbnQ7XG4gIC8qKlxuICAgKiBHcmFudCB0aGUgZ2l2ZW4gaWRlbnRpdHkgcGVybWlzc2lvbnMgdG8gYXBwbHkgdGhlIGd1YXJkcmFpbC5cbiAgICovXG4gIGdyYW50QXBwbHkoZ3JhbnRlZTogaWFtLklHcmFudGFibGUpOiBpYW0uR3JhbnQ7XG5cbiAgLyoqXG4gICAqIFJldHVybiB0aGUgZ2l2ZW4gbmFtZWQgbWV0cmljIGZvciB0aGlzIGd1YXJkcmFpbC5cbiAgICovXG4gIG1ldHJpYyhtZXRyaWNOYW1lOiBzdHJpbmcsIHByb3BzPzogTWV0cmljT3B0aW9ucyk6IE1ldHJpYztcblxuICAvKipcbiAgICogUmV0dXJuIHRoZSBpbnZvY2F0aW9ucyBtZXRyaWMgZm9yIHRoaXMgZ3VhcmRyYWlsLlxuICAgKi9cbiAgbWV0cmljSW52b2NhdGlvbnMocHJvcHM/OiBNZXRyaWNPcHRpb25zKTogTWV0cmljO1xuXG4gIC8qKlxuICAgKiBSZXR1cm4gdGhlIGludm9jYXRpb24gbGF0ZW5jeSBtZXRyaWMgZm9yIHRoaXMgZ3VhcmRyYWlsLlxuICAgKi9cbiAgbWV0cmljSW52b2NhdGlvbkxhdGVuY3kocHJvcHM/OiBNZXRyaWNPcHRpb25zKTogTWV0cmljO1xuXG4gIC8qKlxuICAgKiBSZXR1cm4gdGhlIGludm9jYXRpb24gY2xpZW50IGVycm9ycyBtZXRyaWMgZm9yIHRoaXMgZ3VhcmRyYWlsLlxuICAgKi9cbiAgbWV0cmljSW52b2NhdGlvbkNsaWVudEVycm9ycyhwcm9wcz86IE1ldHJpY09wdGlvbnMpOiBNZXRyaWM7XG5cbiAgLyoqXG4gICAqIFJldHVybiB0aGUgaW52b2NhdGlvbiBzZXJ2ZXIgZXJyb3JzIG1ldHJpYyBmb3IgdGhpcyBndWFyZHJhaWwuXG4gICAqL1xuICBtZXRyaWNJbnZvY2F0aW9uU2VydmVyRXJyb3JzKHByb3BzPzogTWV0cmljT3B0aW9ucyk6IE1ldHJpYztcblxuICAvKipcbiAgICogUmV0dXJuIHRoZSBpbnZvY2F0aW9uIHRocm90dGxlcyBtZXRyaWMgZm9yIHRoaXMgZ3VhcmRyYWlsLlxuICAgKi9cbiAgbWV0cmljSW52b2NhdGlvblRocm90dGxlcyhwcm9wcz86IE1ldHJpY09wdGlvbnMpOiBNZXRyaWM7XG5cbiAgLyoqXG4gICAqIFJldHVybiB0aGUgdGV4dCB1bml0IGNvdW50IG1ldHJpYyBmb3IgdGhpcyBndWFyZHJhaWwuXG4gICAqL1xuICBtZXRyaWNUZXh0VW5pdENvdW50KHByb3BzPzogTWV0cmljT3B0aW9ucyk6IE1ldHJpYztcblxuICAvKipcbiAgICogUmV0dXJuIHRoZSBpbnZvY2F0aW9ucyBpbnRlcnZlbmVkIG1ldHJpYyBmb3IgdGhpcyBndWFyZHJhaWwuXG4gICAqL1xuICBtZXRyaWNJbnZvY2F0aW9uc0ludGVydmVuZWQocHJvcHM/OiBNZXRyaWNPcHRpb25zKTogTWV0cmljO1xufVxuXG4vKipcbiAqIEFic3RyYWN0IGJhc2UgY2xhc3MgZm9yIGEgR3VhcmRyYWlsLlxuICogQ29udGFpbnMgbWV0aG9kcyBhbmQgYXR0cmlidXRlcyB2YWxpZCBmb3IgR3VhcmRyYWlscyBlaXRoZXIgY3JlYXRlZCB3aXRoIENESyBvciBpbXBvcnRlZC5cbiAqL1xuZXhwb3J0IGFic3RyYWN0IGNsYXNzIEd1YXJkcmFpbEJhc2UgZXh0ZW5kcyBSZXNvdXJjZSBpbXBsZW1lbnRzIElHdWFyZHJhaWwge1xuICAvKipcbiAgICogUmV0dXJuIHRoZSBnaXZlbiBuYW1lZCBtZXRyaWMgZm9yIGFsbCBndWFyZHJhaWxzLlxuICAgKlxuICAgKiBCeSBkZWZhdWx0LCB0aGUgbWV0cmljIHdpbGwgYmUgY2FsY3VsYXRlZCBhcyBhIHN1bSBvdmVyIGEgcGVyaW9kIG9mIDUgbWludXRlcy5cbiAgICogWW91IGNhbiBjdXN0b21pemUgdGhpcyBieSB1c2luZyB0aGUgYHN0YXRpc3RpY2AgYW5kIGBwZXJpb2RgIHByb3BlcnRpZXMuXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIG1ldHJpY0FsbChtZXRyaWNOYW1lOiBzdHJpbmcsIHByb3BzPzogTWV0cmljT3B0aW9ucyk6IE1ldHJpYyB7XG4gICAgcmV0dXJuIG5ldyBNZXRyaWMoe1xuICAgICAgbmFtZXNwYWNlOiAnQVdTL0JlZHJvY2svR3VhcmRyYWlscycsXG4gICAgICBkaW1lbnNpb25zTWFwOiB7IE9wZXJhdGlvbjogJ0FwcGx5R3VhcmRyYWlsJyB9LFxuICAgICAgbWV0cmljTmFtZSxcbiAgICAgIC4uLnByb3BzLFxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybiB0aGUgaW52b2NhdGlvbnMgbWV0cmljIGZvciBhbGwgZ3VhcmRyYWlscy5cbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgbWV0cmljQWxsSW52b2NhdGlvbnMocHJvcHM/OiBNZXRyaWNPcHRpb25zKTogTWV0cmljIHtcbiAgICByZXR1cm4gdGhpcy5tZXRyaWNBbGwoJ0ludm9jYXRpb25zJywgcHJvcHMpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybiB0aGUgdGV4dCB1bml0IGNvdW50IG1ldHJpYyBmb3IgYWxsIGd1YXJkcmFpbHMuXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIG1ldHJpY0FsbFRleHRVbml0Q291bnQocHJvcHM/OiBNZXRyaWNPcHRpb25zKTogTWV0cmljIHtcbiAgICByZXR1cm4gdGhpcy5tZXRyaWNBbGwoJ1RleHRVbml0Q291bnQnLCBwcm9wcyk7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJuIHRoZSBpbnZvY2F0aW9ucyBpbnRlcnZlbmVkIG1ldHJpYyBmb3IgYWxsIGd1YXJkcmFpbHMuXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIG1ldHJpY0FsbEludm9jYXRpb25zSW50ZXJ2ZW5lZChwcm9wcz86IE1ldHJpY09wdGlvbnMpOiBNZXRyaWMge1xuICAgIHJldHVybiB0aGlzLm1ldHJpY0FsbCgnSW52b2NhdGlvbnNJbnRlcnZlbmVkJywgcHJvcHMpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybiB0aGUgaW52b2NhdGlvbiBsYXRlbmN5IG1ldHJpYyBmb3IgYWxsIGd1YXJkcmFpbHMuXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIG1ldHJpY0FsbEludm9jYXRpb25MYXRlbmN5KHByb3BzPzogTWV0cmljT3B0aW9ucyk6IE1ldHJpYyB7XG4gICAgcmV0dXJuIHRoaXMubWV0cmljQWxsKCdJbnZvY2F0aW9uTGF0ZW5jeScsIHByb3BzKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBUaGUgQVJOIG9mIHRoZSBndWFyZHJhaWwuXG4gICAqL1xuICBwdWJsaWMgYWJzdHJhY3QgcmVhZG9ubHkgZ3VhcmRyYWlsQXJuOiBzdHJpbmc7XG4gIC8qKlxuICAgKiBUaGUgSUQgb2YgdGhlIGd1YXJkcmFpbC5cbiAgICovXG4gIHB1YmxpYyBhYnN0cmFjdCByZWFkb25seSBndWFyZHJhaWxJZDogc3RyaW5nO1xuICAvKipcbiAgICogVGhlIElEIG9mIHRoZSBndWFyZHJhaWwuXG4gICAqL1xuICBwdWJsaWMgYWJzdHJhY3QgZ3VhcmRyYWlsVmVyc2lvbjogc3RyaW5nO1xuICAvKipcbiAgICogVGhlIEtNUyBrZXkgb2YgdGhlIGd1YXJkcmFpbCBpZiBjdXN0b20gZW5jcnlwdGlvbiBpcyBjb25maWd1cmVkLlxuICAgKi9cbiAgcHVibGljIGFic3RyYWN0IHJlYWRvbmx5IGttc0tleT86IElLZXk7XG4gIC8qKlxuICAgKiBXaGVuIHRoaXMgZ3VhcmRyYWlsIHdhcyBsYXN0IHVwZGF0ZWRcbiAgICovXG4gIHB1YmxpYyBhYnN0cmFjdCByZWFkb25seSBsYXN0VXBkYXRlZD86IHN0cmluZztcbiAgLyoqXG4gICAqIEdyYW50IHRoZSBnaXZlbiBwcmluY2lwYWwgaWRlbnRpdHkgcGVybWlzc2lvbnMgdG8gcGVyZm9ybSBhY3Rpb25zIG9uIHRoaXMgYWdlbnQgYWxpYXMuXG4gICAqL1xuICBwdWJsaWMgZ3JhbnQoZ3JhbnRlZTogaWFtLklHcmFudGFibGUsIC4uLmFjdGlvbnM6IHN0cmluZ1tdKSB7XG4gICAgcmV0dXJuIGlhbS5HcmFudC5hZGRUb1ByaW5jaXBhbCh7XG4gICAgICBncmFudGVlLFxuICAgICAgYWN0aW9ucyxcbiAgICAgIHJlc291cmNlQXJuczogW3RoaXMuZ3VhcmRyYWlsQXJuXSxcbiAgICAgIHNjb3BlOiB0aGlzLFxuICAgIH0pO1xuICB9XG4gIC8qKlxuICAgKiBHcmFudCB0aGUgZ2l2ZW4gaWRlbnRpdHkgcGVybWlzc2lvbnMgdG8gYXBwbHkgdGhlIGd1YXJkcmFpbC5cbiAgICovXG4gIHB1YmxpYyBncmFudEFwcGx5KGdyYW50ZWU6IGlhbS5JR3JhbnRhYmxlKTogaWFtLkdyYW50IHtcbiAgICBjb25zdCBiYXNlR3JhbnQgPSB0aGlzLmdyYW50KGdyYW50ZWUsICdiZWRyb2NrOkFwcGx5R3VhcmRyYWlsJyk7XG5cbiAgICBpZiAodGhpcy5rbXNLZXkpIHtcbiAgICAgIC8vIElmIEtNUyBrZXkgZXhpc3RzLCBjcmVhdGUgZW5jcnlwdGlvbiBncmFudCBhbmQgY29tYmluZSB3aXRoIGJhc2UgZ3JhbnRcbiAgICAgIGNvbnN0IGttc0dyYW50ID0gdGhpcy5rbXNLZXkuZ3JhbnRFbmNyeXB0RGVjcnlwdChncmFudGVlKTtcbiAgICAgIHJldHVybiBrbXNHcmFudC5jb21iaW5lKGJhc2VHcmFudCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIElmIG5vIEtNUyBrZXkgZXhpc3RzLCByZXR1cm4gb25seSB0aGUgYmFzZSBncmFudFxuICAgICAgcmV0dXJuIGJhc2VHcmFudDtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJuIHRoZSBnaXZlbiBuYW1lZCBtZXRyaWMgZm9yIHRoaXMgZ3VhcmRyYWlsLlxuICAgKlxuICAgKiBCeSBkZWZhdWx0LCB0aGUgbWV0cmljIHdpbGwgYmUgY2FsY3VsYXRlZCBhcyBhIHN1bSBvdmVyIGEgcGVyaW9kIG9mIDUgbWludXRlcy5cbiAgICogWW91IGNhbiBjdXN0b21pemUgdGhpcyBieSB1c2luZyB0aGUgYHN0YXRpc3RpY2AgYW5kIGBwZXJpb2RgIHByb3BlcnRpZXMuXG4gICAqL1xuICBwdWJsaWMgbWV0cmljKG1ldHJpY05hbWU6IHN0cmluZywgcHJvcHM/OiBNZXRyaWNPcHRpb25zKTogTWV0cmljIHtcbiAgICBjb25zdCBtZXRyaWNQcm9wczogTWV0cmljUHJvcHMgPSB7XG4gICAgICBuYW1lc3BhY2U6ICdBV1MvQmVkcm9jay9HdWFyZHJhaWxzJyxcbiAgICAgIG1ldHJpY05hbWUsXG4gICAgICBkaW1lbnNpb25zTWFwOiB7IEd1YXJkcmFpbEFybjogdGhpcy5ndWFyZHJhaWxBcm4sIEd1YXJkcmFpbFZlcnNpb246IHRoaXMuZ3VhcmRyYWlsVmVyc2lvbiB9LFxuICAgICAgLi4ucHJvcHMsXG4gICAgfTtcbiAgICByZXR1cm4gdGhpcy5jb25maWd1cmVNZXRyaWMobWV0cmljUHJvcHMpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybiB0aGUgaW52b2NhdGlvbnMgbWV0cmljIGZvciB0aGlzIGd1YXJkcmFpbC5cbiAgICovXG4gIHB1YmxpYyBtZXRyaWNJbnZvY2F0aW9ucyhwcm9wcz86IE1ldHJpY09wdGlvbnMpOiBNZXRyaWMge1xuICAgIHJldHVybiB0aGlzLm1ldHJpYygnSW52b2NhdGlvbnMnLCBwcm9wcyk7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJuIHRoZSBpbnZvY2F0aW9uIGxhdGVuY3kgbWV0cmljIGZvciB0aGlzIGd1YXJkcmFpbC5cbiAgICovXG4gIHB1YmxpYyBtZXRyaWNJbnZvY2F0aW9uTGF0ZW5jeShwcm9wcz86IE1ldHJpY09wdGlvbnMpOiBNZXRyaWMge1xuICAgIHJldHVybiB0aGlzLm1ldHJpYygnSW52b2NhdGlvbkxhdGVuY3knLCBwcm9wcyk7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJuIHRoZSBpbnZvY2F0aW9uIGNsaWVudCBlcnJvcnMgbWV0cmljIGZvciB0aGlzIGd1YXJkcmFpbC5cbiAgICovXG4gIHB1YmxpYyBtZXRyaWNJbnZvY2F0aW9uQ2xpZW50RXJyb3JzKHByb3BzPzogTWV0cmljT3B0aW9ucyk6IE1ldHJpYyB7XG4gICAgcmV0dXJuIHRoaXMubWV0cmljKCdJbnZvY2F0aW9uQ2xpZW50RXJyb3JzJywgcHJvcHMpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybiB0aGUgaW52b2NhdGlvbiBzZXJ2ZXIgZXJyb3JzIG1ldHJpYyBmb3IgdGhpcyBndWFyZHJhaWwuXG4gICAqL1xuICBwdWJsaWMgbWV0cmljSW52b2NhdGlvblNlcnZlckVycm9ycyhwcm9wcz86IE1ldHJpY09wdGlvbnMpOiBNZXRyaWMge1xuICAgIHJldHVybiB0aGlzLm1ldHJpYygnSW52b2NhdGlvblNlcnZlckVycm9ycycsIHByb3BzKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm4gdGhlIGludm9jYXRpb24gdGhyb3R0bGVzIG1ldHJpYyBmb3IgdGhpcyBndWFyZHJhaWwuXG4gICAqL1xuICBwdWJsaWMgbWV0cmljSW52b2NhdGlvblRocm90dGxlcyhwcm9wcz86IE1ldHJpY09wdGlvbnMpOiBNZXRyaWMge1xuICAgIHJldHVybiB0aGlzLm1ldHJpYygnSW52b2NhdGlvblRocm90dGxlcycsIHByb3BzKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm4gdGhlIHRleHQgdW5pdCBjb3VudCBtZXRyaWMgZm9yIHRoaXMgZ3VhcmRyYWlsLlxuICAgKi9cbiAgcHVibGljIG1ldHJpY1RleHRVbml0Q291bnQocHJvcHM/OiBNZXRyaWNPcHRpb25zKTogTWV0cmljIHtcbiAgICByZXR1cm4gdGhpcy5tZXRyaWMoJ1RleHRVbml0Q291bnQnLCBwcm9wcyk7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJuIHRoZSBpbnZvY2F0aW9ucyBpbnRlcnZlbmVkIG1ldHJpYyBmb3IgdGhpcyBndWFyZHJhaWwuXG4gICAqL1xuICBwdWJsaWMgbWV0cmljSW52b2NhdGlvbnNJbnRlcnZlbmVkKHByb3BzPzogTWV0cmljT3B0aW9ucyk6IE1ldHJpYyB7XG4gICAgcmV0dXJuIHRoaXMubWV0cmljKCdJbnZvY2F0aW9uc0ludGVydmVuZWQnLCBwcm9wcyk7XG4gIH1cblxuICBwcml2YXRlIGNvbmZpZ3VyZU1ldHJpYyhwcm9wczogTWV0cmljUHJvcHMpIHtcbiAgICByZXR1cm4gbmV3IE1ldHJpYyh7XG4gICAgICAuLi5wcm9wcyxcbiAgICAgIHJlZ2lvbjogcHJvcHM/LnJlZ2lvbiA/PyB0aGlzLnN0YWNrLnJlZ2lvbixcbiAgICAgIGFjY291bnQ6IHByb3BzPy5hY2NvdW50ID8/IHRoaXMuc3RhY2suYWNjb3VudCxcbiAgICB9KTtcbiAgfVxufVxuXG4vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4gKiAgICAgICAgICAgICAgICAgICAgICAgIFBST1BTIEZPUiBORVcgQ09OU1RSVUNUXG4gKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4vKipcbiAqIFByb3BlcnRpZXMgZm9yIGNyZWF0aW5nIGEgR3VhcmRyYWlsLlxuICovXG5leHBvcnQgaW50ZXJmYWNlIEd1YXJkcmFpbFByb3BzIHtcbiAgLyoqXG4gICAqIFRoZSBuYW1lIG9mIHRoZSBndWFyZHJhaWwuXG4gICAqL1xuICByZWFkb25seSBuYW1lOiBzdHJpbmc7XG4gIC8qKlxuICAgKiBUaGUgZGVzY3JpcHRpb24gb2YgdGhlIGd1YXJkcmFpbC5cbiAgICovXG4gIHJlYWRvbmx5IGRlc2NyaXB0aW9uPzogc3RyaW5nO1xuICAvKipcbiAgICogVGhlIG1lc3NhZ2UgdG8gcmV0dXJuIHdoZW4gdGhlIGd1YXJkcmFpbCBibG9ja3MgYSBwcm9tcHQuXG4gICAqXG4gICAqIEBkZWZhdWx0IFwiU29ycnksIHlvdXIgcXVlcnkgdmlvbGF0ZXMgb3VyIHVzYWdlIHBvbGljeS5cIlxuICAgKi9cbiAgcmVhZG9ubHkgYmxvY2tlZElucHV0TWVzc2FnaW5nPzogc3RyaW5nO1xuICAvKipcbiAgICogVGhlIG1lc3NhZ2UgdG8gcmV0dXJuIHdoZW4gdGhlIGd1YXJkcmFpbCBibG9ja3MgYSBtb2RlbCByZXNwb25zZS5cbiAgICpcbiAgICogQGRlZmF1bHQgXCJTb3JyeSwgSSBhbSB1bmFibGUgdG8gYW5zd2VyIHlvdXIgcXVlc3Rpb24gYmVjYXVzZSBvZiBvdXIgdXNhZ2UgcG9saWN5LlwiXG4gICAqL1xuICByZWFkb25seSBibG9ja2VkT3V0cHV0c01lc3NhZ2luZz86IHN0cmluZztcbiAgLyoqXG4gICAqIEEgY3VzdG9tIEtNUyBrZXkgdG8gdXNlIGZvciBlbmNyeXB0aW5nIGRhdGEuXG4gICAqXG4gICAqIEBkZWZhdWx0IFwiWW91ciBkYXRhIGlzIGVuY3J5cHRlZCBieSBkZWZhdWx0IHdpdGggYSBrZXkgdGhhdCBBV1Mgb3ducyBhbmQgbWFuYWdlcyBmb3IgeW91LlwiXG4gICAqL1xuICByZWFkb25seSBrbXNLZXk/OiBJS2V5O1xuICAvKipcbiAgICogVGhlIGNvbnRlbnQgZmlsdGVycyB0byBhcHBseSB0byB0aGUgZ3VhcmRyYWlsLlxuICAgKiBOb3RlLCBpZiBvbmUgb2ZcbiAgICovXG4gIHJlYWRvbmx5IGNvbnRlbnRGaWx0ZXJzPzogZmlsdGVycy5Db250ZW50RmlsdGVyW107XG4gIC8qKlxuICAgKiBVcCB0byAzMCBkZW5pZWQgdG9waWNzIHRvIGJsb2NrIHVzZXIgaW5wdXRzIG9yIG1vZGVsIHJlc3BvbnNlcyBhc3NvY2lhdGVkIHdpdGggdGhlIHRvcGljLlxuICAgKi9cbiAgcmVhZG9ubHkgZGVuaWVkVG9waWNzPzogZmlsdGVycy5Ub3BpY1tdO1xuICAvKipcbiAgICogVGhlIHdvcmQgZmlsdGVycyB0byBhcHBseSB0byB0aGUgZ3VhcmRyYWlsLlxuICAgKi9cbiAgcmVhZG9ubHkgd29yZEZpbHRlcnM/OiBmaWx0ZXJzLldvcmRGaWx0ZXJbXTtcbiAgLyoqXG4gICAqIFRoZSBtYW5hZ2VkIHdvcmQgZmlsdGVycyB0byBhcHBseSB0byB0aGUgZ3VhcmRyYWlsLlxuICAgKi9cbiAgcmVhZG9ubHkgbWFuYWdlZFdvcmRMaXN0RmlsdGVycz86IGZpbHRlcnMuTWFuYWdlZFdvcmRGaWx0ZXJbXTtcbiAgLyoqXG4gICAqIFRoZSBQSUkgZmlsdGVycyB0byBhcHBseSB0byB0aGUgZ3VhcmRyYWlsLlxuICAgKi9cbiAgcmVhZG9ubHkgcGlpRmlsdGVycz86IGZpbHRlcnMuUElJRmlsdGVyW107XG4gIC8qKlxuICAgKiBUaGUgcmVndWxhciBleHByZXNzaW9uIChyZWdleCkgZmlsdGVycyB0byBhcHBseSB0byB0aGUgZ3VhcmRyYWlsLlxuICAgKi9cbiAgcmVhZG9ubHkgcmVnZXhGaWx0ZXJzPzogZmlsdGVycy5SZWdleEZpbHRlcltdO1xuICAvKipcbiAgICogVGhlIGNvbnRleHR1YWwgZ3JvdW5kaW5nIGZpbHRlcnMgdG8gYXBwbHkgdG8gdGhlIGd1YXJkcmFpbC5cbiAgICovXG4gIHJlYWRvbmx5IGNvbnRleHR1YWxHcm91bmRpbmdGaWx0ZXJzPzogZmlsdGVycy5Db250ZXh0dWFsR3JvdW5kaW5nRmlsdGVyW107XG59XG5cbi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAqICAgICAgICAgICAgICAgICAgICAgIEFUVFJTIEZPUiBJTVBPUlRFRCBDT05TVFJVQ1RcbiAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbmV4cG9ydCBpbnRlcmZhY2UgR3VhcmRyYWlsQXR0cmlidXRlcyB7XG4gIC8qKlxuICAgKiBUaGUgQVJOIG9mIHRoZSBndWFyZHJhaWwuIEF0IGxlYXN0IG9uZSBvZiBndWFyZHJhaWxBcm4gb3IgZ3VhcmRyYWlsSWQgbXVzdCBiZVxuICAgKiBkZWZpbmVkIGluIG9yZGVyIHRvIGluaXRpYWxpemUgYSBndWFyZHJhaWwgcmVmLlxuICAgKi9cbiAgcmVhZG9ubHkgZ3VhcmRyYWlsQXJuOiBzdHJpbmc7XG4gIC8qKlxuICAgKiBUaGUgS01TIGtleSBvZiB0aGUgZ3VhcmRyYWlsIGlmIGN1c3RvbSBlbmNyeXB0aW9uIGlzIGNvbmZpZ3VyZWQuXG4gICAqXG4gICAqIEBkZWZhdWx0IHVuZGVmaW5lZCAtIE1lYW5zIGRhdGEgaXMgZW5jcnlwdGVkIGJ5IGRlZmF1bHQgd2l0aCBhIEFXUy1tYW5hZ2VkIGtleVxuICAgKi9cbiAgcmVhZG9ubHkga21zS2V5PzogSUtleTtcbiAgLyoqXG4gICAqIFRoZSB2ZXJzaW9uIG9mIHRoZSBndWFyZHJhaWwuXG4gICAqXG4gICAqIEBkZWZhdWx0IFwiRFJBRlRcIlxuICAgKi9cbiAgcmVhZG9ubHkgZ3VhcmRyYWlsVmVyc2lvbj86IHN0cmluZztcbn1cblxuLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICogICAgICAgICAgICAgICAgICAgICAgICBORVcgQ09OU1RSVUNUIERFRklOSVRJT05cbiAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbi8qKlxuICogQ2xhc3MgdG8gY3JlYXRlIGEgR3VhcmRyYWlsIHdpdGggQ0RLLlxuICogQGNsb3VkZm9ybWF0aW9uUmVzb3VyY2UgQVdTOjpCZWRyb2NrOjpHdWFyZHJhaWxcbiAqL1xuZXhwb3J0IGNsYXNzIEd1YXJkcmFpbCBleHRlbmRzIEd1YXJkcmFpbEJhc2Uge1xuICAvKipcbiAgICogSW1wb3J0IGEgZ3VhcmRyYWlsIGdpdmVuIGl0cyBhdHRyaWJ1dGVzXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIGZyb21HdWFyZHJhaWxBdHRyaWJ1dGVzKHNjb3BlOiBDb25zdHJ1Y3QsIGlkOiBzdHJpbmcsIGF0dHJzOiBHdWFyZHJhaWxBdHRyaWJ1dGVzKTogSUd1YXJkcmFpbCB7XG4gICAgY2xhc3MgSW1wb3J0IGV4dGVuZHMgR3VhcmRyYWlsQmFzZSB7XG4gICAgICBwdWJsaWMgcmVhZG9ubHkgZ3VhcmRyYWlsQXJuID0gYXR0cnMuZ3VhcmRyYWlsQXJuO1xuICAgICAgcHVibGljIHJlYWRvbmx5IGd1YXJkcmFpbElkID0gQXJuLnNwbGl0KGF0dHJzLmd1YXJkcmFpbEFybiwgQXJuRm9ybWF0LlNMQVNIX1JFU09VUkNFX05BTUUpLnJlc291cmNlTmFtZSE7XG4gICAgICBwdWJsaWMgcmVhZG9ubHkgZ3VhcmRyYWlsVmVyc2lvbiA9IGF0dHJzLmd1YXJkcmFpbFZlcnNpb24gPz8gJ0RSQUZUJztcbiAgICAgIHB1YmxpYyByZWFkb25seSBrbXNLZXkgPSBhdHRycy5rbXNLZXk7XG4gICAgICBwdWJsaWMgcmVhZG9ubHkgbGFzdFVwZGF0ZWQgPSB1bmRlZmluZWQ7XG4gICAgfVxuXG4gICAgcmV0dXJuIG5ldyBJbXBvcnQoc2NvcGUsIGlkKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBJbXBvcnQgYSBsb3ctbGV2ZWwgTDEgQ2ZuIEd1YXJkcmFpbFxuICAgKi9cbiAgcHVibGljIHN0YXRpYyBmcm9tQ2ZuR3VhcmRyYWlsKGNmbkd1YXJkcmFpbDogYmVkcm9jay5DZm5HdWFyZHJhaWwpOiBJR3VhcmRyYWlsIHtcbiAgICByZXR1cm4gbmV3IChjbGFzcyBleHRlbmRzIEd1YXJkcmFpbEJhc2Uge1xuICAgICAgcHVibGljIHJlYWRvbmx5IGd1YXJkcmFpbEFybiA9IGNmbkd1YXJkcmFpbC5hdHRyR3VhcmRyYWlsQXJuO1xuICAgICAgcHVibGljIHJlYWRvbmx5IGd1YXJkcmFpbElkID0gY2ZuR3VhcmRyYWlsLmF0dHJHdWFyZHJhaWxJZDtcbiAgICAgIHB1YmxpYyByZWFkb25seSBndWFyZHJhaWxWZXJzaW9uID0gY2ZuR3VhcmRyYWlsLmF0dHJWZXJzaW9uO1xuICAgICAgcHVibGljIHJlYWRvbmx5IGttc0tleSA9IGNmbkd1YXJkcmFpbC5rbXNLZXlBcm5cbiAgICAgICAgPyBLZXkuZnJvbUtleUFybih0aGlzLCAnQEZyb21DZm5HdWFyZHJhaWxLZXknLCBjZm5HdWFyZHJhaWwua21zS2V5QXJuKVxuICAgICAgICA6IHVuZGVmaW5lZDtcbiAgICAgIHB1YmxpYyByZWFkb25seSBsYXN0VXBkYXRlZCA9IGNmbkd1YXJkcmFpbC5hdHRyVXBkYXRlZEF0O1xuICAgIH0pKGNmbkd1YXJkcmFpbCwgJ0BGcm9tQ2ZuR3VhcmRyYWlsJyk7XG4gIH1cblxuICAvKipcbiAgICogVGhlIEFSTiBvZiB0aGUgZ3VhcmRyYWlsLlxuICAgKi9cbiAgcHVibGljIHJlYWRvbmx5IGd1YXJkcmFpbEFybjogc3RyaW5nO1xuICAvKipcbiAgICogVGhlIElEIG9mIHRoZSBndWFyZHJhaWwuXG4gICAqL1xuICBwdWJsaWMgcmVhZG9ubHkgZ3VhcmRyYWlsSWQ6IHN0cmluZztcbiAgLyoqXG4gICAqIFRoZSBuYW1lIG9mIHRoZSBndWFyZHJhaWwuXG4gICAqL1xuICBwdWJsaWMgcmVhZG9ubHkgbmFtZTogc3RyaW5nO1xuICAvKipcbiAgICogVGhlIHZlcnNpb24gb2YgdGhlIGd1YXJkcmFpbC5cbiAgICogQnkgZGVmYXVsdCwgdGhpcyB2YWx1ZSB3aWxsIGFsd2F5cyBiZSBgRFJBRlRgIHVubGVzcyBhbiBleHBsaWNpdCB2ZXJzaW9uIGlzIGNyZWF0ZWQuXG4gICAqIEZvciBhbiBleHBsaWNpdCB2ZXJzaW9uIGNyZWF0ZWQsIHRoaXMgd2lsbCB1c3VhbGx5IGJlIGEgbnVtYmVyIChlLmcuIGZvciBWZXJzaW9uIDEganVzdCBlbnRlciBcIjFcIilcbiAgICpcbiAgICogQGV4YW1wbGUgXCIxXCJcbiAgICogQGRlZmF1bHQgLSBcIkRSQUZUXCJcbiAgICovXG4gIHB1YmxpYyBndWFyZHJhaWxWZXJzaW9uOiBzdHJpbmc7XG4gIC8qKlxuICAgKiBUaGUgS01TIGtleSB1c2VkIHRvIGVuY3J5cHQgZGF0YS5cbiAgICpcbiAgICogQGRlZmF1bHQgdW5kZWZpbmVkIC0gXCJEYXRhIGlzIGVuY3J5cHRlZCBieSBkZWZhdWx0IHdpdGggYSBrZXkgdGhhdCBBV1Mgb3ducyBhbmQgbWFuYWdlcyBmb3IgeW91XCJcbiAgICovXG4gIHB1YmxpYyByZWFkb25seSBrbXNLZXk/OiBJS2V5O1xuICAvKipcbiAgICogVGhlIGNvbnRlbnQgZmlsdGVycyBhcHBsaWVkIGJ5IHRoZSBndWFyZHJhaWwuXG4gICAqL1xuICBwdWJsaWMgcmVhZG9ubHkgY29udGVudEZpbHRlcnM6IGZpbHRlcnMuQ29udGVudEZpbHRlcltdO1xuICAvKipcbiAgICogVGhlIFBJSSBmaWx0ZXJzIGFwcGxpZWQgYnkgdGhlIGd1YXJkcmFpbC5cbiAgICovXG4gIHB1YmxpYyByZWFkb25seSBwaWlGaWx0ZXJzOiBmaWx0ZXJzLlBJSUZpbHRlcltdO1xuICAvKipcbiAgICogVGhlIHJlZ2V4IGZpbHRlcnMgYXBwbGllZCBieSB0aGUgZ3VhcmRyYWlsLlxuICAgKi9cbiAgcHVibGljIHJlYWRvbmx5IHJlZ2V4RmlsdGVyczogZmlsdGVycy5SZWdleEZpbHRlcltdO1xuICAvKipcbiAgICogVGhlIGRlbmllZCB0b3BpYyBmaWx0ZXJzIGFwcGxpZWQgYnkgdGhlIGd1YXJkcmFpbC5cbiAgICovXG4gIHB1YmxpYyByZWFkb25seSBkZW5pZWRUb3BpY3M6IGZpbHRlcnMuVG9waWNbXTtcbiAgLyoqXG4gICAqIFRoZSBjb250ZXh0dWFsIGdyb3VuZGluZyBmaWx0ZXJzIGFwcGxpZWQgYnkgdGhlIGd1YXJkcmFpbC5cbiAgICovXG4gIHB1YmxpYyByZWFkb25seSBjb250ZXh0dWFsR3JvdW5kaW5nRmlsdGVyczogZmlsdGVycy5Db250ZXh0dWFsR3JvdW5kaW5nRmlsdGVyW107XG4gIC8qKlxuICAgKiBUaGUgd29yZCBmaWx0ZXJzIGFwcGxpZWQgYnkgdGhlIGd1YXJkcmFpbC5cbiAgICovXG4gIHB1YmxpYyByZWFkb25seSB3b3JkRmlsdGVyczogZmlsdGVycy5Xb3JkRmlsdGVyW107XG4gIC8qKlxuICAgKiBUaGUgbWFuYWdlZCB3b3JkIGxpc3QgZmlsdGVycyBhcHBsaWVkIGJ5IHRoZSBndWFyZHJhaWwuXG4gICAqL1xuICBwdWJsaWMgcmVhZG9ubHkgbWFuYWdlZFdvcmRMaXN0RmlsdGVyczogZmlsdGVycy5NYW5hZ2VkV29yZEZpbHRlcltdO1xuICAvKipcbiAgICogV2hlbiB0aGlzIGd1YXJkcmFpbCB3YXMgbGFzdCB1cGRhdGVkXG4gICAqL1xuICBwdWJsaWMgcmVhZG9ubHkgbGFzdFVwZGF0ZWQ/OiBzdHJpbmc7XG4gIC8qKlxuICAgKiBUaGUgY29tcHV0ZWQgaGFzaCBvZiB0aGUgZ3VhcmRyYWlsIHByb3BlcnRpZXMuXG4gICAqL1xuICBwdWJsaWMgcmVhZG9ubHkgaGFzaDogc3RyaW5nO1xuICAvKipcbiAgICogVGhlIEwxIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBndWFyZHJhaWxcbiAgICovXG4gIHByaXZhdGUgcmVhZG9ubHkgX19yZXNvdXJjZTogYmVkcm9jay5DZm5HdWFyZHJhaWw7XG5cbiAgY29uc3RydWN0b3Ioc2NvcGU6IENvbnN0cnVjdCwgaWQ6IHN0cmluZywgcHJvcHM6IEd1YXJkcmFpbFByb3BzKSB7XG4gICAgc3VwZXIoc2NvcGUsIGlkLCB7XG4gICAgICBwaHlzaWNhbE5hbWU6IHByb3BzLm5hbWUsXG4gICAgfSk7XG5cbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBTZXQgcHJvcGVydGllcyBvciBkZWZhdWx0c1xuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIHRoaXMubmFtZSA9IHRoaXMucGh5c2ljYWxOYW1lO1xuICAgIHRoaXMuY29udGVudEZpbHRlcnMgPSBwcm9wcy5jb250ZW50RmlsdGVycyA/PyBbXTtcbiAgICB0aGlzLnBpaUZpbHRlcnMgPSBwcm9wcy5waWlGaWx0ZXJzID8/IFtdO1xuICAgIHRoaXMucmVnZXhGaWx0ZXJzID0gcHJvcHMucmVnZXhGaWx0ZXJzID8/IFtdO1xuICAgIHRoaXMuZGVuaWVkVG9waWNzID0gcHJvcHMuZGVuaWVkVG9waWNzID8/IFtdO1xuICAgIHRoaXMuY29udGV4dHVhbEdyb3VuZGluZ0ZpbHRlcnMgPSBwcm9wcy5jb250ZXh0dWFsR3JvdW5kaW5nRmlsdGVycyA/PyBbXTtcbiAgICB0aGlzLndvcmRGaWx0ZXJzID0gcHJvcHMud29yZEZpbHRlcnMgPz8gW107XG4gICAgdGhpcy5tYW5hZ2VkV29yZExpc3RGaWx0ZXJzID0gcHJvcHMubWFuYWdlZFdvcmRMaXN0RmlsdGVycyA/PyBbXTtcblxuICAgIGNvbnN0IGRlZmF1bHRCbG9ja2VkSW5wdXRNZXNzYWdpbmcgPSAnU29ycnksIHlvdXIgcXVlcnkgdmlvbGF0ZXMgb3VyIHVzYWdlIHBvbGljeS4nO1xuICAgIGNvbnN0IGRlZmF1bHRCbG9ja2VkT3V0cHV0c01lc3NhZ2luZyA9ICdTb3JyeSwgSSBhbSB1bmFibGUgdG8gYW5zd2VyIHlvdXIgcXVlc3Rpb24gYmVjYXVzZSBvZiBvdXIgdXNhZ2UgcG9saWN5Lic7XG5cbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBDRk4gUHJvcHMgLSBXaXRoIExhenkgc3VwcG9ydFxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIGxldCBjZm5Qcm9wczogYmVkcm9jay5DZm5HdWFyZHJhaWxQcm9wcyA9IHtcbiAgICAgIG5hbWU6IHRoaXMubmFtZSxcbiAgICAgIGRlc2NyaXB0aW9uOiBwcm9wcy5kZXNjcmlwdGlvbixcbiAgICAgIGttc0tleUFybjogcHJvcHMua21zS2V5Py5rZXlBcm4sXG4gICAgICBibG9ja2VkSW5wdXRNZXNzYWdpbmc6IHByb3BzLmJsb2NrZWRJbnB1dE1lc3NhZ2luZyA/PyBkZWZhdWx0QmxvY2tlZElucHV0TWVzc2FnaW5nLFxuICAgICAgYmxvY2tlZE91dHB1dHNNZXNzYWdpbmc6IHByb3BzLmJsb2NrZWRPdXRwdXRzTWVzc2FnaW5nID8/IGRlZmF1bHRCbG9ja2VkT3V0cHV0c01lc3NhZ2luZyxcbiAgICAgIC8vIExhenkgcHJvcHNcbiAgICAgIGNvbnRlbnRQb2xpY3lDb25maWc6IHRoaXMuZ2VuZXJhdGVDZm5Db250ZW50UG9saWN5Q29uZmlnKCksXG4gICAgICBjb250ZXh0dWFsR3JvdW5kaW5nUG9saWN5Q29uZmlnOiB0aGlzLmdlbmVyYXRlQ2ZuQ29udGV4dHVhbFBvbGljeUNvbmZpZygpLFxuICAgICAgdG9waWNQb2xpY3lDb25maWc6IHRoaXMuZ2VuZXJhdGVDZm5Ub3BpY1BvbGljeSgpLFxuICAgICAgd29yZFBvbGljeUNvbmZpZzogdGhpcy5nZW5lcmF0ZUNmbldvcmRQb2xpY3lDb25maWcoKSxcbiAgICAgIHNlbnNpdGl2ZUluZm9ybWF0aW9uUG9saWN5Q29uZmlnOiB0aGlzLmdlbmVyYXRlQ2ZuU2Vuc2l0aXZlSW5mb3JtYXRpb25Qb2xpY3lDb25maWcoKSxcbiAgICB9O1xuXG4gICAgLy8gSGFzaCBjYWxjdWxhdGlvbiB1c2VmdWwgZm9yIHZlcnNpb25pbmcgb2YgdGhlIGd1YXJkcmFpbFxuICAgIHRoaXMuaGFzaCA9IG1kNWhhc2goSlNPTi5zdHJpbmdpZnkoY2ZuUHJvcHMpKTtcblxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIEwxIEluc3RhbnRpYXRpb25cbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICB0aGlzLl9fcmVzb3VyY2UgPSBuZXcgYmVkcm9jay5DZm5HdWFyZHJhaWwodGhpcywgJ015R3VhcmRyYWlsJywgY2ZuUHJvcHMpO1xuXG4gICAgdGhpcy5ndWFyZHJhaWxJZCA9IHRoaXMuX19yZXNvdXJjZS5hdHRyR3VhcmRyYWlsSWQ7XG4gICAgdGhpcy5ndWFyZHJhaWxBcm4gPSB0aGlzLl9fcmVzb3VyY2UuYXR0ckd1YXJkcmFpbEFybjtcbiAgICB0aGlzLmd1YXJkcmFpbFZlcnNpb24gPSB0aGlzLl9fcmVzb3VyY2UuYXR0clZlcnNpb247XG4gICAgdGhpcy5sYXN0VXBkYXRlZCA9IHRoaXMuX19yZXNvdXJjZS5hdHRyVXBkYXRlZEF0O1xuICB9XG5cbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIC8vIE1FVEhPRFNcbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIC8qKlxuICAgKiBBZGRzIGEgY29udGVudCBmaWx0ZXIgdG8gdGhlIGd1YXJkcmFpbC5cbiAgICogQHBhcmFtIGZpbHRlciBUaGUgY29udGVudCBmaWx0ZXIgdG8gYWRkLlxuICAgKi9cbiAgcHVibGljIGFkZENvbnRlbnRGaWx0ZXIoZmlsdGVyOiBmaWx0ZXJzLkNvbnRlbnRGaWx0ZXIpOiB2b2lkIHtcbiAgICB0aGlzLmNvbnRlbnRGaWx0ZXJzLnB1c2goZmlsdGVyKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBZGRzIGEgUElJIGZpbHRlciB0byB0aGUgZ3VhcmRyYWlsLlxuICAgKiBAcGFyYW0gZmlsdGVyIFRoZSBQSUkgZmlsdGVyIHRvIGFkZC5cbiAgICovXG4gIHB1YmxpYyBhZGRQSUlGaWx0ZXIoZmlsdGVyOiBmaWx0ZXJzLlBJSUZpbHRlcik6IHZvaWQge1xuICAgIHRoaXMucGlpRmlsdGVycy5wdXNoKGZpbHRlcik7XG4gIH1cblxuICAvKipcbiAgICogQWRkcyBhIHJlZ2V4IGZpbHRlciB0byB0aGUgZ3VhcmRyYWlsLlxuICAgKiBAcGFyYW0gZmlsdGVyIFRoZSByZWdleCBmaWx0ZXIgdG8gYWRkLlxuICAgKi9cbiAgcHVibGljIGFkZFJlZ2V4RmlsdGVyKGZpbHRlcjogZmlsdGVycy5SZWdleEZpbHRlcik6IHZvaWQge1xuICAgIHRoaXMucmVnZXhGaWx0ZXJzLnB1c2goZmlsdGVyKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBZGRzIGEgZGVuaWVkIHRvcGljIGZpbHRlciB0byB0aGUgZ3VhcmRyYWlsLlxuICAgKiBAcGFyYW0gZmlsdGVyIFRoZSBkZW5pZWQgdG9waWMgZmlsdGVyIHRvIGFkZC5cbiAgICovXG4gIHB1YmxpYyBhZGREZW5pZWRUb3BpY0ZpbHRlcihmaWx0ZXI6IGZpbHRlcnMuVG9waWMpOiB2b2lkIHtcbiAgICB0aGlzLmRlbmllZFRvcGljcy5wdXNoKGZpbHRlcik7XG4gIH1cblxuICAvKipcbiAgICogQWRkcyBhIGNvbnRleHR1YWwgZ3JvdW5kaW5nIGZpbHRlciB0byB0aGUgZ3VhcmRyYWlsLlxuICAgKiBAcGFyYW0gZmlsdGVyIFRoZSBjb250ZXh0dWFsIGdyb3VuZGluZyBmaWx0ZXIgdG8gYWRkLlxuICAgKi9cbiAgcHVibGljIGFkZENvbnRleHR1YWxHcm91bmRpbmdGaWx0ZXIoZmlsdGVyOiBmaWx0ZXJzLkNvbnRleHR1YWxHcm91bmRpbmdGaWx0ZXIpOiB2b2lkIHtcbiAgICB0aGlzLmNvbnRleHR1YWxHcm91bmRpbmdGaWx0ZXJzLnB1c2goZmlsdGVyKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBZGRzIGEgd29yZCBmaWx0ZXIgdG8gdGhlIGd1YXJkcmFpbC5cbiAgICogQHBhcmFtIGZpbHRlciBUaGUgd29yZCBmaWx0ZXIgdG8gYWRkLlxuICAgKi9cbiAgcHVibGljIGFkZFdvcmRGaWx0ZXIoZmlsdGVyOiBmaWx0ZXJzLldvcmRGaWx0ZXIpOiB2b2lkIHtcbiAgICB0aGlzLndvcmRGaWx0ZXJzLnB1c2goZmlsdGVyKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBZGRzIGEgd29yZCBmaWx0ZXIgdG8gdGhlIGd1YXJkcmFpbC5cbiAgICogQHBhcmFtIGZpbGVQYXRoIFRoZSBsb2NhdGlvbiBvZiB0aGUgd29yZCBmaWx0ZXIgZmlsZS5cbiAgICovXG4gIHB1YmxpYyBhZGRXb3JkRmlsdGVyRnJvbUZpbGUoZmlsZVBhdGg6IHN0cmluZyxcbiAgICBpbnB1dEFjdGlvbj86IGZpbHRlcnMuR3VhcmRyYWlsQWN0aW9uLFxuICAgIG91dHB1dEFjdGlvbj86IGZpbHRlcnMuR3VhcmRyYWlsQWN0aW9uLFxuICAgIGlucHV0RW5hYmxlZD86IGJvb2xlYW4sXG4gICAgb3V0cHV0RW5hYmxlZD86IGJvb2xlYW4pOiB2b2lkIHtcbiAgICBjb25zdCBmaWxlQ29udGVudHMgPSBmcy5yZWFkRmlsZVN5bmMoZmlsZVBhdGgsICd1dGY4Jyk7XG4gICAgY29uc3Qgd29yZHMgPSBmaWxlQ29udGVudHMudHJpbSgpLnNwbGl0KCcsJyk7XG4gICAgZm9yIChjb25zdCB3b3JkIG9mIHdvcmRzKSB0aGlzLmFkZFdvcmRGaWx0ZXIoeyB0ZXh0OiB3b3JkLCBpbnB1dEFjdGlvbiwgb3V0cHV0QWN0aW9uLCBpbnB1dEVuYWJsZWQsIG91dHB1dEVuYWJsZWQgfSk7XG4gIH1cblxuICAvKipcbiAgICogQWRkcyBhIG1hbmFnZWQgd29yZCBsaXN0IGZpbHRlciB0byB0aGUgZ3VhcmRyYWlsLlxuICAgKiBAcGFyYW0gZmlsdGVyIFRoZSBtYW5hZ2VkIHdvcmQgbGlzdCBmaWx0ZXIgdG8gYWRkLlxuICAgKi9cbiAgcHVibGljIGFkZE1hbmFnZWRXb3JkTGlzdEZpbHRlcihmaWx0ZXI6IGZpbHRlcnMuTWFuYWdlZFdvcmRGaWx0ZXIpOiB2b2lkIHtcbiAgICB0aGlzLm1hbmFnZWRXb3JkTGlzdEZpbHRlcnMucHVzaChmaWx0ZXIpO1xuICB9XG5cbiAgLyoqXG4gICAqIENyZWF0ZSBhIHZlcnNpb24gZm9yIHRoZSBndWFyZHJhaWwuXG4gICAqIEBwYXJhbSBkZXNjcmlwdGlvbiBUaGUgZGVzY3JpcHRpb24gb2YgdGhlIHZlcnNpb24uXG4gICAqIEByZXR1cm5zIFRoZSBndWFyZHJhaWwgdmVyc2lvbi5cbiAgICovXG4gIHB1YmxpYyBjcmVhdGVWZXJzaW9uKGRlc2NyaXB0aW9uPzogc3RyaW5nKTogc3RyaW5nIHtcbiAgICBjb25zdCBjZm5WZXJzaW9uID0gbmV3IGJlZHJvY2suQ2ZuR3VhcmRyYWlsVmVyc2lvbih0aGlzLCBgR3VhcmRyYWlsVmVyc2lvbi0ke3RoaXMuaGFzaC5zbGljZSgwLCAxNil9YCwge1xuICAgICAgZGVzY3JpcHRpb246IGRlc2NyaXB0aW9uLFxuICAgICAgZ3VhcmRyYWlsSWRlbnRpZmllcjogdGhpcy5ndWFyZHJhaWxJZCxcbiAgICB9KTtcblxuICAgIHRoaXMuZ3VhcmRyYWlsVmVyc2lvbiA9IGNmblZlcnNpb24uYXR0clZlcnNpb247XG4gICAgcmV0dXJuIHRoaXMuZ3VhcmRyYWlsVmVyc2lvbjtcbiAgfVxuXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAvLyBDRk4gR2VuZXJhdG9yc1xuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgLyoqXG4gICAqIFJldHVybnMgdGhlIGNvbnRlbnQgZmlsdGVycyBhcHBsaWVkIHRvIHRoZSBndWFyZHJhaWwuIFRoaXMgbWV0aG9kIGRlZmVycyB0aGUgY29tcHV0YXRpb25cbiAgICogdG8gc3ludGggdGltZS5cbiAgICovXG4gIHByaXZhdGUgZ2VuZXJhdGVDZm5Db250ZW50UG9saWN5Q29uZmlnKCk6IElSZXNvbHZhYmxlIHtcbiAgICByZXR1cm4gTGF6eS5hbnkoe1xuICAgICAgcHJvZHVjZTogKCkgPT4ge1xuICAgICAgICBpZiAodGhpcy5jb250ZW50RmlsdGVycy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgcmV0dXJuIHsgZmlsdGVyc0NvbmZpZzogdGhpcy5jb250ZW50RmlsdGVycyB9IGFzIGJlZHJvY2suQ2ZuR3VhcmRyYWlsLkNvbnRlbnRQb2xpY3lDb25maWdQcm9wZXJ0eTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgdGhlIHRvcGljIGZpbHRlcnMgYXBwbGllZCB0byB0aGUgZ3VhcmRyYWlsLiBUaGlzIG1ldGhvZCBkZWZlcnMgdGhlIGNvbXB1dGF0aW9uXG4gICAqIHRvIHN5bnRoIHRpbWUuXG4gICAqL1xuICBwcml2YXRlIGdlbmVyYXRlQ2ZuVG9waWNQb2xpY3koKTogSVJlc29sdmFibGUge1xuICAgIHJldHVybiBMYXp5LmFueSh7XG4gICAgICBwcm9kdWNlOiAoKSA9PiB7XG4gICAgICAgIGlmICh0aGlzLmRlbmllZFRvcGljcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHRvcGljc0NvbmZpZzogdGhpcy5kZW5pZWRUb3BpY3MuZmxhdE1hcCgodG9waWM6IGZpbHRlcnMuVG9waWMpID0+IHtcbiAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBkZWZpbml0aW9uOiB0b3BpYy5kZWZpbml0aW9uLFxuICAgICAgICAgICAgICAgIG5hbWU6IHRvcGljLm5hbWUsXG4gICAgICAgICAgICAgICAgZXhhbXBsZXM6IHRvcGljLmV4YW1wbGVzLFxuICAgICAgICAgICAgICAgIHR5cGU6ICdERU5ZJyxcbiAgICAgICAgICAgICAgfSBhcyBiZWRyb2NrLkNmbkd1YXJkcmFpbC5Ub3BpY0NvbmZpZ1Byb3BlcnR5O1xuICAgICAgICAgICAgfSksXG4gICAgICAgICAgfTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgdGhlIGNvbnRlY3R1YWwgZmlsdGVycyBhcHBsaWVkIHRvIHRoZSBndWFyZHJhaWwuIFRoaXMgbWV0aG9kIGRlZmVycyB0aGUgY29tcHV0YXRpb25cbiAgICogdG8gc3ludGggdGltZS5cbiAgICovXG4gIHByaXZhdGUgZ2VuZXJhdGVDZm5Db250ZXh0dWFsUG9saWN5Q29uZmlnKCk6IElSZXNvbHZhYmxlIHtcbiAgICByZXR1cm4gTGF6eS5hbnkoe1xuICAgICAgcHJvZHVjZTogKCkgPT4ge1xuICAgICAgICBpZiAodGhpcy5jb250ZXh0dWFsR3JvdW5kaW5nRmlsdGVycy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGZpbHRlcnNDb25maWc6IHRoaXMuY29udGV4dHVhbEdyb3VuZGluZ0ZpbHRlcnMuZmxhdE1hcCgoZmlsdGVyOiBmaWx0ZXJzLkNvbnRleHR1YWxHcm91bmRpbmdGaWx0ZXIpID0+IHtcbiAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB0eXBlOiBmaWx0ZXIudHlwZSxcbiAgICAgICAgICAgICAgICB0aHJlc2hvbGQ6IGZpbHRlci50aHJlc2hvbGQsXG4gICAgICAgICAgICAgIH0gYXMgYmVkcm9jay5DZm5HdWFyZHJhaWwuQ29udGV4dHVhbEdyb3VuZGluZ0ZpbHRlckNvbmZpZ1Byb3BlcnR5O1xuICAgICAgICAgICAgfSksXG4gICAgICAgICAgfTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgdGhlIHdvcmQgY29uZmlnIGFwcGxpZWQgdG8gdGhlIGd1YXJkcmFpbC4gVGhpcyBtZXRob2QgZGVmZXJzIHRoZSBjb21wdXRhdGlvblxuICAgKiB0byBzeW50aCB0aW1lLlxuICAgKi9cbiAgcHJpdmF0ZSBnZW5lcmF0ZUNmbldvcmRQb2xpY3lDb25maWcoKTogSVJlc29sdmFibGUge1xuICAgIHJldHVybiBMYXp5LmFueSh7XG4gICAgICBwcm9kdWNlOiAoKSA9PiB7XG4gICAgICAgIGlmICh0aGlzLndvcmRGaWx0ZXJzLmxlbmd0aCA+IDAgfHwgdGhpcy5tYW5hZ2VkV29yZExpc3RGaWx0ZXJzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgd29yZHNDb25maWc6IHRoaXMuZ2VuZXJhdGVDZm5Xb3JkQ29uZmlnKCksXG4gICAgICAgICAgICBtYW5hZ2VkV29yZExpc3RzQ29uZmlnOiB0aGlzLmdlbmVyYXRlQ2ZuTWFuYWdlZFdvcmRMaXN0c0NvbmZpZygpLFxuICAgICAgICAgIH0gYXMgYmVkcm9jay5DZm5HdWFyZHJhaWwuV29yZFBvbGljeUNvbmZpZ1Byb3BlcnR5O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyB0aGUgd29yZCBmaWx0ZXJzIGFwcGxpZWQgdG8gdGhlIGd1YXJkcmFpbC4gVGhpcyBtZXRob2QgZGVmZXJzIHRoZSBjb21wdXRhdGlvblxuICAgKiB0byBzeW50aCB0aW1lLlxuICAgKi9cbiAgcHJpdmF0ZSBnZW5lcmF0ZUNmbldvcmRDb25maWcoKTogSVJlc29sdmFibGUge1xuICAgIHJldHVybiBMYXp5LmFueShcbiAgICAgIHtcbiAgICAgICAgcHJvZHVjZTogKCkgPT4ge1xuICAgICAgICAgIHJldHVybiB0aGlzLndvcmRGaWx0ZXJzLmZsYXRNYXAoKHdvcmQ6IGZpbHRlcnMuV29yZEZpbHRlcikgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgdGV4dDogd29yZC50ZXh0LFxuICAgICAgICAgICAgICBpbnB1dEFjdGlvbjogd29yZC5pbnB1dEFjdGlvbixcbiAgICAgICAgICAgICAgaW5wdXRFbmFibGVkOiB3b3JkLmlucHV0RW5hYmxlZCxcbiAgICAgICAgICAgICAgb3V0cHV0QWN0aW9uOiB3b3JkLm91dHB1dEFjdGlvbixcbiAgICAgICAgICAgICAgb3V0cHV0RW5hYmxlZDogd29yZC5vdXRwdXRFbmFibGVkLFxuICAgICAgICAgICAgfSBhcyBiZWRyb2NrLkNmbkd1YXJkcmFpbC5Xb3JkQ29uZmlnUHJvcGVydHk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAgeyBvbWl0RW1wdHlBcnJheTogdHJ1ZSB9LFxuICAgICk7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyB0aGUgd29yZCBmaWx0ZXJzIGFwcGxpZWQgdG8gdGhlIGd1YXJkcmFpbC4gVGhpcyBtZXRob2QgZGVmZXJzIHRoZSBjb21wdXRhdGlvblxuICAgKiB0byBzeW50aCB0aW1lLlxuICAgKi9cbiAgcHJpdmF0ZSBnZW5lcmF0ZUNmbk1hbmFnZWRXb3JkTGlzdHNDb25maWcoKTogSVJlc29sdmFibGUge1xuICAgIHJldHVybiBMYXp5LmFueShcbiAgICAgIHtcbiAgICAgICAgcHJvZHVjZTogKCkgPT4ge1xuICAgICAgICAgIHJldHVybiB0aGlzLm1hbmFnZWRXb3JkTGlzdEZpbHRlcnMuZmxhdE1hcCgoZmlsdGVyOiBmaWx0ZXJzLk1hbmFnZWRXb3JkRmlsdGVyKSA9PiB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICB0eXBlOiBmaWx0ZXIudHlwZSxcbiAgICAgICAgICAgICAgaW5wdXRBY3Rpb246IGZpbHRlci5pbnB1dEFjdGlvbixcbiAgICAgICAgICAgICAgaW5wdXRFbmFibGVkOiBmaWx0ZXIuaW5wdXRFbmFibGVkLFxuICAgICAgICAgICAgICBvdXRwdXRBY3Rpb246IGZpbHRlci5vdXRwdXRBY3Rpb24sXG4gICAgICAgICAgICAgIG91dHB1dEVuYWJsZWQ6IGZpbHRlci5vdXRwdXRFbmFibGVkLFxuICAgICAgICAgICAgfSBhcyBiZWRyb2NrLkNmbkd1YXJkcmFpbC5NYW5hZ2VkV29yZHNDb25maWdQcm9wZXJ0eTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgICB7IG9taXRFbXB0eUFycmF5OiB0cnVlIH0sXG4gICAgKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIHRoZSBzZW5zaXRpdmUgaW5mb3JtYXRpb24gY29uZmlnIGFwcGxpZWQgdG8gdGhlIGd1YXJkcmFpbC4gVGhpcyBtZXRob2QgZGVmZXJzIHRoZSBjb21wdXRhdGlvblxuICAgKiB0byBzeW50aCB0aW1lLlxuICAgKi9cbiAgcHJpdmF0ZSBnZW5lcmF0ZUNmblNlbnNpdGl2ZUluZm9ybWF0aW9uUG9saWN5Q29uZmlnKCk6IElSZXNvbHZhYmxlIHtcbiAgICByZXR1cm4gTGF6eS5hbnkoXG4gICAgICB7XG4gICAgICAgIHByb2R1Y2U6ICgpID0+IHtcbiAgICAgICAgICBpZiAodGhpcy5yZWdleEZpbHRlcnMubGVuZ3RoID4gMCB8fCB0aGlzLnBpaUZpbHRlcnMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgcmVnZXhlc0NvbmZpZzogdGhpcy5nZW5lcmF0ZUNmblJlZ2V4ZXNDb25maWcoKSxcbiAgICAgICAgICAgICAgcGlpRW50aXRpZXNDb25maWc6IHRoaXMuZ2VuZXJhdGVDZm5QaWlFbnRpdGllc0NvbmZpZygpLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAgeyBvbWl0RW1wdHlBcnJheTogdHJ1ZSB9LFxuICAgICk7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyB0aGUgcmVnZXggZmlsdGVycyBhcHBsaWVkIHRvIHRoZSBndWFyZHJhaWwuIFRoaXMgbWV0aG9kIGRlZmVycyB0aGUgY29tcHV0YXRpb25cbiAgICogdG8gc3ludGggdGltZS5cbiAgICovXG4gIHByaXZhdGUgZ2VuZXJhdGVDZm5SZWdleGVzQ29uZmlnKCk6IElSZXNvbHZhYmxlIHtcbiAgICByZXR1cm4gTGF6eS5hbnkoXG4gICAgICB7XG4gICAgICAgIHByb2R1Y2U6ICgpID0+IHtcbiAgICAgICAgICByZXR1cm4gdGhpcy5yZWdleEZpbHRlcnMuZmxhdE1hcCgocmVnZXg6IGZpbHRlcnMuUmVnZXhGaWx0ZXIpID0+IHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgIG5hbWU6IHJlZ2V4Lm5hbWUsXG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiByZWdleC5kZXNjcmlwdGlvbixcbiAgICAgICAgICAgICAgcGF0dGVybjogcmVnZXgucGF0dGVybixcbiAgICAgICAgICAgICAgYWN0aW9uOiByZWdleC5hY3Rpb24sXG4gICAgICAgICAgICB9IGFzIGJlZHJvY2suQ2ZuR3VhcmRyYWlsLlJlZ2V4Q29uZmlnUHJvcGVydHk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAgeyBvbWl0RW1wdHlBcnJheTogdHJ1ZSB9LFxuICAgICk7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyB0aGUgUGlpIGZpbHRlcnMgYXBwbGllZCB0byB0aGUgZ3VhcmRyYWlsLiBUaGlzIG1ldGhvZCBkZWZlcnMgdGhlIGNvbXB1dGF0aW9uXG4gICAqIHRvIHN5bnRoIHRpbWUuXG4gICAqL1xuICBwcml2YXRlIGdlbmVyYXRlQ2ZuUGlpRW50aXRpZXNDb25maWcoKTogSVJlc29sdmFibGUge1xuICAgIHJldHVybiBMYXp5LmFueShcbiAgICAgIHtcbiAgICAgICAgcHJvZHVjZTogKCkgPT4ge1xuICAgICAgICAgIHJldHVybiB0aGlzLnBpaUZpbHRlcnMuZmxhdE1hcCgoZmlsdGVyOiBmaWx0ZXJzLlBJSUZpbHRlcikgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgdHlwZTogZmlsdGVyLnR5cGUsXG4gICAgICAgICAgICAgIGFjdGlvbjogZmlsdGVyLmFjdGlvbixcbiAgICAgICAgICAgIH0gYXMgYmVkcm9jay5DZm5HdWFyZHJhaWwuUGlpRW50aXR5Q29uZmlnUHJvcGVydHk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAgeyBvbWl0RW1wdHlBcnJheTogdHJ1ZSB9LFxuICAgICk7XG4gIH1cbn1cbiJdfQ==