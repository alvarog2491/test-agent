"use strict";
var _a;
Object.defineProperty(exports, "__esModule", { value: true });
exports.BaseClass = void 0;
const JSII_RTTI_SYMBOL_1 = Symbol.for("jsii.rtti");
/**
 *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.
 *
 *  Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except in compliance
 *  with the License. A copy of the License is located at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 *  or in the 'license' file accompanying this file. This file is distributed on an 'AS IS' BASIS, WITHOUT WARRANTIES
 *  OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing permissions
 *  and limitations under the License.
 */
const aws_cdk_lib_1 = require("aws-cdk-lib");
const appsync = require("aws-cdk-lib/aws-appsync");
const lambda = require("aws-cdk-lib/aws-lambda");
const logs = require("aws-cdk-lib/aws-logs");
const constructs_1 = require("constructs");
const construct_name_enum_1 = require("./construct-name-enum");
const utils_1 = require("../helpers/utils");
class BaseClass extends constructs_1.Construct {
    constructor(scope, id) {
        super(scope, id);
        /**
         * construct usage metric , added in template description
         */
        this.constructUsageMetric = 'uksb-1tupboc45';
        /**
         * enable disable lambda tracing
         *
         * @default - Active
         */
        this.lambdaTracing = lambda.Tracing.ACTIVE;
        /**
         * enable disable xray tracing
         *
         * @default - True
         */
        this.enablexray = true;
        /**
         * Default  log config for all constructs
         */
        this.fieldLogLevel = appsync.FieldLogLevel.ALL;
        /**
         * Default  log retention config for all constructs
         */
        this.retention = logs.RetentionDays.TEN_YEARS;
    }
    // overwrite default env suffix
    updateEnvSuffix(props) {
        let stage = '-dev';
        if (props?.stage) {
            stage = props.stage;
        }
        this.stage = stage;
    }
    /*
    * update template description with construct usage metric and
    * add AWS_SDK_UA_APP_ID to user agent on aws sdk.
    */
    updateConstructUsageMetricCode(props, scope, lambdaFunctions) {
        const solutionId = `genai_cdk_${utils_1.version}/${props.constructName}/${props.constructId}`;
        if (lambdaFunctions
            && lambdaFunctions.length > 0) {
            for (let lambdaFunction of lambdaFunctions) {
                lambdaFunction.addEnvironment('AWS_SDK_UA_APP_ID', solutionId);
            }
        }
        if (props && BaseClass.usageMetricMap.hasOwnProperty(props.constructName)) {
            BaseClass.usageMetricMap[props.constructName] = BaseClass.usageMetricMap[props.constructName] + 1;
        }
        else {
            throw Error('construct name is not present in usageMetricMap ');
        }
        const usageMetricMapSerialized = JSON.stringify(BaseClass.usageMetricMap).replace(/[{}]/g, '').replace(/"/g, '');
        // Description format :(usage id :uksb-1tupboc45)(version:0.0.0) (constructs :::{\"C1\":1,\"C2\":5,\"C3\":3,\"C4\":0,\"C5\":0,\"C6\":0,\"C7\":0,\"C8\":0}) ",
        // where C1,C2, etc are mapped with construct-name-enum and the values shows the number of time stack created/deleted.
        aws_cdk_lib_1.Stack.of(scope).templateOptions.description =
            `Description: (${this.constructUsageMetric}) (version:${utils_1.version}) (tag:${usageMetricMapSerialized}) `;
    }
    // observability
    addObservabilityToConstruct(props) {
        if (props.observability == false) {
            this.enablexray = false;
            this.lambdaTracing = lambda.Tracing.DISABLED;
            this.fieldLogLevel = appsync.FieldLogLevel.NONE;
            this.retention = logs.RetentionDays.TEN_YEARS;
        }
    }
}
exports.BaseClass = BaseClass;
_a = JSII_RTTI_SYMBOL_1;
BaseClass[_a] = { fqn: "@cdklabs/generative-ai-cdk-constructs.BaseClass", version: "0.1.312" };
/**
 * Record<string, number> , maps construct name with number of deployments
 */
BaseClass.usageMetricMap = {
    [construct_name_enum_1.ConstructName.AWSMODELDEPLOYMENTSAGEMAKER]: 0,
    [construct_name_enum_1.ConstructName.CUSTOMSAGEMAKERENDPOINT]: 0,
    [construct_name_enum_1.ConstructName.HUGGINGFACESAGEMAKERENDPOINT]: 0,
    [construct_name_enum_1.ConstructName.JUMPSTARTSAGEMAKERENDPOINT]: 0,
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmFzZS1jbGFzcy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9jb21tb24vYmFzZS1jbGFzcy9iYXNlLWNsYXNzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUE7Ozs7Ozs7Ozs7O0dBV0c7QUFFSCw2Q0FBb0M7QUFDcEMsbURBQW1EO0FBQ25ELGlEQUFpRDtBQUNqRCw2Q0FBNkM7QUFDN0MsMkNBQXVDO0FBQ3ZDLCtEQUFzRDtBQUN0RCw0Q0FBMkM7QUErQjNDLE1BQWEsU0FBVSxTQUFRLHNCQUFTO0lBK0N0QyxZQUFZLEtBQWdCLEVBQUUsRUFBVTtRQUN0QyxLQUFLLENBQUMsS0FBSyxFQUFFLEVBQUUsQ0FBQyxDQUFDO1FBckNuQjs7V0FFRztRQUNNLHlCQUFvQixHQUFHLGdCQUFnQixDQUFDO1FBU2pEOzs7O1dBSUc7UUFDSCxrQkFBYSxHQUFtQixNQUFNLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQztRQUV0RDs7OztXQUlHO1FBQ0gsZUFBVSxHQUFZLElBQUksQ0FBQztRQUUzQjs7V0FFRztRQUNILGtCQUFhLEdBQTBCLE9BQU8sQ0FBQyxhQUFhLENBQUMsR0FBRyxDQUFDO1FBRWpFOztXQUVHO1FBQ0gsY0FBUyxHQUF1QixJQUFJLENBQUMsYUFBYSxDQUFDLFNBQVMsQ0FBQztJQUk3RCxDQUFDO0lBRUQsK0JBQStCO0lBQ3JCLGVBQWUsQ0FBQyxLQUFxQjtRQUM3QyxJQUFJLEtBQUssR0FBRyxNQUFNLENBQUM7UUFDbkIsSUFBSSxLQUFLLEVBQUUsS0FBSyxFQUFFLENBQUM7WUFDakIsS0FBSyxHQUFHLEtBQUssQ0FBQyxLQUFLLENBQUM7UUFDdEIsQ0FBQztRQUNELElBQUksQ0FBQyxLQUFLLEdBQUcsS0FBSyxDQUFDO0lBQ3JCLENBQUM7SUFFRDs7O01BR0U7SUFDUSw4QkFBOEIsQ0FBQyxLQUFxQixFQUFFLEtBQWdCLEVBQUUsZUFBNkM7UUFFN0gsTUFBTSxVQUFVLEdBQUcsYUFBYSxlQUFPLElBQUksS0FBSyxDQUFDLGFBQWEsSUFBSSxLQUFLLENBQUMsV0FBVyxFQUFFLENBQUM7UUFFdEYsSUFBSSxlQUFlO2VBQ1osZUFBZSxDQUFDLE1BQU0sR0FBRyxDQUFDLEVBQUUsQ0FBQztZQUNsQyxLQUFLLElBQUksY0FBYyxJQUFJLGVBQWUsRUFBRSxDQUFDO2dCQUMzQyxjQUFjLENBQUMsY0FBYyxDQUMzQixtQkFBbUIsRUFBRSxVQUFVLENBQ2hDLENBQUM7WUFDSixDQUFDO1FBQ0gsQ0FBQztRQUVELElBQUksS0FBSyxJQUFJLFNBQVMsQ0FBQyxjQUFjLENBQUMsY0FBYyxDQUFDLEtBQUssQ0FBQyxhQUFhLENBQUMsRUFBRSxDQUFDO1lBQzFFLFNBQVMsQ0FBQyxjQUFjLENBQUMsS0FBSyxDQUFDLGFBQWEsQ0FBQyxHQUFHLFNBQVMsQ0FBQyxjQUFjLENBQUMsS0FBSyxDQUFDLGFBQWEsQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUNwRyxDQUFDO2FBQU0sQ0FBQztZQUNOLE1BQU0sS0FBSyxDQUFDLGtEQUFrRCxDQUFDLENBQUM7UUFDbEUsQ0FBQztRQUVELE1BQU0sd0JBQXdCLEdBQUcsSUFBSSxDQUFDLFNBQVMsQ0FBQyxTQUFTLENBQUMsY0FBYyxDQUFDLENBQUMsT0FBTyxDQUFDLE9BQU8sRUFBRSxFQUFFLENBQUMsQ0FBQyxPQUFPLENBQUMsSUFBSSxFQUFFLEVBQUUsQ0FBQyxDQUFDO1FBRWpILDZKQUE2SjtRQUM3SixzSEFBc0g7UUFDdEgsbUJBQUssQ0FBQyxFQUFFLENBQUMsS0FBSyxDQUFDLENBQUMsZUFBZSxDQUFDLFdBQVc7WUFDM0MsaUJBQWlCLElBQUksQ0FBQyxvQkFBb0IsY0FBYyxlQUFPLFVBQVcsd0JBQXdCLElBQUksQ0FBQztJQUN6RyxDQUFDO0lBRUQsZ0JBQWdCO0lBQ04sMkJBQTJCLENBQUMsS0FBcUI7UUFDekQsSUFBSSxLQUFLLENBQUMsYUFBYSxJQUFJLEtBQUssRUFBRSxDQUFDO1lBQ2pDLElBQUksQ0FBQyxVQUFVLEdBQUcsS0FBSyxDQUFDO1lBQ3hCLElBQUksQ0FBQyxhQUFhLEdBQUcsTUFBTSxDQUFDLE9BQU8sQ0FBQyxRQUFRLENBQUM7WUFDN0MsSUFBSSxDQUFDLGFBQWEsR0FBRyxPQUFPLENBQUMsYUFBYSxDQUFDLElBQUksQ0FBQztZQUNoRCxJQUFJLENBQUMsU0FBUyxHQUFHLElBQUksQ0FBQyxhQUFhLENBQUMsU0FBUyxDQUFDO1FBQ2hELENBQUM7SUFDSCxDQUFDOztBQW5HSCw4QkFvR0M7OztBQW5HQzs7R0FFRztBQUNjLHdCQUFjLEdBQTRCO0lBQ3pELENBQUMsbUNBQWEsQ0FBQywyQkFBMkIsQ0FBQyxFQUFFLENBQUM7SUFDOUMsQ0FBQyxtQ0FBYSxDQUFDLHVCQUF1QixDQUFDLEVBQUUsQ0FBQztJQUMxQyxDQUFDLG1DQUFhLENBQUMsNEJBQTRCLENBQUMsRUFBRSxDQUFDO0lBQy9DLENBQUMsbUNBQWEsQ0FBQywwQkFBMEIsQ0FBQyxFQUFFLENBQUM7Q0FDOUMsQUFMOEIsQ0FLN0IiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqICBDb3B5cmlnaHQgQW1hem9uLmNvbSwgSW5jLiBvciBpdHMgYWZmaWxpYXRlcy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiAgTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKS4gWW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZVxuICogIHdpdGggdGhlIExpY2Vuc2UuIEEgY29weSBvZiB0aGUgTGljZW5zZSBpcyBsb2NhdGVkIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiAgb3IgaW4gdGhlICdsaWNlbnNlJyBmaWxlIGFjY29tcGFueWluZyB0aGlzIGZpbGUuIFRoaXMgZmlsZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAnQVMgSVMnIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVNcbiAqICBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBleHByZXNzIG9yIGltcGxpZWQuIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9uc1xuICogIGFuZCBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQgeyBTdGFjayB9IGZyb20gJ2F3cy1jZGstbGliJztcbmltcG9ydCAqIGFzIGFwcHN5bmMgZnJvbSAnYXdzLWNkay1saWIvYXdzLWFwcHN5bmMnO1xuaW1wb3J0ICogYXMgbGFtYmRhIGZyb20gJ2F3cy1jZGstbGliL2F3cy1sYW1iZGEnO1xuaW1wb3J0ICogYXMgbG9ncyBmcm9tICdhd3MtY2RrLWxpYi9hd3MtbG9ncyc7XG5pbXBvcnQgeyBDb25zdHJ1Y3QgfSBmcm9tICdjb25zdHJ1Y3RzJztcbmltcG9ydCB7IENvbnN0cnVjdE5hbWUgfSBmcm9tICcuL2NvbnN0cnVjdC1uYW1lLWVudW0nO1xuaW1wb3J0IHsgdmVyc2lvbiB9IGZyb20gJy4uL2hlbHBlcnMvdXRpbHMnO1xuXG5leHBvcnQgaW50ZXJmYWNlIEJhc2VDbGFzc1Byb3BzIHtcbiAgLyoqXG4gICAqIFZhbHVlIHdpbGwgYmUgYXBwZW5kZWQgdG8gcmVzb3VyY2VzIG5hbWUuXG4gICAqXG4gICAqIEBkZWZhdWx0IC0gX2RldlxuICAgKi9cbiAgcmVhZG9ubHkgc3RhZ2U/OiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIG5hbWUgb2YgdGhlIGNvbnN0cnVjdC5cbiAgICpcbiAgICovXG4gIHJlYWRvbmx5IGNvbnN0cnVjdE5hbWU6IENvbnN0cnVjdE5hbWU7XG5cbiAgLyoqXG4gICAqIGNvbnN0cnVjdCBpZC5cbiAgICpcbiAgICovXG4gIHJlYWRvbmx5IGNvbnN0cnVjdElkOiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIEVuYWJsZSBvYnNlcnZhYmlsaXR5LiBXYXJuaW5nOiBhc3NvY2lhdGVkIGNvc3Qgd2l0aCB0aGUgc2VydmljZXNcbiAgICogdXNlZC4gQmVzdCBwcmFjdGljZSB0byBlbmFibGUgYnkgZGVmYXVsdC5cbiAgICpcbiAgICogQGRlZmF1bHQgLSB0cnVlXG4gICAqL1xuICByZWFkb25seSBvYnNlcnZhYmlsaXR5PzogYm9vbGVhbjtcbn1cblxuZXhwb3J0IGNsYXNzIEJhc2VDbGFzcyBleHRlbmRzIENvbnN0cnVjdCB7XG4gIC8qKlxuICAgKiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+ICwgbWFwcyBjb25zdHJ1Y3QgbmFtZSB3aXRoIG51bWJlciBvZiBkZXBsb3ltZW50c1xuICAgKi9cbiAgcHJvdGVjdGVkIHN0YXRpYyB1c2FnZU1ldHJpY01hcCA6IFJlY29yZDxzdHJpbmcsIG51bWJlcj4gPSB7XG4gICAgW0NvbnN0cnVjdE5hbWUuQVdTTU9ERUxERVBMT1lNRU5UU0FHRU1BS0VSXTogMCxcbiAgICBbQ29uc3RydWN0TmFtZS5DVVNUT01TQUdFTUFLRVJFTkRQT0lOVF06IDAsXG4gICAgW0NvbnN0cnVjdE5hbWUuSFVHR0lOR0ZBQ0VTQUdFTUFLRVJFTkRQT0lOVF06IDAsXG4gICAgW0NvbnN0cnVjdE5hbWUuSlVNUFNUQVJUU0FHRU1BS0VSRU5EUE9JTlRdOiAwLFxuICB9O1xuXG4gIC8qKlxuICAgKiBjb25zdHJ1Y3QgdXNhZ2UgbWV0cmljICwgYWRkZWQgaW4gdGVtcGxhdGUgZGVzY3JpcHRpb25cbiAgICovXG4gIHJlYWRvbmx5IGNvbnN0cnVjdFVzYWdlTWV0cmljID0gJ3Vrc2ItMXR1cGJvYzQ1JztcblxuICAvKipcbiAgICogVmFsdWUgd2lsbCBiZSBhcHBlbmRlZCB0byByZXNvdXJjZXMgbmFtZS5cbiAgICpcbiAgICogQGRlZmF1bHQgLSBfZGV2XG4gICAqL1xuICBzdGFnZSE6IHN0cmluZztcblxuICAvKipcbiAgICogZW5hYmxlIGRpc2FibGUgbGFtYmRhIHRyYWNpbmdcbiAgICpcbiAgICogQGRlZmF1bHQgLSBBY3RpdmVcbiAgICovXG4gIGxhbWJkYVRyYWNpbmc6IGxhbWJkYS5UcmFjaW5nID0gbGFtYmRhLlRyYWNpbmcuQUNUSVZFO1xuXG4gIC8qKlxuICAgKiBlbmFibGUgZGlzYWJsZSB4cmF5IHRyYWNpbmdcbiAgICpcbiAgICogQGRlZmF1bHQgLSBUcnVlXG4gICAqL1xuICBlbmFibGV4cmF5OiBib29sZWFuID0gdHJ1ZTtcblxuICAvKipcbiAgICogRGVmYXVsdCAgbG9nIGNvbmZpZyBmb3IgYWxsIGNvbnN0cnVjdHNcbiAgICovXG4gIGZpZWxkTG9nTGV2ZWw6IGFwcHN5bmMuRmllbGRMb2dMZXZlbCA9IGFwcHN5bmMuRmllbGRMb2dMZXZlbC5BTEw7XG5cbiAgLyoqXG4gICAqIERlZmF1bHQgIGxvZyByZXRlbnRpb24gY29uZmlnIGZvciBhbGwgY29uc3RydWN0c1xuICAgKi9cbiAgcmV0ZW50aW9uOiBsb2dzLlJldGVudGlvbkRheXMgPSBsb2dzLlJldGVudGlvbkRheXMuVEVOX1lFQVJTO1xuXG4gIGNvbnN0cnVjdG9yKHNjb3BlOiBDb25zdHJ1Y3QsIGlkOiBzdHJpbmcpIHtcbiAgICBzdXBlcihzY29wZSwgaWQpO1xuICB9XG5cbiAgLy8gb3ZlcndyaXRlIGRlZmF1bHQgZW52IHN1ZmZpeFxuICBwcm90ZWN0ZWQgdXBkYXRlRW52U3VmZml4KHByb3BzOiBCYXNlQ2xhc3NQcm9wcykge1xuICAgIGxldCBzdGFnZSA9ICctZGV2JztcbiAgICBpZiAocHJvcHM/LnN0YWdlKSB7XG4gICAgICBzdGFnZSA9IHByb3BzLnN0YWdlO1xuICAgIH1cbiAgICB0aGlzLnN0YWdlID0gc3RhZ2U7XG4gIH1cblxuICAvKlxuICAqIHVwZGF0ZSB0ZW1wbGF0ZSBkZXNjcmlwdGlvbiB3aXRoIGNvbnN0cnVjdCB1c2FnZSBtZXRyaWMgYW5kXG4gICogYWRkIEFXU19TREtfVUFfQVBQX0lEIHRvIHVzZXIgYWdlbnQgb24gYXdzIHNkay5cbiAgKi9cbiAgcHJvdGVjdGVkIHVwZGF0ZUNvbnN0cnVjdFVzYWdlTWV0cmljQ29kZShwcm9wczogQmFzZUNsYXNzUHJvcHMsIHNjb3BlOiBDb25zdHJ1Y3QsIGxhbWJkYUZ1bmN0aW9uczogbGFtYmRhLkRvY2tlckltYWdlRnVuY3Rpb25bXSxcbiAgKSB7XG4gICAgY29uc3Qgc29sdXRpb25JZCA9IGBnZW5haV9jZGtfJHt2ZXJzaW9ufS8ke3Byb3BzLmNvbnN0cnVjdE5hbWV9LyR7cHJvcHMuY29uc3RydWN0SWR9YDtcblxuICAgIGlmIChsYW1iZGFGdW5jdGlvbnNcbiAgICAgICAgJiYgbGFtYmRhRnVuY3Rpb25zLmxlbmd0aCA+IDApIHtcbiAgICAgIGZvciAobGV0IGxhbWJkYUZ1bmN0aW9uIG9mIGxhbWJkYUZ1bmN0aW9ucykge1xuICAgICAgICBsYW1iZGFGdW5jdGlvbi5hZGRFbnZpcm9ubWVudChcbiAgICAgICAgICAnQVdTX1NES19VQV9BUFBfSUQnLCBzb2x1dGlvbklkLFxuICAgICAgICApO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChwcm9wcyAmJiBCYXNlQ2xhc3MudXNhZ2VNZXRyaWNNYXAuaGFzT3duUHJvcGVydHkocHJvcHMuY29uc3RydWN0TmFtZSkpIHtcbiAgICAgIEJhc2VDbGFzcy51c2FnZU1ldHJpY01hcFtwcm9wcy5jb25zdHJ1Y3ROYW1lXSA9IEJhc2VDbGFzcy51c2FnZU1ldHJpY01hcFtwcm9wcy5jb25zdHJ1Y3ROYW1lXSArIDE7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRocm93IEVycm9yKCdjb25zdHJ1Y3QgbmFtZSBpcyBub3QgcHJlc2VudCBpbiB1c2FnZU1ldHJpY01hcCAnKTtcbiAgICB9XG5cbiAgICBjb25zdCB1c2FnZU1ldHJpY01hcFNlcmlhbGl6ZWQgPSBKU09OLnN0cmluZ2lmeShCYXNlQ2xhc3MudXNhZ2VNZXRyaWNNYXApLnJlcGxhY2UoL1t7fV0vZywgJycpLnJlcGxhY2UoL1wiL2csICcnKTtcblxuICAgIC8vIERlc2NyaXB0aW9uIGZvcm1hdCA6KHVzYWdlIGlkIDp1a3NiLTF0dXBib2M0NSkodmVyc2lvbjowLjAuMCkgKGNvbnN0cnVjdHMgOjo6e1xcXCJDMVxcXCI6MSxcXFwiQzJcXFwiOjUsXFxcIkMzXFxcIjozLFxcXCJDNFxcXCI6MCxcXFwiQzVcXFwiOjAsXFxcIkM2XFxcIjowLFxcXCJDN1xcXCI6MCxcXFwiQzhcXFwiOjB9KSBcIixcbiAgICAvLyB3aGVyZSBDMSxDMiwgZXRjIGFyZSBtYXBwZWQgd2l0aCBjb25zdHJ1Y3QtbmFtZS1lbnVtIGFuZCB0aGUgdmFsdWVzIHNob3dzIHRoZSBudW1iZXIgb2YgdGltZSBzdGFjayBjcmVhdGVkL2RlbGV0ZWQuXG4gICAgU3RhY2sub2Yoc2NvcGUpLnRlbXBsYXRlT3B0aW9ucy5kZXNjcmlwdGlvbiA9XG4gICAgYERlc2NyaXB0aW9uOiAoJHt0aGlzLmNvbnN0cnVjdFVzYWdlTWV0cmljfSkgKHZlcnNpb246JHt2ZXJzaW9ufSkgKHRhZzokeyB1c2FnZU1ldHJpY01hcFNlcmlhbGl6ZWR9KSBgO1xuICB9XG5cbiAgLy8gb2JzZXJ2YWJpbGl0eVxuICBwcm90ZWN0ZWQgYWRkT2JzZXJ2YWJpbGl0eVRvQ29uc3RydWN0KHByb3BzOiBCYXNlQ2xhc3NQcm9wcykge1xuICAgIGlmIChwcm9wcy5vYnNlcnZhYmlsaXR5ID09IGZhbHNlKSB7XG4gICAgICB0aGlzLmVuYWJsZXhyYXkgPSBmYWxzZTtcbiAgICAgIHRoaXMubGFtYmRhVHJhY2luZyA9IGxhbWJkYS5UcmFjaW5nLkRJU0FCTEVEO1xuICAgICAgdGhpcy5maWVsZExvZ0xldmVsID0gYXBwc3luYy5GaWVsZExvZ0xldmVsLk5PTkU7XG4gICAgICB0aGlzLnJldGVudGlvbiA9IGxvZ3MuUmV0ZW50aW9uRGF5cy5URU5fWUVBUlM7XG4gICAgfVxuICB9XG59XG4iXX0=