"use strict";
var _a;
Object.defineProperty(exports, "__esModule", { value: true });
exports.AossCwDashboard = void 0;
const JSII_RTTI_SYMBOL_1 = Symbol.for("jsii.rtti");
/**
 *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.
 *
 *  Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except in compliance
 *  with the License. A copy of the License is located at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 *  or in the 'license' file accompanying this file. This file is distributed on an 'AS IS' BASIS, WITHOUT WARRANTIES
 *  OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing permissions
 *  and limitations under the License.
 */
const aws_cdk_lib_1 = require("aws-cdk-lib");
const aws_cloudwatch_1 = require("aws-cdk-lib/aws-cloudwatch");
const constructs_1 = require("constructs");
/**
 * The BedrockCwDashboard class.
 */
class AossCwDashboard extends constructs_1.Construct {
    /**
     * Constructs a new instance of the AossCwDashboard class.
     * @param {cdk.App} scope - represents the scope for all the resources.
     * @param {string} id - this is a a scope-unique id.
     * @param {AossCwDashboardProps} props - user provided props for the construct.
     * @since 0.0.0
     * @public
     */
    constructor(scope, id, props) {
        super(scope, id);
        this.dashboard = props.existingDashboard ?? new aws_cloudwatch_1.Dashboard(this, 'AossMetricsDashboard', {
            dashboardName: props.dashboardName ?? 'AossMetricsDashboard',
        });
    }
    /* Provide metrics for a specific aoss collection
     * @param {string} collectionName - Name of the aoss collection to monitor.
     * @param {string} collectionId - Id of the aoss collection to monitor.
     * @param {CollectionMonitoringProps} props - user provided props for monitoring.
    */
    addCollectionMonitoringbyAttributes(collectionName, collectionId, props) {
        const period = props.period ?? aws_cdk_lib_1.Duration.hours(1);
        const clientId = props.clientId ?? aws_cdk_lib_1.Aws.ACCOUNT_ID;
        const dimensionMap = {
            ClientId: clientId,
            CollectionId: collectionId,
            CollectionName: collectionName,
        };
        this.dashboard.addWidgets(new aws_cloudwatch_1.TextWidget({
            markdown: '# OpenSearch Vector Database (collection level)',
            width: 24,
        }));
        // Response codes
        this.dashboard.addWidgets(new aws_cloudwatch_1.GraphWidget({
            title: 'OpenSearch response codes',
            view: aws_cloudwatch_1.GraphWidgetView.TIME_SERIES,
            width: 12,
            left: [
                new aws_cloudwatch_1.Metric({
                    metricName: '2xx',
                    namespace: 'AWS/AOSS',
                    statistic: aws_cloudwatch_1.Stats.SUM,
                    dimensionsMap: dimensionMap,
                    period: period,
                }),
                new aws_cloudwatch_1.Metric({
                    metricName: '3xx',
                    namespace: 'AWS/AOSS',
                    statistic: aws_cloudwatch_1.Stats.SUM,
                    dimensionsMap: dimensionMap,
                    period: period,
                }),
                new aws_cloudwatch_1.Metric({
                    metricName: '4xx',
                    namespace: 'AWS/AOSS',
                    statistic: aws_cloudwatch_1.Stats.SUM,
                    dimensionsMap: dimensionMap,
                    period: period,
                }),
                new aws_cloudwatch_1.Metric({
                    metricName: '5xx',
                    namespace: 'AWS/AOSS',
                    statistic: aws_cloudwatch_1.Stats.SUM,
                    dimensionsMap: dimensionMap,
                    period: period,
                }),
            ],
        }));
        // Search
        this.dashboard.addWidgets(new aws_cloudwatch_1.GraphWidget({
            title: 'Search Request Latency',
            view: aws_cloudwatch_1.GraphWidgetView.TIME_SERIES,
            width: 12,
            left: [new aws_cloudwatch_1.Metric({
                    metricName: 'SearchRequestLatency',
                    namespace: 'AWS/AOSS',
                    statistic: aws_cloudwatch_1.Stats.AVERAGE,
                    dimensionsMap: dimensionMap,
                    period: period,
                })],
        }), new aws_cloudwatch_1.GraphWidget({
            title: 'Search Request Errors',
            view: aws_cloudwatch_1.GraphWidgetView.TIME_SERIES,
            width: 12,
            left: [new aws_cloudwatch_1.Metric({
                    metricName: 'SearchRequestErrors',
                    namespace: 'AWS/AOSS',
                    statistic: aws_cloudwatch_1.Stats.SUM,
                    dimensionsMap: dimensionMap,
                    period: period,
                })],
        }));
        // Ingestion
        this.dashboard.addWidgets(new aws_cloudwatch_1.GraphWidget({
            title: 'Ingestion Request Successes',
            view: aws_cloudwatch_1.GraphWidgetView.TIME_SERIES,
            width: 12,
            left: [new aws_cloudwatch_1.Metric({
                    metricName: 'IngestionRequestSuccess',
                    namespace: 'AWS/AOSS',
                    statistic: aws_cloudwatch_1.Stats.SUM,
                    dimensionsMap: dimensionMap,
                    period: period,
                })],
        }), new aws_cloudwatch_1.GraphWidget({
            title: 'Ingestion Request Rate',
            view: aws_cloudwatch_1.GraphWidgetView.TIME_SERIES,
            width: 12,
            left: [new aws_cloudwatch_1.Metric({
                    metricName: 'IngestionRequestRate',
                    namespace: 'AWS/AOSS',
                    statistic: aws_cloudwatch_1.Stats.AVERAGE,
                    dimensionsMap: dimensionMap,
                    period: period,
                })],
        }));
        this.dashboard.addWidgets(new aws_cloudwatch_1.GraphWidget({
            title: 'Ingestion Request Latency',
            view: aws_cloudwatch_1.GraphWidgetView.TIME_SERIES,
            width: 12,
            left: [new aws_cloudwatch_1.Metric({
                    metricName: 'IngestionRequestLatency',
                    namespace: 'AWS/AOSS',
                    statistic: aws_cloudwatch_1.Stats.AVERAGE,
                    dimensionsMap: dimensionMap,
                    period: period,
                })],
        }), new aws_cloudwatch_1.GraphWidget({
            title: 'Ingestion Request Errors',
            view: aws_cloudwatch_1.GraphWidgetView.TIME_SERIES,
            width: 12,
            left: [new aws_cloudwatch_1.Metric({
                    metricName: 'IngestionRequestErrors',
                    namespace: 'AWS/AOSS',
                    statistic: aws_cloudwatch_1.Stats.SUM,
                    dimensionsMap: dimensionMap,
                    period: period,
                })],
        }));
    }
    /* Provide metrics for a specific aoss collection
     * @param {string} collection - CfnCollection to monitor.
     * @param {CollectionMonitoringProps} props - user provided props for monitoring.
    */
    addCollectionMonitoringByCollection(collection, props) {
        this.addCollectionMonitoringbyAttributes(collection.name, collection.attrId, props);
    }
    /* Provide metrics for a specific aoss index
     * @param {string} collectionName - Name of the aoss collection to monitor.
     * @param {string} collectionId - Id of the aoss collection to monitor.
     * @param {string} IndexName - Name of the aoss index to monitor.
     * @param {string} IndexId - Id of the aoss index to monitor.
     * @param {IndexMonitoringProps} props - user provided props for monitoring.
    */
    addIndexMonitoringByAtributes(collectionName, collectionId, IndexName, IndexId, props) {
        const period = props.period ?? aws_cdk_lib_1.Duration.hours(1);
        const clientId = props.clientId ?? aws_cdk_lib_1.Aws.ACCOUNT_ID;
        const dimensionMap = {
            ClientId: clientId,
            CollectionId: collectionId,
            CollectionName: collectionName,
            IndexId: IndexId,
            IndexName: IndexName,
        };
        this.dashboard.addWidgets(new aws_cloudwatch_1.TextWidget({
            markdown: '# OpenSearch Vector Database (index level)',
            width: 24,
        }));
        this.dashboard.addWidgets(new aws_cloudwatch_1.GraphWidget({
            title: 'Deleted documents',
            view: aws_cloudwatch_1.GraphWidgetView.TIME_SERIES,
            width: 12,
            left: [new aws_cloudwatch_1.Metric({
                    metricName: 'DeletedDocuments',
                    namespace: 'AWS/AOSS',
                    statistic: aws_cloudwatch_1.Stats.SUM,
                    dimensionsMap: dimensionMap,
                    period: period,
                })],
        }), new aws_cloudwatch_1.GraphWidget({
            title: 'Searchable documents',
            view: aws_cloudwatch_1.GraphWidgetView.TIME_SERIES,
            width: 12,
            left: [new aws_cloudwatch_1.Metric({
                    metricName: 'SearchableDocuments',
                    namespace: 'AWS/AOSS',
                    statistic: aws_cloudwatch_1.Stats.SUM,
                    dimensionsMap: dimensionMap,
                    period: period,
                })],
        }));
        this.dashboard.addWidgets(new aws_cloudwatch_1.GraphWidget({
            title: 'S3 storage consumption',
            view: aws_cloudwatch_1.GraphWidgetView.TIME_SERIES,
            width: 12,
            left: [new aws_cloudwatch_1.Metric({
                    metricName: 'StorageUsedInS3',
                    namespace: 'AWS/AOSS',
                    statistic: aws_cloudwatch_1.Stats.SUM,
                    dimensionsMap: dimensionMap,
                    period: period,
                })],
        }), new aws_cloudwatch_1.GraphWidget({
            title: 'Document ingestion rate',
            view: aws_cloudwatch_1.GraphWidgetView.TIME_SERIES,
            width: 12,
            left: [new aws_cloudwatch_1.Metric({
                    metricName: 'IngestionDocumentRate',
                    namespace: 'AWS/AOSS',
                    statistic: aws_cloudwatch_1.Stats.SUM,
                    dimensionsMap: dimensionMap,
                    period: period,
                })],
        }));
        this.dashboard.addWidgets(new aws_cloudwatch_1.GraphWidget({
            title: 'Ingestion errors',
            view: aws_cloudwatch_1.GraphWidgetView.TIME_SERIES,
            width: 12,
            left: [new aws_cloudwatch_1.Metric({
                    metricName: 'IngestionDocumentErrors',
                    namespace: 'AWS/AOSS',
                    statistic: aws_cloudwatch_1.Stats.SUM,
                    dimensionsMap: dimensionMap,
                    period: period,
                })],
        }), new aws_cloudwatch_1.GraphWidget({
            title: 'Document data rate',
            view: aws_cloudwatch_1.GraphWidgetView.TIME_SERIES,
            width: 12,
            left: [new aws_cloudwatch_1.Metric({
                    metricName: 'IngestionDataRate',
                    namespace: 'AWS/AOSS',
                    statistic: aws_cloudwatch_1.Stats.SUM,
                    dimensionsMap: dimensionMap,
                    period: period,
                })],
        }));
    }
}
exports.AossCwDashboard = AossCwDashboard;
_a = JSII_RTTI_SYMBOL_1;
AossCwDashboard[_a] = { fqn: "@cdklabs/generative-ai-cdk-constructs.aosscwdashboard.AossCwDashboard", version: "0.1.312" };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvcGF0dGVybnMvZ2VuLWFpL2F3cy1hb3NzLWN3LWRhc2hib2FyZC9pbmRleC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUFBOzs7Ozs7Ozs7OztHQVdHO0FBRUgsNkNBQTRDO0FBQzVDLCtEQU9vQztBQUVwQywyQ0FBdUM7QUEwRHZDOztHQUVHO0FBQ0gsTUFBYSxlQUFnQixTQUFRLHNCQUFTO0lBTTVDOzs7Ozs7O09BT0c7SUFDSCxZQUFZLEtBQWdCLEVBQUUsRUFBVSxFQUFFLEtBQTJCO1FBQ25FLEtBQUssQ0FBQyxLQUFLLEVBQUUsRUFBRSxDQUFDLENBQUM7UUFFakIsSUFBSSxDQUFDLFNBQVMsR0FBRyxLQUFLLENBQUMsaUJBQWlCLElBQUksSUFBSSwwQkFBUyxDQUFDLElBQUksRUFBRSxzQkFBc0IsRUFBRTtZQUN0RixhQUFhLEVBQUUsS0FBSyxDQUFDLGFBQWEsSUFBSSxzQkFBc0I7U0FDN0QsQ0FBQyxDQUFDO0lBQ0wsQ0FBQztJQUVEOzs7O01BSUU7SUFDSyxtQ0FBbUMsQ0FBQyxjQUFzQixFQUFFLFlBQW9CLEVBQUUsS0FBZ0M7UUFDdkgsTUFBTSxNQUFNLEdBQUcsS0FBSyxDQUFDLE1BQU0sSUFBSSxzQkFBUSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNqRCxNQUFNLFFBQVEsR0FBRyxLQUFLLENBQUMsUUFBUSxJQUFJLGlCQUFHLENBQUMsVUFBVSxDQUFDO1FBRWxELE1BQU0sWUFBWSxHQUFHO1lBQ25CLFFBQVEsRUFBRSxRQUFRO1lBQ2xCLFlBQVksRUFBRSxZQUFZO1lBQzFCLGNBQWMsRUFBRSxjQUFjO1NBQy9CLENBQUM7UUFFRixJQUFJLENBQUMsU0FBUyxDQUFDLFVBQVUsQ0FBQyxJQUFJLDJCQUFVLENBQUM7WUFDdkMsUUFBUSxFQUFFLGlEQUFpRDtZQUMzRCxLQUFLLEVBQUUsRUFBRTtTQUNWLENBQUMsQ0FB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LDRCQUFXLENBQUM7WUFDZCxLQUFLLEVBQUUsa0JBQWtCO1lBQ3pCLElBQUksRUFBRSxnQ0FBZSxDQUFDLFdBQVc7WUFDakMsS0FBSyxFQUFFLEVBQUU7WUFDVCxJQUFJLEVBQUUsQ0FBQyxJQUFJLHVCQUFNLENBQUM7b0JBQ2hCLFVBQVUsRUFBRSx5QkFBeUI7b0JBQ3JDLFNBQVMsRUFBRSxVQUFVO29CQUNyQixTQUFTLEVBQUUsc0JBQUssQ0FBQyxHQUFHO29CQUNwQixhQUFhLEVBQUUsWUFBWTtvQkFDM0IsTUFBTSxFQUFFLE1BQU07aUJBQ2YsQ0FBQyxDQUFDO1NBQ0osQ0FBQyxFQUNGLElBQUksNEJBQVcsQ0FBQztZQUNkLEtBQUssRUFBRSxvQkFBb0I7WUFDM0IsSUFBSSxFQUFFLGdDQUFlLENBQUMsV0FBVztZQUNqQyxLQUFLLEVBQUUsRUFBRTtZQUNULElBQUksRUFBRSxDQUFDLElBQUksdUJBQU0sQ0FBQztvQkFDaEIsVUFBVSxFQUFFLG1CQUFtQjtvQkFDL0IsU0FBUyxFQUFFLFVBQVU7b0JBQ3JCLFNBQVMsRUFBRSxzQkFBSyxDQUFDLEdBQUc7b0JBQ3BCLGFBQWEsRUFBRSxZQUFZO29CQUMzQixNQUFNLEVBQUUsTUFBTTtpQkFDZixDQUFDLENBQUM7U0FDSixDQUFDLENBQ0gsQ0FBQztJQUNKLENBQUM7O0FBdlJILDBDQXdSQyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogIENvcHlyaWdodCBBbWF6b24uY29tLCBJbmMuIG9yIGl0cyBhZmZpbGlhdGVzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqICBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpLiBZb3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlXG4gKiAgd2l0aCB0aGUgTGljZW5zZS4gQSBjb3B5IG9mIHRoZSBMaWNlbnNlIGlzIGxvY2F0ZWQgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqICBvciBpbiB0aGUgJ2xpY2Vuc2UnIGZpbGUgYWNjb21wYW55aW5nIHRoaXMgZmlsZS4gVGhpcyBmaWxlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICdBUyBJUycgQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFU1xuICogIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGV4cHJlc3Mgb3IgaW1wbGllZC4gU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zXG4gKiAgYW5kIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7IER1cmF0aW9uLCBBd3MgfSBmcm9tICdhd3MtY2RrLWxpYic7XG5pbXBvcnQge1xuICBNZXRyaWMsXG4gIERhc2hib2FyZCxcbiAgR3JhcGhXaWRnZXQsXG4gIEdyYXBoV2lkZ2V0VmlldyxcbiAgU3RhdHMsXG4gIFRleHRXaWRnZXQsXG59IGZyb20gJ2F3cy1jZGstbGliL2F3cy1jbG91ZHdhdGNoJztcbmltcG9ydCB7IENmbkNvbGxlY3Rpb24gfSBmcm9tICdhd3MtY2RrLWxpYi9hd3Mtb3BlbnNlYXJjaHNlcnZlcmxlc3MnO1xuaW1wb3J0IHsgQ29uc3RydWN0IH0gZnJvbSAnY29uc3RydWN0cyc7XG5cbi8qKlxuICogVGhlIHByb3BlcnRpZXMgZm9yIHRoZSBDb2xsZWN0aW9uTW9uaXRvcmluZ1Byb3BzIGNsYXNzLlxuICovXG5leHBvcnQgaW50ZXJmYWNlIENvbGxlY3Rpb25Nb25pdG9yaW5nUHJvcHMge1xuICAvKlxuICAgICogT3B0aW9uYWwgLSBUaGUgcGVyaW9kIG92ZXIgd2hpY2ggdGhlIHNwZWNpZmllZCBzdGF0aXN0aWMgaXMgYXBwbGllZC5cbiAgICAqIEBkZWZhdWx0IC0gMSBob3VyXG4gICAgKi9cbiAgcmVhZG9ubHkgcGVyaW9kPzogRHVyYXRpb247XG5cbiAgLypcbiAgICAqIE9wdGlvbmFsIC0gVGhlIGNsaWVudCBJRCB0byB1c2UuXG4gICAgKiBAZGVmYXVsdCAtIEFjY291bnQgSURcbiAgICAqL1xuICByZWFkb25seSBjbGllbnRJZD86IHN0cmluZztcbn1cblxuLyoqXG4gKiBUaGUgcHJvcGVydGllcyBmb3IgdGhlIENvbGxlY3Rpb25Nb25pdG9yaW5nUHJvcHMgY2xhc3MuXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgSW5kZXhNb25pdG9yaW5nUHJvcHMge1xuICAvKlxuICAgICogT3B0aW9uYWwgLSBUaGUgcGVyaW9kIG92ZXIgd2hpY2ggdGhlIHNwZWNpZmllZCBzdGF0aXN0aWMgaXMgYXBwbGllZC5cbiAgICAqIEBkZWZhdWx0IC0gMSBob3VyXG4gICAgKi9cbiAgcmVhZG9ubHkgcGVyaW9kPzogRHVyYXRpb247XG4gIC8qXG4gICAgKiBPcHRpb25hbCAtIFRoZSBjbGllbnQgSUQgdG8gdXNlLlxuICAgICogQGRlZmF1bHQgLSBBY2NvdW50IElEXG4gICAgKi9cbiAgcmVhZG9ubHkgY2xpZW50SWQ/OiBzdHJpbmc7XG59XG5cbi8qKlxuICogVGhlIHByb3BlcnRpZXMgZm9yIHRoZSBCZWRyb2NrQ3dEYXNoYm9hcmRQcm9wcyBjbGFzcy5cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBBb3NzQ3dEYXNoYm9hcmRQcm9wcyB7XG5cbiAgLyoqXG4gICAqIE9wdGlvbmFsIEFuIGV4aXN0aW5nIGRhc2hib2FyZCB3aGVyZSBtZXRyaWNzIHdpbGwgYmUgYWRkZWQgdG8uXG4gICAqIElmIG5vdCBwcm92aWRlZCwgdGhlIGNvbnN0cnVjdCB3aWxsIGNyZWF0ZSBhIG5ldyBkYXNoYm9hcmRcbiAgICpcbiAgICogQGRlZmF1bHQgLSBub25lXG4gICAqL1xuICByZWFkb25seSBleGlzdGluZ0Rhc2hib2FyZD86IERhc2hib2FyZDtcblxuICAvKipcbiAgICogT3B0aW9uYWwgQSBuYW1lIGZvciB0aGUgZGFzaGJvYXJkIHdoaWNoIHdpbGwgYmUgY3JlYXRlZC5cbiAgICogSWYgZXhpc3RpbmdEYXNoYm9hcmQgaXMgZGVmaW5lZCwgdGhpcyB2YWx1ZSB3aWxsIGJlIGlnbm9yZWQuXG4gICAqIElmIG5vdCBwcm92aWRlZCwgdGhlIGNvbnN0cnVjdCB3aWxsIGNyZWF0ZSBhIG5ldyBkYXNoYm9hcmQgbmFtZWQgJ0JlZHJvY2tNZXRyaWNzRGFzaGJvYXJkJ1xuICAgKlxuICAgKiBAZGVmYXVsdCAtIG5vbmVcbiAgICovXG4gIHJlYWRvbmx5IGRhc2hib2FyZE5hbWU/OiBzdHJpbmc7XG59XG5cbi8qKlxuICogVGhlIEJlZHJvY2tDd0Rhc2hib2FyZCBjbGFzcy5cbiAqL1xuZXhwb3J0IGNsYXNzIEFvc3NDd0Rhc2hib2FyZCBleHRlbmRzIENvbnN0cnVjdCB7XG4gIC8qKlxuICAgKiBSZXR1cm5zIHRoZSBpbnN0YW5jZSBvZiBDbG91ZFdhdGNoIGRhc2hib2FyZCB1c2VkIGJ5IHRoZSBjb25zdHJ1Y3RcbiAgICovXG4gIHB1YmxpYyByZWFkb25seSBkYXNoYm9hcmQ6IERhc2hib2FyZDtcblxuICAvKipcbiAgICogQ29uc3RydWN0cyBhIG5ldyBpbnN0YW5jZSBvZiB0aGUgQW9zc0N3RGFzaGJvYXJkIGNsYXNzLlxuICAgKiBAcGFyYW0ge2Nkay5BcHB9IHNjb3BlIC0gcmVwcmVzZW50cyB0aGUgc2NvcGUgZm9yIGFsbCB0aGUgcmVzb3VyY2VzLlxuICAgKiBAcGFyYW0ge3N0cmluZ30gaWQgLSB0aGlzIGlzIGEgYSBzY29wZS11bmlxdWUgaWQuXG4gICAqIEBwYXJhbSB7QW9zc0N3RGFzaGJvYXJkUHJvcHN9IHByb3BzIC0gdXNlciBwcm92aWRlZCBwcm9wcyBmb3IgdGhlIGNvbnN0cnVjdC5cbiAgICogQHNpbmNlIDAuMC4wXG4gICAqIEBwdWJsaWNcbiAgICovXG4gIGNvbnN0cnVjdG9yKHNjb3BlOiBDb25zdHJ1Y3QsIGlkOiBzdHJpbmcsIHByb3BzOiBBb3NzQ3dEYXNoYm9hcmRQcm9wcykge1xuICAgIHN1cGVyKHNjb3BlLCBpZCk7XG5cbiAgICB0aGlzLmRhc2hib2FyZCA9IHByb3BzLmV4aXN0aW5nRGFzaGJvYXJkID8/IG5ldyBEYXNoYm9hcmQodGhpcywgJ0Fvc3NNZXRyaWNzRGFzaGJvYXJkJywge1xuICAgICAgZGFzaGJvYXJkTmFtZTogcHJvcHMuZGFzaGJvYXJkTmFtZSA/PyAnQW9zc01ldHJpY3NEYXNoYm9hcmQnLFxuICAgIH0pO1xuICB9XG5cbiAgLyogUHJvdmlkZSBtZXRyaWNzIGZvciBhIHNwZWNpZmljIGFvc3MgY29sbGVjdGlvblxuICAgKiBAcGFyYW0ge3N0cmluZ30gY29sbGVjdGlvbk5hbWUgLSBOYW1lIG9mIHRoZSBhb3NzIGNvbGxlY3Rpb24gdG8gbW9uaXRvci5cbiAgICogQHBhcmFtIHtzdHJpbmd9IGNvbGxlY3Rpb25JZCAtIElkIG9mIHRoZSBhb3NzIGNvbGxlY3Rpb24gdG8gbW9uaXRvci5cbiAgICogQHBhcmFtIHtDb2xsZWN0aW9uTW9uaXRvcmluZ1Byb3BzfSBwcm9wcyAtIHVzZXIgcHJvdmlkZWQgcHJvcHMgZm9yIG1vbml0b3JpbmcuXG4gICovXG4gIHB1YmxpYyBhZGRDb2xsZWN0aW9uTW9uaXRvcmluZ2J5QXR0cmlidXRlcyhjb2xsZWN0aW9uTmFtZTogc3RyaW5nLCBjb2xsZWN0aW9uSWQ6IHN0cmluZywgcHJvcHM6IENvbGxlY3Rpb25Nb25pdG9yaW5nUHJvcHMpIHtcbiAgICBjb25zdCBwZXJpb2QgPSBwcm9wcy5wZXJpb2QgPz8gRHVyYXRpb24uaG91cnMoMSk7XG4gICAgY29uc3QgY2xpZW50SWQgPSBwcm9wcy5jbGllbnRJZCA/PyBBd3MuQUNDT1VOVF9JRDtcblxuICAgIGNvbnN0IGRpbWVuc2lvbk1hcCA9IHtcbiAgICAgIENsaWVudElkOiBjbGllbnRJZCxcbiAgICAgIENvbGxlY3Rpb25JZDogY29sbGVjdGlvbklkLFxuICAgICAgQ29sbGVjdGlvbk5hbWU6IGNvbGxlY3Rpb25OYW1lLFxuICAgIH07XG5cbiAgICB0aGlzLmRhc2hib2FyZC5hZGRXaWRnZXRzKG5ldyBUZXh0V2lkZ2V0KHtcbiAgICAgIG1hcmtkb3duOiAnIyBPcGVuU2VhcmNoIFZlY3RvciBEYXRhYmFzZSAoY29sbGVjdGlvbiBsZXZlbCknLFxuICAgICAgd2lkdGg6IDI0LFxuICAgIH0pKTtcblxuICAgIC8vIFJlc3BvbnNlIGNvZGVzXG4gICAgdGhpcy5kYXNoYm9hcmQuYWRkV2lkZ2V0cyhcbiAgICAgIG5ldyBHcmFwaFdpZGdldCh7XG4gICAgICAgIHRpdGxlOiAnT3BlblNlYXJjaCByZXNwb25zZSBjb2RlcycsXG4gICAgICAgIHZpZXc6IEdyYXBoV2lkZ2V0Vmlldy5USU1FX1NFUklFUyxcbiAgICAgICAgd2lkdGg6IDEyLFxuICAgICAgICBsZWZ0OiBbXG4gICAgICAgICAgbmV3IE1ldHJpYyh7XG4gICAgICAgICAgICBtZXRyaWNOYW1lOiAnMnh4JyxcbiAgICAgICAgICAgIG5hbWVzcGFjZTogJ0FXUy9BT1NTJyxcbiAgICAgICAgICAgIHN0YXRpc3RpYzogU3RhdHMuU1VNLFxuICAgICAgICAgICAgZGltZW5zaW9uc01hcDogZGltZW5zaW9uTWFwLFxuICAgICAgICAgICAgcGVyaW9kOiBwZXJpb2QsXG4gICAgICAgICAgfSksXG4gICAgICAgICAgbmV3IE1ldHJpYyh7XG4gICAgICAgICAgICBtZXRyaWNOYW1lOiAnM3h4JyxcbiAgICAgICAgICAgIG5hbWVzcGFjZTogJ0FXUy9BT1NTJyxcbiAgICAgICAgICAgIHN0YXRpc3RpYzogU3RhdHMuU1VNLFxuICAgICAgICAgICAgZGltZW5zaW9uc01hcDogZGltZW5zaW9uTWFwLFxuICAgICAgICAgICAgcGVyaW9kOiBwZXJpb2QsXG4gICAgICAgICAgfSksXG4gICAgICAgICAgbmV3IE1ldHJpYyh7XG4gICAgICAgICAgICBtZXRyaWNOYW1lOiAnNHh4JyxcbiAgICAgICAgICAgIG5hbWVzcGFjZTogJ0FXUy9BT1NTJyxcbiAgICAgICAgICAgIHN0YXRpc3RpYzogU3RhdHMuU1VNLFxuICAgICAgICAgICAgZGltZW5zaW9uc01hcDogZGltZW5zaW9uTWFwLFxuICAgICAgICAgICAgcGVyaW9kOiBwZXJpb2QsXG4gICAgICAgICAgfSksXG4gICAgICAgICAgbmV3IE1ldHJpYyh7XG4gICAgICAgICAgICBtZXRyaWNOYW1lOiAnNXh4JyxcbiAgICAgICAgICAgIG5hbWVzcGFjZTogJ0FXUy9BT1NTJyxcbiAgICAgICAgICAgIHN0YXRpc3RpYzogU3RhdHMuU1VNLFxuICAgICAgICAgICAgZGltZW5zaW9uc01hcDogZGltZW5zaW9uTWFwLFxuICAgICAgICAgICAgcGVyaW9kOiBwZXJpb2QsXG4gICAgICAgICAgfSksXG4gICAgICAgIF0sXG4gICAgICB9KSxcbiAgICApO1xuXG4gICAgLy8gU2VhcmNoXG4gICAgdGhpcy5kYXNoYm9hcmQuYWRkV2lkZ2V0cyhcbiAgICAgIG5ldyBHcmFwaFdpZGdldCh7XG4gICAgICAgIHRpdGxlOiAnU2VhcmNoIFJlcXVlc3QgTGF0ZW5jeScsXG4gICAgICAgIHZpZXc6IEdyYXBoV2lkZ2V0Vmlldy5USU1FX1NFUklFUyxcbiAgICAgICAgd2lkdGg6IDEyLFxuICAgICAgICBsZWZ0OiBbbmV3IE1ldHJpYyh7XG4gICAgICAgICAgbWV0cmljTmFtZTogJ1NlYXJjaFJlcXVlc3RMYXRlbmN5JyxcbiAgICAgICAgICBuYW1lc3BhY2U6ICdBV1MvQU9TUycsXG4gICAgICAgICAgc3RhdGlzdGljOiBTdGF0cy5BVkVSQUdFLFxuICAgICAgICAgIGRpbWVuc2lvbnNNYXA6IGRpbWVuc2lvbk1hcCxcbiAgICAgICAgICBwZXJpb2Q6IHBlcmlvZCxcbiAgICAgICAgfSldLFxuICAgICAgfSksXG4gICAgICBuZXcgR3JhcGhXaWRnZXQoe1xuICAgICAgICB0aXRsZTogJ1NlYXJjaCBSZXF1ZXN0IEVycm9ycycsXG4gICAgICAgIHZpZXc6IEdyYXBoV2lkZ2V0Vmlldy5USU1FX1NFUklFUyxcbiAgICAgICAgd2lkdGg6IDEyLFxuICAgICAgICBsZWZ0OiBbbmV3IE1ldHJpYyh7XG4gICAgICAgICAgbWV0cmljTmFtZTogJ1NlYXJjaFJlcXVlc3RFcnJvcnMnLFxuICAgICAgICAgIG5hbWVzcGFjZTogJ0FXUy9BT1NTJyxcbiAgICAgICAgICBzdGF0aXN0aWM6IFN0YXRzLlNVTSxcbiAgICAgICAgICBkaW1lbnNpb25zTWFwOiBkaW1lbnNpb25NYXAsXG4gICAgICAgICAgcGVyaW9kOiBwZXJpb2QsXG4gICAgICAgIH0pXSxcbiAgICAgIH0pLFxuICAgICk7XG5cbiAgICAvLyBJbmdlc3Rpb25cbiAgICB0aGlzLmRhc2hib2FyZC5hZGRXaWRnZXRzKFxuICAgICAgbmV3IEdyYXBoV2lkZ2V0KHtcbiAgICAgICAgdGl0bGU6ICdJbmdlc3Rpb24gUmVxdWVzdCBTdWNjZXNzZXMnLFxuICAgICAgICB2aWV3OiBHcmFwaFdpZGdldFZpZXcuVElNRV9TRVJJRVMsXG4gICAgICAgIHdpZHRoOiAxMixcbiAgICAgICAgbGVmdDogW25ldyBNZXRyaWMoe1xuICAgICAgICAgIG1ldHJpY05hbWU6ICdJbmdlc3Rpb25SZXF1ZXN0U3VjY2VzcycsXG4gICAgICAgICAgbmFtZXNwYWNlOiAnQVdTL0FPU1MnLFxuICAgICAgICAgIHN0YXRpc3RpYzogU3RhdHMuU1VNLFxuICAgICAgICAgIGRpbWVuc2lvbnNNYXA6IGRpbWVuc2lvbk1hcCxcbiAgICAgICAgICBwZXJpb2Q6IHBlcmlvZCxcbiAgICAgICAgfSldLFxuICAgICAgfSksXG4gICAgICBuZXcgR3JhcGhXaWRnZXQoe1xuICAgICAgICB0aXRsZTogJ0luZ2VzdGlvbiBSZXF1ZXN0IFJhdGUnLFxuICAgICAgICB2aWV3OiBHcmFwaFdpZGdldFZpZXcuVElNRV9TRVJJRVMsXG4gICAgICAgIHdpZHRoOiAxMixcbiAgICAgICAgbGVmdDogW25ldyBNZXRyaWMoe1xuICAgICAgICAgIG1ldHJpY05hbWU6ICdJbmdlc3Rpb25SZXF1ZXN0UmF0ZScsXG4gICAgICAgICAgbmFtZXNwYWNlOiAnQVdTL0FPU1MnLFxuICAgICAgICAgIHN0YXRpc3RpYzogU3RhdHMuQVZFUkFHRSxcbiAgICAgICAgICBkaW1lbnNpb25zTWFwOiBkaW1lbnNpb25NYXAsXG4gICAgICAgICAgcGVyaW9kOiBwZXJpb2QsXG4gICAgICAgIH0pXSxcbiAgICAgIH0pLFxuICAgICk7XG4gICAgdGhpcy5kYXNoYm9hcmQuYWRkV2lkZ2V0cyhcbiAgICAgIG5ldyBHcmFwaFdpZGdldCh7XG4gICAgICAgIHRpdGxlOiAnSW5nZXN0aW9uIFJlcXVlc3QgTGF0ZW5jeScsXG4gICAgICAgIHZpZXc6IEdyYXBoV2lkZ2V0Vmlldy5USU1FX1NFUklFUyxcbiAgICAgICAgd2lkdGg6IDEyLFxuICAgICAgICBsZWZ0OiBbbmV3IE1ldHJpYyh7XG4gICAgICAgICAgbWV0cmljTmFtZTogJ0luZ2VzdGlvblJlcXVlc3RMYXRlbmN5JyxcbiAgICAgICAgICBuYW1lc3BhY2U6ICdBV1MvQU9TUycsXG4gICAgICAgICAgc3RhdGlzdGljOiBTdGF0cy5BVkVSQUdFLFxuICAgICAgICAgIGRpbWVuc2lvbnNNYXA6IGRpbWVuc2lvbk1hcCxcbiAgICAgICAgICBwZXJpb2Q6IHBlcmlvZCxcbiAgICAgICAgfSldLFxuICAgICAgfSksXG4gICAgICBuZXcgR3JhcGhXaWRnZXQoe1xuICAgICAgICB0aXRsZTogJ0luZ2VzdGlvbiBSZXF1ZXN0IEVycm9ycycsXG4gICAgICAgIHZpZXc6IEdyYXBoV2lkZ2V0Vmlldy5USU1FX1NFUklFUyxcbiAgICAgICAgd2lkdGg6IDEyLFxuICAgICAgICBsZWZ0OiBbbmV3IE1ldHJpYyh7XG4gICAgICAgICAgbWV0cmljTmFtZTogJ0luZ2VzdGlvblJlcXVlc3RFcnJvcnMnLFxuICAgICAgICAgIG5hbWVzcGFjZTogJ0FXUy9BT1NTJyxcbiAgICAgICAgICBzdGF0aXN0aWM6IFN0YXRzLlNVTSxcbiAgICAgICAgICBkaW1lbnNpb25zTWFwOiBkaW1lbnNpb25NYXAsXG4gICAgICAgICAgcGVyaW9kOiBwZXJpb2QsXG4gICAgICAgIH0pXSxcbiAgICAgIH0pLFxuICAgICk7XG4gIH1cblxuICAvKiBQcm92aWRlIG1ldHJpY3MgZm9yIGEgc3BlY2lmaWMgYW9zcyBjb2xsZWN0aW9uXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBjb2xsZWN0aW9uIC0gQ2ZuQ29sbGVjdGlvbiB0byBtb25pdG9yLlxuICAgKiBAcGFyYW0ge0NvbGxlY3Rpb25Nb25pdG9yaW5nUHJvcHN9IHByb3BzIC0gdXNlciBwcm92aWRlZCBwcm9wcyBmb3IgbW9uaXRvcmluZy5cbiAgKi9cbiAgcHVibGljIGFkZENvbGxlY3Rpb25Nb25pdG9yaW5nQnlDb2xsZWN0aW9uKGNvbGxlY3Rpb246IENmbkNvbGxlY3Rpb24sIHByb3BzOiBDb2xsZWN0aW9uTW9uaXRvcmluZ1Byb3BzKSB7XG4gICAgdGhpcy5hZGRDb2xsZWN0aW9uTW9uaXRvcmluZ2J5QXR0cmlidXRlcyhjb2xsZWN0aW9uLm5hbWUsIGNvbGxlY3Rpb24uYXR0cklkLCBwcm9wcyk7XG4gIH1cblxuICAvKiBQcm92aWRlIG1ldHJpY3MgZm9yIGEgc3BlY2lmaWMgYW9zcyBpbmRleFxuICAgKiBAcGFyYW0ge3N0cmluZ30gY29sbGVjdGlvbk5hbWUgLSBOYW1lIG9mIHRoZSBhb3NzIGNvbGxlY3Rpb24gdG8gbW9uaXRvci5cbiAgICogQHBhcmFtIHtzdHJpbmd9IGNvbGxlY3Rpb25JZCAtIElkIG9mIHRoZSBhb3NzIGNvbGxlY3Rpb24gdG8gbW9uaXRvci5cbiAgICogQHBhcmFtIHtzdHJpbmd9IEluZGV4TmFtZSAtIE5hbWUgb2YgdGhlIGFvc3MgaW5kZXggdG8gbW9uaXRvci5cbiAgICogQHBhcmFtIHtzdHJpbmd9IEluZGV4SWQgLSBJZCBvZiB0aGUgYW9zcyBpbmRleCB0byBtb25pdG9yLlxuICAgKiBAcGFyYW0ge0luZGV4TW9uaXRvcmluZ1Byb3BzfSBwcm9wcyAtIHVzZXIgcHJvdmlkZWQgcHJvcHMgZm9yIG1vbml0b3JpbmcuXG4gICovXG4gIHB1YmxpYyBhZGRJbmRleE1vbml0b3JpbmdCeUF0cmlidXRlcyhcbiAgICBjb2xsZWN0aW9uTmFtZTogc3RyaW5nLFxuICAgIGNvbGxlY3Rpb25JZDogc3RyaW5nLFxuICAgIEluZGV4TmFtZTogc3RyaW5nLFxuICAgIEluZGV4SWQ6IHN0cmluZyxcbiAgICBwcm9wczogSW5kZXhNb25pdG9yaW5nUHJvcHMsXG4gICkge1xuICAgIGNvbnN0IHBlcmlvZCA9IHByb3BzLnBlcmlvZCA/PyBEdXJhdGlvbi5ob3VycygxKTtcbiAgICBjb25zdCBjbGllbnRJZCA9IHByb3BzLmNsaWVudElkID8/IEF3cy5BQ0NPVU5UX0lEO1xuXG4gICAgY29uc3QgZGltZW5zaW9uTWFwID0ge1xuICAgICAgQ2xpZW50SWQ6IGNsaWVudElkLFxuICAgICAgQ29sbGVjdGlvbklkOiBjb2xsZWN0aW9uSWQsXG4gICAgICBDb2xsZWN0aW9uTmFtZTogY29sbGVjdGlvbk5hbWUsXG4gICAgICBJbmRleElkOiBJbmRleElkLFxuICAgICAgSW5kZXhOYW1lOiBJbmRleE5hbWUsXG4gICAgfTtcblxuICAgIHRoaXMuZGFzaGJvYXJkLmFkZFdpZGdldHMobmV3IFRleHRXaWRnZXQoe1xuICAgICAgbWFya2Rvd246ICcjIE9wZW5TZWFyY2ggVmVjdG9yIERhdGFiYXNlIChpbmRleCBsZXZlbCknLFxuICAgICAgd2lkdGg6IDI0LFxuICAgIH0pKTtcbiAgICB0aGlzLmRhc2hib2FyZC5hZGRXaWRnZXRzKFxuICAgICAgbmV3IEdyYXBoV2lkZ2V0KHtcbiAgICAgICAgdGl0bGU6ICdEZWxldGVkIGRvY3VtZW50cycsXG4gICAgICAgIHZpZXc6IEdyYXBoV2lkZ2V0Vmlldy5USU1FX1NFUklFUyxcbiAgICAgICAgd2lkdGg6IDEyLFxuICAgICAgICBsZWZ0OiBbbmV3IE1ldHJpYyh7XG4gICAgICAgICAgbWV0cmljTmFtZTogJ0RlbGV0ZWREb2N1bWVudHMnLFxuICAgICAgICAgIG5hbWVzcGFjZTogJ0FXUy9BT1NTJyxcbiAgICAgICAgICBzdGF0aXN0aWM6IFN0YXRzLlNVTSxcbiAgICAgICAgICBkaW1lbnNpb25zTWFwOiBkaW1lbnNpb25NYXAsXG4gICAgICAgICAgcGVyaW9kOiBwZXJpb2QsXG4gICAgICAgIH0pXSxcbiAgICAgIH0pLFxuICAgICAgbmV3IEdyYXBoV2lkZ2V0KHtcbiAgICAgICAgdGl0bGU6ICdTZWFyY2hhYmxlIGRvY3VtZW50cycsXG4gICAgICAgIHZpZXc6IEdyYXBoV2lkZ2V0Vmlldy5USU1FX1NFUklFUyxcbiAgICAgICAgd2lkdGg6IDEyLFxuICAgICAgICBsZWZ0OiBbbmV3IE1ldHJpYyh7XG4gICAgICAgICAgbWV0cmljTmFtZTogJ1NlYXJjaGFibGVEb2N1bWVudHMnLFxuICAgICAgICAgIG5hbWVzcGFjZTogJ0FXUy9BT1NTJyxcbiAgICAgICAgICBzdGF0aXN0aWM6IFN0YXRzLlNVTSxcbiAgICAgICAgICBkaW1lbnNpb25zTWFwOiBkaW1lbnNpb25NYXAsXG4gICAgICAgICAgcGVyaW9kOiBwZXJpb2QsXG4gICAgICAgIH0pXSxcbiAgICAgIH0pLFxuICAgICk7XG4gICAgdGhpcy5kYXNoYm9hcmQuYWRkV2lkZ2V0cyhcbiAgICAgIG5ldyBHcmFwaFdpZGdldCh7XG4gICAgICAgIHRpdGxlOiAnUzMgc3RvcmFnZSBjb25zdW1wdGlvbicsXG4gICAgICAgIHZpZXc6IEdyYXBoV2lkZ2V0Vmlldy5USU1FX1NFUklFUyxcbiAgICAgICAgd2lkdGg6IDEyLFxuICAgICAgICBsZWZ0OiBbbmV3IE1ldHJpYyh7XG4gICAgICAgICAgbWV0cmljTmFtZTogJ1N0b3JhZ2VVc2VkSW5TMycsXG4gICAgICAgICAgbmFtZXNwYWNlOiAnQVdTL0FPU1MnLFxuICAgICAgICAgIHN0YXRpc3RpYzogU3RhdHMuU1VNLFxuICAgICAgICAgIGRpbWVuc2lvbnNNYXA6IGRpbWVuc2lvbk1hcCxcbiAgICAgICAgICBwZXJpb2Q6IHBlcmlvZCxcbiAgICAgICAgfSldLFxuICAgICAgfSksXG4gICAgICBuZXcgR3JhcGhXaWRnZXQoe1xuICAgICAgICB0aXRsZTogJ0RvY3VtZW50IGluZ2VzdGlvbiByYXRlJyxcbiAgICAgICAgdmlldzogR3JhcGhXaWRnZXRWaWV3LlRJTUVfU0VSSUVTLFxuICAgICAgICB3aWR0aDogMTIsXG4gICAgICAgIGxlZnQ6IFtuZXcgTWV0cmljKHtcbiAgICAgICAgICBtZXRyaWNOYW1lOiAnSW5nZXN0aW9uRG9jdW1lbnRSYXRlJyxcbiAgICAgICAgICBuYW1lc3BhY2U6ICdBV1MvQU9TUycsXG4gICAgICAgICAgc3RhdGlzdGljOiBTdGF0cy5TVU0sXG4gICAgICAgICAgZGltZW5zaW9uc01hcDogZGltZW5zaW9uTWFwLFxuICAgICAgICAgIHBlcmlvZDogcGVyaW9kLFxuICAgICAgICB9KV0sXG4gICAgICB9KSxcbiAgICApO1xuICAgIHRoaXMuZGFzaGJvYXJkLmFkZFdpZGdldHMoXG4gICAgICBuZXcgR3JhcGhXaWRnZXQoe1xuICAgICAgICB0aXRsZTogJ0luZ2VzdGlvbiBlcnJvcnMnLFxuICAgICAgICB2aWV3OiBHcmFwaFdpZGdldFZpZXcuVElNRV9TRVJJRVMsXG4gICAgICAgIHdpZHRoOiAxMixcbiAgICAgICAgbGVmdDogW25ldyBNZXRyaWMoe1xuICAgICAgICAgIG1ldHJpY05hbWU6ICdJbmdlc3Rpb25Eb2N1bWVudEVycm9ycycsXG4gICAgICAgICAgbmFtZXNwYWNlOiAnQVdTL0FPU1MnLFxuICAgICAgICAgIHN0YXRpc3RpYzogU3RhdHMuU1VNLFxuICAgICAgICAgIGRpbWVuc2lvbnNNYXA6IGRpbWVuc2lvbk1hcCxcbiAgICAgICAgICBwZXJpb2Q6IHBlcmlvZCxcbiAgICAgICAgfSldLFxuICAgICAgfSksXG4gICAgICBuZXcgR3JhcGhXaWRnZXQoe1xuICAgICAgICB0aXRsZTogJ0RvY3VtZW50IGRhdGEgcmF0ZScsXG4gICAgICAgIHZpZXc6IEdyYXBoV2lkZ2V0Vmlldy5USU1FX1NFUklFUyxcbiAgICAgICAgd2lkdGg6IDEyLFxuICAgICAgICBsZWZ0OiBbbmV3IE1ldHJpYyh7XG4gICAgICAgICAgbWV0cmljTmFtZTogJ0luZ2VzdGlvbkRhdGFSYXRlJyxcbiAgICAgICAgICBuYW1lc3BhY2U6ICdBV1MvQU9TUycsXG4gICAgICAgICAgc3RhdGlzdGljOiBTdGF0cy5TVU0sXG4gICAgICAgICAgZGltZW5zaW9uc01hcDogZGltZW5zaW9uTWFwLFxuICAgICAgICAgIHBlcmlvZDogcGVyaW9kLFxuICAgICAgICB9KV0sXG4gICAgICB9KSxcbiAgICApO1xuICB9XG59XG5cbiJdfQ==