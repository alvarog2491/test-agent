"use strict";
var __runInitializers = (this && this.__runInitializers) || function (thisArg, initializers, value) {
    var useValue = arguments.length > 2;
    for (var i = 0; i < initializers.length; i++) {
        value = useValue ? initializers[i].call(thisArg, value) : initializers[i].call(thisArg);
    }
    return useValue ? value : void 0;
};
var __esDecorate = (this && this.__esDecorate) || function (ctor, descriptorIn, decorators, contextIn, initializers, extraInitializers) {
    function accept(f) { if (f !== void 0 && typeof f !== "function") throw new TypeError("Function expected"); return f; }
    var kind = contextIn.kind, key = kind === "getter" ? "get" : kind === "setter" ? "set" : "value";
    var target = !descriptorIn && ctor ? contextIn["static"] ? ctor : ctor.prototype : null;
    var descriptor = descriptorIn || (target ? Object.getOwnPropertyDescriptor(target, contextIn.name) : {});
    var _, done = false;
    for (var i = decorators.length - 1; i >= 0; i--) {
        var context = {};
        for (var p in contextIn) context[p] = p === "access" ? {} : contextIn[p];
        for (var p in contextIn.access) context.access[p] = contextIn.access[p];
        context.addInitializer = function (f) { if (done) throw new TypeError("Cannot add initializers after decoration has completed"); extraInitializers.push(accept(f || null)); };
        var result = (0, decorators[i])(kind === "accessor" ? { get: descriptor.get, set: descriptor.set } : descriptor[key], context);
        if (kind === "accessor") {
            if (result === void 0) continue;
            if (result === null || typeof result !== "object") throw new TypeError("Object expected");
            if (_ = accept(result.get)) descriptor.get = _;
            if (_ = accept(result.set)) descriptor.set = _;
            if (_ = accept(result.init)) initializers.unshift(_);
        }
        else if (_ = accept(result)) {
            if (kind === "field") initializers.unshift(_);
            else descriptor[key] = _;
        }
    }
    if (target) Object.defineProperty(target, contextIn.name, descriptor);
    done = true;
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.Guardrail = exports.GuardrailBase = void 0;
const jsiiDeprecationWarnings = require("../../.warnings.jsii.js");
const JSII_RTTI_SYMBOL_1 = Symbol.for("jsii.rtti");
const fs = require("fs");
const aws_cdk_lib_1 = require("aws-cdk-lib");
const bedrock = require("aws-cdk-lib/aws-bedrock");
const aws_cloudwatch_1 = require("aws-cdk-lib/aws-cloudwatch");
const iam = require("aws-cdk-lib/aws-iam");
const aws_kms_1 = require("aws-cdk-lib/aws-kms");
const helpers_internal_1 = require("aws-cdk-lib/core/lib/helpers-internal");
const metadata_resource_1 = require("aws-cdk-lib/core/lib/metadata-resource");
const prop_injectable_1 = require("aws-cdk-lib/core/lib/prop-injectable");
// Internal Libs
const filters = require("./guardrail-filters");
const guardrail_version_1 = require("./guardrail-version");
/**
 * Abstract base class for a Guardrail.
 * Contains methods and attributes valid for Guardrails either created with CDK or imported.
 */
class GuardrailBase extends aws_cdk_lib_1.Resource {
    static [JSII_RTTI_SYMBOL_1] = { fqn: "@aws-cdk/aws-bedrock-alpha.GuardrailBase", version: "2.235.0-alpha.0" };
    /**
     * Return the given named metric for all guardrails.
     *
     * By default, the metric will be calculated as a sum over a period of 5 minutes.
     * You can customize this by using the `statistic` and `period` properties.
     */
    static metricAll(metricName, props) {
        return new aws_cloudwatch_1.Metric({
            namespace: 'AWS/Bedrock/Guardrails',
            dimensionsMap: { Operation: 'ApplyGuardrail' },
            metricName,
            ...props,
        });
    }
    /**
     * Return the invocations metric for all guardrails.
     */
    static metricAllInvocations(props) {
        return this.metricAll('Invocations', props);
    }
    /**
     * Return the text unit count metric for all guardrails.
     */
    static metricAllTextUnitCount(props) {
        return this.metricAll('TextUnitCount', props);
    }
    /**
     * Return the invocations intervened metric for all guardrails.
     */
    static metricAllInvocationsIntervened(props) {
        return this.metricAll('InvocationsIntervened', props);
    }
    /**
     * Return the invocation latency metric for all guardrails.
     */
    static metricAllInvocationLatency(props) {
        return this.metricAll('InvocationLatency', props);
    }
    _version = 'DRAFT';
    /**
     * The version of the guardrail.
     * @attribute
     */
    get guardrailVersion() {
        return this._version;
    }
    updateVersion(version) {
        this._version = version;
    }
    /**
     * Grant the given principal identity permissions to perform actions on this guardrail.
     * [disable-awslint:no-grants]
     */
    grant(grantee, ...actions) {
        return iam.Grant.addToPrincipal({
            grantee,
            actions,
            resourceArns: [this.guardrailArn],
        });
    }
    /**
     * Grant the given identity permissions to apply the guardrail.
     * [disable-awslint:no-grants]
     */
    grantApply(grantee) {
        const baseGrant = this.grant(grantee, 'bedrock:ApplyGuardrail');
        if (this.kmsKey) {
            // If KMS key exists, create encryption grant and combine with base grant
            const kmsGrant = this.kmsKey.grantEncryptDecrypt(grantee);
            return kmsGrant.combine(baseGrant);
        }
        else {
            // If no KMS key exists, return only the base grant
            return baseGrant;
        }
    }
    /**
     * Return the given named metric for this guardrail.
     *
     * By default, the metric will be calculated as a sum over a period of 5 minutes.
     * You can customize this by using the `statistic` and `period` properties.
     */
    metric(metricName, props) {
        const metricProps = {
            namespace: 'AWS/Bedrock/Guardrails',
            metricName,
            dimensionsMap: { GuardrailArn: this.guardrailArn, GuardrailVersion: this.guardrailVersion },
            ...props,
        };
        return this.configureMetric(metricProps);
    }
    /**
     * Return the invocations metric for this guardrail.
     */
    metricInvocations(props) {
        return this.metric('Invocations', props);
    }
    /**
     * Return the invocation latency metric for this guardrail.
     */
    metricInvocationLatency(props) {
        return this.metric('InvocationLatency', props);
    }
    /**
     * Return the invocation client errors metric for this guardrail.
     */
    metricInvocationClientErrors(props) {
        return this.metric('InvocationClientErrors', props);
    }
    /**
     * Return the invocation server errors metric for this guardrail.
     */
    metricInvocationServerErrors(props) {
        return this.metric('InvocationServerErrors', props);
    }
    /**
     * Return the invocation throttles metric for this guardrail.
     */
    metricInvocationThrottles(props) {
        return this.metric('InvocationThrottles', props);
    }
    /**
     * Return the text unit count metric for this guardrail.
     */
    metricTextUnitCount(props) {
        return this.metric('TextUnitCount', props);
    }
    /**
     * Return the invocations intervened metric for this guardrail.
     */
    metricInvocationsIntervened(props) {
        return this.metric('InvocationsIntervened', props);
    }
    configureMetric(props) {
        return new aws_cloudwatch_1.Metric({
            ...props,
            region: props?.region ?? this.stack.region,
            account: props?.account ?? this.stack.account,
        });
    }
}
exports.GuardrailBase = GuardrailBase;
/******************************************************************************
 *                        NEW CONSTRUCT DEFINITION
 *****************************************************************************/
/**
 * Class to create a Guardrail with CDK.
 * @cloudformationResource AWS::Bedrock::Guardrail
 */
let Guardrail = (() => {
    let _classDecorators = [prop_injectable_1.propertyInjectable];
    let _classDescriptor;
    let _classExtraInitializers = [];
    let _classThis;
    let _classSuper = GuardrailBase;
    let _instanceExtraInitializers = [];
    let _addContentFilter_decorators;
    let _addPIIFilter_decorators;
    let _addRegexFilter_decorators;
    let _addDeniedTopicFilter_decorators;
    let _addContextualGroundingFilter_decorators;
    let _addWordFilter_decorators;
    let _addWordFilterFromFile_decorators;
    let _addManagedWordListFilter_decorators;
    let _createVersion_decorators;
    var Guardrail = class extends _classSuper {
        static { _classThis = this; }
        static {
            const _metadata = typeof Symbol === "function" && Symbol.metadata ? Object.create(_classSuper[Symbol.metadata] ?? null) : void 0;
            _addContentFilter_decorators = [(0, metadata_resource_1.MethodMetadata)()];
            _addPIIFilter_decorators = [(0, metadata_resource_1.MethodMetadata)()];
            _addRegexFilter_decorators = [(0, metadata_resource_1.MethodMetadata)()];
            _addDeniedTopicFilter_decorators = [(0, metadata_resource_1.MethodMetadata)()];
            _addContextualGroundingFilter_decorators = [(0, metadata_resource_1.MethodMetadata)()];
            _addWordFilter_decorators = [(0, metadata_resource_1.MethodMetadata)()];
            _addWordFilterFromFile_decorators = [(0, metadata_resource_1.MethodMetadata)()];
            _addManagedWordListFilter_decorators = [(0, metadata_resource_1.MethodMetadata)()];
            _createVersion_decorators = [(0, metadata_resource_1.MethodMetadata)()];
            __esDecorate(this, null, _addContentFilter_decorators, { kind: "method", name: "addContentFilter", static: false, private: false, access: { has: obj => "addContentFilter" in obj, get: obj => obj.addContentFilter }, metadata: _metadata }, null, _instanceExtraInitializers);
            __esDecorate(this, null, _addPIIFilter_decorators, { kind: "method", name: "addPIIFilter", static: false, private: false, access: { has: obj => "addPIIFilter" in obj, get: obj => obj.addPIIFilter }, metadata: _metadata }, null, _instanceExtraInitializers);
            __esDecorate(this, null, _addRegexFilter_decorators, { kind: "method", name: "addRegexFilter", static: false, private: false, access: { has: obj => "addRegexFilter" in obj, get: obj => obj.addRegexFilter }, metadata: _metadata }, null, _instanceExtraInitializers);
            __esDecorate(this, null, _addDeniedTopicFilter_decorators, { kind: "method", name: "addDeniedTopicFilter", static: false, private: false, access: { has: obj => "addDeniedTopicFilter" in obj, get: obj => obj.addDeniedTopicFilter }, metadata: _metadata }, null, _instanceExtraInitializers);
            __esDecorate(this, null, _addContextualGroundingFilter_decorators, { kind: "method", name: "addContextualGroundingFilter", static: false, private: false, access: { has: obj => "addContextualGroundingFilter" in obj, get: obj => obj.addContextualGroundingFilter }, metadata: _metadata }, null, _instanceExtraInitializers);
            __esDecorate(this, null, _addWordFilter_decorators, { kind: "method", name: "addWordFilter", static: false, private: false, access: { has: obj => "addWordFilter" in obj, get: obj => obj.addWordFilter }, metadata: _metadata }, null, _instanceExtraInitializers);
            __esDecorate(this, null, _addWordFilterFromFile_decorators, { kind: "method", name: "addWordFilterFromFile", static: false, private: false, access: { has: obj => "addWordFilterFromFile" in obj, get: obj => obj.addWordFilterFromFile }, metadata: _metadata }, null, _instanceExtraInitializers);
            __esDecorate(this, null, _addManagedWordListFilter_decorators, { kind: "method", name: "addManagedWordListFilter", static: false, private: false, access: { has: obj => "addManagedWordListFilter" in obj, get: obj => obj.addManagedWordListFilter }, metadata: _metadata }, null, _instanceExtraInitializers);
            __esDecorate(this, null, _createVersion_decorators, { kind: "method", name: "createVersion", static: false, private: false, access: { has: obj => "createVersion" in obj, get: obj => obj.createVersion }, metadata: _metadata }, null, _instanceExtraInitializers);
            __esDecorate(null, _classDescriptor = { value: _classThis }, _classDecorators, { kind: "class", name: _classThis.name, metadata: _metadata }, null, _classExtraInitializers);
            Guardrail = _classThis = _classDescriptor.value;
            if (_metadata) Object.defineProperty(_classThis, Symbol.metadata, { enumerable: true, configurable: true, writable: true, value: _metadata });
        }
        static [JSII_RTTI_SYMBOL_1] = { fqn: "@aws-cdk/aws-bedrock-alpha.Guardrail", version: "2.235.0-alpha.0" };
        /** Uniquely identifies this class. */
        static PROPERTY_INJECTION_ID = '@aws-cdk.aws-bedrock-alpha.Guardrail';
        /**
         * Import a guardrail given its attributes
         */
        static fromGuardrailAttributes(scope, id, attrs) {
            try {
                jsiiDeprecationWarnings._aws_cdk_aws_bedrock_alpha_GuardrailAttributes(attrs);
            }
            catch (error) {
                if (process.env.JSII_DEBUG !== "1" && error.name === "DeprecationError") {
                    Error.captureStackTrace(error, this.fromGuardrailAttributes);
                }
                throw error;
            }
            class Import extends GuardrailBase {
                guardrailArn = attrs.guardrailArn;
                guardrailId = aws_cdk_lib_1.Arn.split(attrs.guardrailArn, aws_cdk_lib_1.ArnFormat.SLASH_RESOURCE_NAME).resourceName;
                kmsKey = attrs.kmsKey;
                lastUpdated = undefined;
                constructor() {
                    super(scope, id);
                    this.updateVersion(attrs.guardrailVersion ?? 'DRAFT');
                }
            }
            return new Import();
        }
        /**
         * Import a low-level L1 Cfn Guardrail
         */
        static fromCfnGuardrail(cfnGuardrail) {
            return new (class extends GuardrailBase {
                guardrailArn = cfnGuardrail.attrGuardrailArn;
                guardrailId = cfnGuardrail.attrGuardrailId;
                kmsKey = cfnGuardrail.kmsKeyArn
                    ? aws_kms_1.Key.fromKeyArn(this, '@FromCfnGuardrailKey', cfnGuardrail.kmsKeyArn)
                    : undefined;
                lastUpdated = cfnGuardrail.attrUpdatedAt;
                constructor() {
                    super(cfnGuardrail, '@FromCfnGuardrail');
                    this.updateVersion(cfnGuardrail.attrVersion);
                }
            })();
        }
        /**
         * The ARN of the guardrail.
         * @attribute
         */
        guardrailArn = __runInitializers(this, _instanceExtraInitializers);
        /**
         * The ID of the guardrail.
         * @attribute
         */
        guardrailId;
        /**
         * The name of the guardrail.
         */
        name;
        /**
         * The KMS key used to encrypt data.
         *
         * @default undefined - "Data is encrypted by default with a key that AWS owns and manages for you"
         */
        kmsKey;
        /**
         * The content filters applied by the guardrail.
         */
        contentFilters;
        /**
         * The PII filters applied by the guardrail.
         */
        piiFilters;
        /**
         * The regex filters applied by the guardrail.
         */
        regexFilters;
        /**
         * The denied topic filters applied by the guardrail.
         */
        deniedTopics;
        /**
         * The contextual grounding filters applied by the guardrail.
         */
        contextualGroundingFilters;
        /**
         * The word filters applied by the guardrail.
         */
        wordFilters;
        /**
         * The managed word list filters applied by the guardrail.
         */
        managedWordListFilters;
        /**
         * When this guardrail was last updated
         */
        lastUpdated;
        /**
         * The computed hash of the guardrail properties.
         */
        hash;
        /**
         * The L1 representation of the guardrail
         */
        __resource;
        /**
         * The tier that your guardrail uses for denied topic filters.
         * @default filters.TierConfig.CLASSIC
         */
        topicsTierConfig;
        /**
         * The tier that your guardrail uses for content filters.
         * Consider using a tier that balances performance, accuracy, and compatibility with your existing generative AI workflows.
         * @default filters.TierConfig.CLASSIC
         */
        contentFiltersTierConfig;
        /**
         * The cross-region configuration for the guardrail.
         */
        crossRegionConfig;
        /**
         * The message to return when the guardrail blocks a prompt.
         * @default "Sorry, your query violates our usage policy."
         */
        blockedInputMessaging;
        /**
         * The message to return when the guardrail blocks a model response.
         * @default "Sorry, I am unable to answer your question because of our usage policy."
         */
        blockedOutputsMessaging;
        constructor(scope, id, props) {
            super(scope, id, {
                physicalName: props.guardrailName,
            });
            try {
                jsiiDeprecationWarnings._aws_cdk_aws_bedrock_alpha_GuardrailProps(props);
            }
            catch (error) {
                if (process.env.JSII_DEBUG !== "1" && error.name === "DeprecationError") {
                    Error.captureStackTrace(error, Guardrail);
                }
                throw error;
            }
            // Enhanced CDK Analytics Telemetry
            (0, metadata_resource_1.addConstructMetadata)(this, props);
            // ------------------------------------------------------
            // Set properties or defaults
            // ------------------------------------------------------
            this.name = this.physicalName;
            this.contentFilters = props.contentFilters ?? [];
            this.piiFilters = props.piiFilters ?? [];
            this.regexFilters = props.regexFilters ?? [];
            this.deniedTopics = props.deniedTopics ?? [];
            this.contextualGroundingFilters = props.contextualGroundingFilters ?? [];
            this.wordFilters = props.wordFilters ?? [];
            this.managedWordListFilters = props.managedWordListFilters ?? [];
            this.topicsTierConfig = props.topicsTierConfig ?? filters.TierConfig.CLASSIC;
            this.contentFiltersTierConfig = props.contentFiltersTierConfig ?? filters.TierConfig.CLASSIC;
            this.crossRegionConfig = props.crossRegionConfig;
            this.blockedInputMessaging = props.blockedInputMessaging ?? 'Sorry, your query violates our usage policy.';
            this.blockedOutputsMessaging = props.blockedOutputsMessaging ?? 'Sorry, I am unable to answer your question because of our usage policy.';
            // ------------------------------------------------------
            // Validate all filter arrays
            // ------------------------------------------------------
            this.validateContentFilters(this.contentFilters);
            this.validatePiiFilters(this.piiFilters);
            this.validateRegexFilters(this.regexFilters);
            this.validateDeniedTopics(this.deniedTopics);
            this.validateContextualGroundingFilters(this.contextualGroundingFilters);
            this.validateWordFilters(this.wordFilters);
            this.validateManagedWordListFilters(this.managedWordListFilters);
            // ------------------------------------------------------
            // Validate messaging properties
            // ------------------------------------------------------
            this.validateMessagingProperty(this.blockedInputMessaging, 'blockedInputMessaging');
            this.validateMessagingProperty(this.blockedOutputsMessaging, 'blockedOutputsMessaging');
            // ------------------------------------------------------
            // Validate tier configuration requirements
            // ------------------------------------------------------
            this.validateTierConfiguration(props);
            // ------------------------------------------------------
            // CFN Props - With Lazy support
            // ------------------------------------------------------
            let cfnProps = {
                name: props.guardrailName,
                description: props.description,
                kmsKeyArn: props.kmsKey?.keyArn,
                blockedInputMessaging: this.blockedInputMessaging,
                blockedOutputsMessaging: this.blockedOutputsMessaging,
                // Lazy props
                crossRegionConfig: this.generateCfnCrossRegionConfig(),
                contentPolicyConfig: this.generateCfnContentPolicyConfig(),
                contextualGroundingPolicyConfig: this.generateCfnContextualPolicyConfig(),
                topicPolicyConfig: this.generateCfnTopicPolicy(),
                wordPolicyConfig: this.generateCfnWordPolicyConfig(),
                sensitiveInformationPolicyConfig: this.generateCfnSensitiveInformationPolicyConfig(),
            };
            // Hash calculation useful for versioning of the guardrail
            this.hash = (0, helpers_internal_1.md5hash)(JSON.stringify(cfnProps));
            // ------------------------------------------------------
            // L1 Instantiation
            // ------------------------------------------------------
            this.__resource = new bedrock.CfnGuardrail(this, 'MyGuardrail', cfnProps);
            this.guardrailId = this.__resource.attrGuardrailId;
            this.guardrailArn = this.__resource.attrGuardrailArn;
            this.updateVersion(this.__resource.attrVersion);
            this.lastUpdated = this.__resource.attrUpdatedAt;
        }
        // ------------------------------------------------------
        // METHODS
        // ------------------------------------------------------
        /**
         * Adds a content filter to the guardrail.
         * @param filter The content filter to add.
         */
        addContentFilter(filter) {
            try {
                jsiiDeprecationWarnings._aws_cdk_aws_bedrock_alpha_ContentFilter(filter);
            }
            catch (error) {
                if (process.env.JSII_DEBUG !== "1" && error.name === "DeprecationError") {
                    Error.captureStackTrace(error, this.addContentFilter);
                }
                throw error;
            }
            this.validateSingleContentFilter(filter);
            this.contentFilters.push(filter);
        }
        /**
         * Adds a PII filter to the guardrail.
         * @param filter The PII filter to add.
         */
        addPIIFilter(filter) {
            try {
                jsiiDeprecationWarnings._aws_cdk_aws_bedrock_alpha_PIIFilter(filter);
            }
            catch (error) {
                if (process.env.JSII_DEBUG !== "1" && error.name === "DeprecationError") {
                    Error.captureStackTrace(error, this.addPIIFilter);
                }
                throw error;
            }
            this.validateSinglePiiFilter(filter);
            this.piiFilters.push(filter);
        }
        /**
         * Adds a regex filter to the guardrail.
         * @param filter The regex filter to add.
         */
        addRegexFilter(filter) {
            try {
                jsiiDeprecationWarnings._aws_cdk_aws_bedrock_alpha_RegexFilter(filter);
            }
            catch (error) {
                if (process.env.JSII_DEBUG !== "1" && error.name === "DeprecationError") {
                    Error.captureStackTrace(error, this.addRegexFilter);
                }
                throw error;
            }
            this.validateSingleRegexFilter(filter);
            this.regexFilters.push(filter);
        }
        /**
         * Adds a denied topic filter to the guardrail.
         * @param filter The denied topic filter to add.
         */
        addDeniedTopicFilter(filter) {
            try {
                jsiiDeprecationWarnings._aws_cdk_aws_bedrock_alpha_Topic(filter);
            }
            catch (error) {
                if (process.env.JSII_DEBUG !== "1" && error.name === "DeprecationError") {
                    Error.captureStackTrace(error, this.addDeniedTopicFilter);
                }
                throw error;
            }
            this.validateSingleDeniedTopic(filter);
            this.deniedTopics.push(filter);
        }
        /**
         * Adds a contextual grounding filter to the guardrail.
         * @param filter The contextual grounding filter to add.
         */
        addContextualGroundingFilter(filter) {
            try {
                jsiiDeprecationWarnings._aws_cdk_aws_bedrock_alpha_ContextualGroundingFilter(filter);
            }
            catch (error) {
                if (process.env.JSII_DEBUG !== "1" && error.name === "DeprecationError") {
                    Error.captureStackTrace(error, this.addContextualGroundingFilter);
                }
                throw error;
            }
            this.validateSingleContextualGroundingFilter(filter);
            this.contextualGroundingFilters.push(filter);
        }
        /**
         * Adds a word filter to the guardrail.
         * @param filter The word filter to add.
         */
        addWordFilter(filter) {
            try {
                jsiiDeprecationWarnings._aws_cdk_aws_bedrock_alpha_WordFilter(filter);
            }
            catch (error) {
                if (process.env.JSII_DEBUG !== "1" && error.name === "DeprecationError") {
                    Error.captureStackTrace(error, this.addWordFilter);
                }
                throw error;
            }
            this.validateSingleWordFilter(filter);
            this.wordFilters.push(filter);
        }
        /**
         * Adds a word filter to the guardrail.
         * @param filePath The location of the word filter file.
         */
        addWordFilterFromFile(filePath, inputAction, outputAction, inputEnabled, outputEnabled) {
            try {
                jsiiDeprecationWarnings._aws_cdk_aws_bedrock_alpha_GuardrailAction(inputAction);
                jsiiDeprecationWarnings._aws_cdk_aws_bedrock_alpha_GuardrailAction(outputAction);
            }
            catch (error) {
                if (process.env.JSII_DEBUG !== "1" && error.name === "DeprecationError") {
                    Error.captureStackTrace(error, this.addWordFilterFromFile);
                }
                throw error;
            }
            const fileContents = fs.readFileSync(filePath, 'utf8');
            const words = fileContents.trim().split(',');
            for (const word of words)
                this.addWordFilter({ text: word, inputAction, outputAction, inputEnabled, outputEnabled });
        }
        /**
         * Adds a managed word list filter to the guardrail.
         * @param filter The managed word list filter to add.
         */
        addManagedWordListFilter(filter) {
            try {
                jsiiDeprecationWarnings._aws_cdk_aws_bedrock_alpha_ManagedWordFilter(filter);
            }
            catch (error) {
                if (process.env.JSII_DEBUG !== "1" && error.name === "DeprecationError") {
                    Error.captureStackTrace(error, this.addManagedWordListFilter);
                }
                throw error;
            }
            this.validateSingleManagedWordListFilter(filter);
            this.managedWordListFilters.push(filter);
        }
        /**
         * Create a version for the guardrail.
         * @param description The description of the version.
         * @returns The guardrail version.
         */
        createVersion(description) {
            const cfnVersion = new guardrail_version_1.GuardrailVersion(this, `GuardrailVersion-${this.hash.slice(0, 16)}`, {
                description: description,
                guardrail: this,
            });
            this.updateVersion(cfnVersion.guardrailVersion);
            return this.guardrailVersion;
        }
        // ------------------------------------------------------
        // CFN Generators
        // ------------------------------------------------------
        /**
         * Returns the content filters applied to the guardrail. This method defers the computation
         * to synth time.
         */
        generateCfnContentPolicyConfig() {
            return aws_cdk_lib_1.Lazy.any({
                produce: () => {
                    if (this.contentFilters.length > 0) {
                        const contentPolicyConfig = {
                            filtersConfig: this.contentFilters,
                            ...(this.contentFiltersTierConfig && {
                                contentFiltersTierConfig: {
                                    tierName: this.contentFiltersTierConfig,
                                },
                            }),
                        };
                        return contentPolicyConfig;
                    }
                    else {
                        return undefined;
                    }
                },
            });
        }
        /**
         * Returns the topic filters applied to the guardrail. This method defers the computation
         * to synth time.
         */
        generateCfnTopicPolicy() {
            return aws_cdk_lib_1.Lazy.any({
                produce: () => {
                    if (this.deniedTopics.length > 0) {
                        const topicPolicyConfig = {
                            topicsConfig: this.deniedTopics.flatMap((topic) => {
                                return {
                                    definition: topic.definition,
                                    name: topic.name,
                                    examples: topic.examples,
                                    type: 'DENY',
                                    inputAction: topic.inputAction,
                                    inputEnabled: topic.inputEnabled,
                                    outputAction: topic.outputAction,
                                    outputEnabled: topic.outputEnabled,
                                };
                            }),
                            ...(this.topicsTierConfig && {
                                topicsTierConfig: {
                                    tierName: this.topicsTierConfig,
                                },
                            }),
                        };
                        return topicPolicyConfig;
                    }
                    else {
                        return undefined;
                    }
                },
            });
        }
        /**
         * Returns the contectual filters applied to the guardrail. This method defers the computation
         * to synth time.
         */
        generateCfnContextualPolicyConfig() {
            return aws_cdk_lib_1.Lazy.any({
                produce: () => {
                    if (this.contextualGroundingFilters.length > 0) {
                        return {
                            filtersConfig: this.contextualGroundingFilters.flatMap((filter) => {
                                return {
                                    type: filter.type,
                                    threshold: filter.threshold,
                                    action: filter.action,
                                    enabled: filter.enabled,
                                };
                            }),
                        };
                    }
                    else {
                        return undefined;
                    }
                },
            });
        }
        /**
         * Returns the word config applied to the guardrail. This method defers the computation
         * to synth time.
         */
        generateCfnWordPolicyConfig() {
            return aws_cdk_lib_1.Lazy.any({
                produce: () => {
                    if (this.wordFilters.length > 0 || this.managedWordListFilters.length > 0) {
                        return {
                            wordsConfig: this.generateCfnWordConfig(),
                            managedWordListsConfig: this.generateCfnManagedWordListsConfig(),
                        };
                    }
                    else {
                        return undefined;
                    }
                },
            });
        }
        /**
         * Returns the word filters applied to the guardrail. This method defers the computation
         * to synth time.
         */
        generateCfnWordConfig() {
            return aws_cdk_lib_1.Lazy.any({
                produce: () => {
                    return this.wordFilters.flatMap((word) => {
                        return {
                            text: word.text,
                            inputAction: word.inputAction,
                            inputEnabled: word.inputEnabled,
                            outputAction: word.outputAction,
                            outputEnabled: word.outputEnabled,
                        };
                    });
                },
            }, { omitEmptyArray: true });
        }
        /**
         * Returns the word filters applied to the guardrail. This method defers the computation
         * to synth time.
         */
        generateCfnManagedWordListsConfig() {
            return aws_cdk_lib_1.Lazy.any({
                produce: () => {
                    return this.managedWordListFilters.flatMap((filter) => {
                        return {
                            type: filter.type,
                            inputAction: filter.inputAction,
                            inputEnabled: filter.inputEnabled,
                            outputAction: filter.outputAction,
                            outputEnabled: filter.outputEnabled,
                        };
                    });
                },
            }, { omitEmptyArray: true });
        }
        /**
         * Returns the sensitive information config applied to the guardrail. This method defers the computation
         * to synth time.
         */
        generateCfnSensitiveInformationPolicyConfig() {
            return aws_cdk_lib_1.Lazy.any({
                produce: () => {
                    if (this.regexFilters.length > 0 || this.piiFilters.length > 0) {
                        return {
                            regexesConfig: this.generateCfnRegexesConfig(),
                            piiEntitiesConfig: this.generateCfnPiiEntitiesConfig(),
                        };
                    }
                    else {
                        return undefined;
                    }
                },
            }, { omitEmptyArray: true });
        }
        /**
         * Returns the regex filters applied to the guardrail. This method defers the computation
         * to synth time.
         */
        generateCfnRegexesConfig() {
            return aws_cdk_lib_1.Lazy.any({
                produce: () => {
                    return this.regexFilters.flatMap((regex) => {
                        return {
                            name: regex.name,
                            description: regex.description,
                            pattern: regex.pattern,
                            action: regex.action,
                            inputAction: regex.inputAction,
                            inputEnabled: regex.inputEnabled,
                            outputAction: regex.outputAction,
                            outputEnabled: regex.outputEnabled,
                        };
                    });
                },
            }, { omitEmptyArray: true });
        }
        /**
         * Returns the Pii filters applied to the guardrail. This method defers the computation
         * to synth time.
         */
        generateCfnPiiEntitiesConfig() {
            return aws_cdk_lib_1.Lazy.any({
                produce: () => {
                    return this.piiFilters.flatMap((filter) => {
                        return {
                            type: filter.type.value,
                            action: filter.action,
                            inputAction: filter.inputAction,
                            inputEnabled: filter.inputEnabled,
                            outputAction: filter.outputAction,
                            outputEnabled: filter.outputEnabled,
                        };
                    });
                },
            }, { omitEmptyArray: true });
        }
        /**
         * Returns the cross-region configuration for the guardrail. This method defers the computation
         * to synth time.
         */
        generateCfnCrossRegionConfig() {
            return aws_cdk_lib_1.Lazy.any({
                produce: () => {
                    if (this.crossRegionConfig) {
                        return {
                            guardrailProfileArn: this.crossRegionConfig.guardrailProfileArn,
                        };
                    }
                    else {
                        return undefined;
                    }
                },
            });
        }
        /**
         * Validates a RegexFilter object and applies default values for optional properties.
         * @param filter The regex filter to validate.
         * @param index Optional index for error messages when validating arrays.
         */
        validateRegexFilter(filter, index) {
            const prefix = index !== undefined ? `Invalid RegexFilter at index ${index}` : 'Invalid RegexFilter';
            // Validate name: between 1 and 100 characters
            if (filter.name !== undefined && !aws_cdk_lib_1.Token.isUnresolved(filter.name)) {
                if (filter.name.length < 1) {
                    throw new aws_cdk_lib_1.ValidationError(`${prefix}: The field name is ${filter.name.length} characters long but must be at least 1 characters`, this);
                }
                if (filter.name.length > 100) {
                    throw new aws_cdk_lib_1.ValidationError(`${prefix}: The field name is ${filter.name.length} characters long but must be less than or equal to 100 characters`, this);
                }
            }
            // Validate description: between 1 and 1000 characters (if provided)
            if (filter.description !== undefined && !aws_cdk_lib_1.Token.isUnresolved(filter.description)) {
                if (filter.description.length < 1) {
                    throw new aws_cdk_lib_1.ValidationError(`${prefix}: The field description is ${filter.description.length} characters long but must be at least 1 characters`, this);
                }
                if (filter.description.length > 1000) {
                    throw new aws_cdk_lib_1.ValidationError(`${prefix}: The field description is ${filter.description.length} characters long but must be less than or equal to 1000 characters`, this);
                }
            }
            // Validate pattern: at least one character
            if (filter.pattern !== undefined && !aws_cdk_lib_1.Token.isUnresolved(filter.pattern)) {
                if (filter.pattern.length < 1) {
                    throw new aws_cdk_lib_1.ValidationError(`${prefix}: The field pattern is ${filter.pattern.length} characters long but must be at least 1 characters`, this);
                }
            }
            // Validate action: must be a valid GuardrailAction value
            if (filter.action !== undefined && !aws_cdk_lib_1.Token.isUnresolved(filter.action) && !Object.values(filters.GuardrailAction).includes(filter.action)) {
                throw new aws_cdk_lib_1.ValidationError(`${prefix}: action must be a valid GuardrailAction value`, this);
            }
            // Validate inputAction: must be a valid GuardrailAction value (if provided)
            if (filter.inputAction !== undefined &&
                !aws_cdk_lib_1.Token.isUnresolved(filter.inputAction) &&
                !Object.values(filters.GuardrailAction).includes(filter.inputAction)) {
                throw new aws_cdk_lib_1.ValidationError(`${prefix}: inputAction must be a valid GuardrailAction value`, this);
            }
            // Validate outputAction: must be a valid GuardrailAction value (if provided)
            if (filter.outputAction !== undefined &&
                !aws_cdk_lib_1.Token.isUnresolved(filter.outputAction) &&
                !Object.values(filters.GuardrailAction).includes(filter.outputAction)) {
                throw new aws_cdk_lib_1.ValidationError(`${prefix}: outputAction must be a valid GuardrailAction value`, this);
            }
            // Validate inputEnabled: must be a boolean (if provided)
            if (filter.inputEnabled !== undefined &&
                !aws_cdk_lib_1.Token.isUnresolved(filter.inputEnabled) &&
                typeof filter.inputEnabled !== 'boolean') {
                throw new aws_cdk_lib_1.ValidationError(`${prefix}: inputEnabled must be a boolean value`, this);
            }
            // Validate outputEnabled: must be a boolean (if provided)
            if (filter.outputEnabled !== undefined &&
                !aws_cdk_lib_1.Token.isUnresolved(filter.outputEnabled) &&
                typeof filter.outputEnabled !== 'boolean') {
                throw new aws_cdk_lib_1.ValidationError(`${prefix}: outputEnabled must be a boolean value`, this);
            }
            // Apply default values for optional properties if not provided
            if (filter.inputAction === undefined) {
                filter.inputAction = filters.GuardrailAction.BLOCK;
            }
            if (filter.inputEnabled === undefined) {
                filter.inputEnabled = true;
            }
            if (filter.outputAction === undefined) {
                filter.outputAction = filters.GuardrailAction.BLOCK;
            }
            if (filter.outputEnabled === undefined) {
                filter.outputEnabled = true;
            }
        }
        /**
         * Validates a messaging property (blockedInputMessaging or blockedOutputsMessaging).
         * @param value The messaging value to validate.
         * @param propertyName The name of the property being validated.
         */
        validateMessagingProperty(value, propertyName) {
            if (value !== undefined && !aws_cdk_lib_1.Token.isUnresolved(value)) {
                if (value.length < 1) {
                    throw new aws_cdk_lib_1.ValidationError(`Invalid ${propertyName}: The field ${propertyName} is ${value.length} characters long but must be at least 1 characters`, this);
                }
                if (value.length > 500) {
                    throw new aws_cdk_lib_1.ValidationError(`Invalid ${propertyName}: The field ${propertyName} is ${value.length} characters long but must be less than or equal to 500 characters`, this);
                }
            }
        }
        /**
         * Validates that cross-region configuration is provided when STANDARD tier is used.
         * @param props The guardrail properties to validate.
         */
        validateTierConfiguration(props) {
            const contentTierConfig = props.contentFiltersTierConfig ?? filters.TierConfig.CLASSIC;
            const topicsTierConfig = props.topicsTierConfig ?? filters.TierConfig.CLASSIC;
            const hasCrossRegionConfig = props.crossRegionConfig !== undefined;
            // Check if STANDARD tier is used for content filters
            if (contentTierConfig === filters.TierConfig.STANDARD && !hasCrossRegionConfig) {
                throw new aws_cdk_lib_1.ValidationError('Cross-region configuration is required when using STANDARD tier for content filters. ' +
                    'Please provide a crossRegionConfig property with a valid guardrailProfileArn.', this);
            }
            // Check if STANDARD tier is used for topic filters
            if (topicsTierConfig === filters.TierConfig.STANDARD && !hasCrossRegionConfig) {
                throw new aws_cdk_lib_1.ValidationError('Cross-region configuration is required when using STANDARD tier for topic filters. ' +
                    'Please provide a crossRegionConfig property with a valid guardrailProfileArn.', this);
            }
        }
        /**
         * Validates content filters array and applies default values for optional properties.
         * @param contentFilters The content filters to validate.
         */
        validateContentFilters(contentFilters) {
            if (!contentFilters)
                return;
            contentFilters.forEach((filter, index) => {
                const prefix = `Invalid ContentFilter at index ${index}`;
                // Validate that the filter has required properties
                if (!filter.type) {
                    throw new aws_cdk_lib_1.ValidationError(`${prefix}: type is required`, this);
                }
                // Validate input strength
                if (filter.inputStrength !== undefined && !aws_cdk_lib_1.Token.isUnresolved(filter.inputStrength)) {
                    if (!Object.values(filters.ContentFilterStrength).includes(filter.inputStrength)) {
                        throw new aws_cdk_lib_1.ValidationError(`${prefix}: inputStrength must be a valid ContentFilterStrength value`, this);
                    }
                }
                // Validate output strength
                if (filter.outputStrength !== undefined && !aws_cdk_lib_1.Token.isUnresolved(filter.outputStrength)) {
                    if (!Object.values(filters.ContentFilterStrength).includes(filter.outputStrength)) {
                        throw new aws_cdk_lib_1.ValidationError(`${prefix}: outputStrength must be a valid ContentFilterStrength value`, this);
                    }
                }
                // Validate input modalities
                if (filter.inputModalities) {
                    filter.inputModalities.forEach((modality, modalityIndex) => {
                        if (!Object.values(filters.ModalityType).includes(modality)) {
                            throw new aws_cdk_lib_1.ValidationError(`${prefix}: inputModalities[${modalityIndex}] must be a valid ModalityType value`, this);
                        }
                    });
                }
                // Validate output modalities
                if (filter.outputModalities) {
                    filter.outputModalities.forEach((modality, modalityIndex) => {
                        if (!Object.values(filters.ModalityType).includes(modality)) {
                            throw new aws_cdk_lib_1.ValidationError(`${prefix}: outputModalities[${modalityIndex}] must be a valid ModalityType value`, this);
                        }
                    });
                }
                // Validate inputAction: must be a valid GuardrailAction value (if provided)
                if (filter.inputAction !== undefined &&
                    !aws_cdk_lib_1.Token.isUnresolved(filter.inputAction) &&
                    !Object.values(filters.GuardrailAction).includes(filter.inputAction)) {
                    throw new aws_cdk_lib_1.ValidationError(`${prefix}: inputAction must be a valid GuardrailAction value`, this);
                }
                // Validate outputAction: must be a valid GuardrailAction value (if provided)
                if (filter.outputAction !== undefined &&
                    !aws_cdk_lib_1.Token.isUnresolved(filter.outputAction) &&
                    !Object.values(filters.GuardrailAction).includes(filter.outputAction)) {
                    throw new aws_cdk_lib_1.ValidationError(`${prefix}: outputAction must be a valid GuardrailAction value`, this);
                }
                // Validate inputEnabled: must be a boolean (if provided)
                if (filter.inputEnabled !== undefined &&
                    !aws_cdk_lib_1.Token.isUnresolved(filter.inputEnabled) &&
                    typeof filter.inputEnabled !== 'boolean') {
                    throw new aws_cdk_lib_1.ValidationError(`${prefix}: inputEnabled must be a boolean value`, this);
                }
                // Validate outputEnabled: must be a boolean (if provided)
                if (filter.outputEnabled !== undefined &&
                    !aws_cdk_lib_1.Token.isUnresolved(filter.outputEnabled) &&
                    typeof filter.outputEnabled !== 'boolean') {
                    throw new aws_cdk_lib_1.ValidationError(`${prefix}: outputEnabled must be a boolean value`, this);
                }
                // Apply default values for optional properties if not provided
                if (filter.inputAction === undefined) {
                    filter.inputAction = filters.GuardrailAction.BLOCK;
                }
                if (filter.inputEnabled === undefined) {
                    filter.inputEnabled = true;
                }
                if (filter.outputAction === undefined) {
                    filter.outputAction = filters.GuardrailAction.BLOCK;
                }
                if (filter.outputEnabled === undefined) {
                    filter.outputEnabled = true;
                }
            });
        }
        /**
         * Validates PII filters array and applies default values for optional properties.
         * @param piiFilters The PII filters to validate.
         */
        validatePiiFilters(piiFilters) {
            if (!piiFilters)
                return;
            piiFilters.forEach((filter, index) => {
                const prefix = `Invalid PIIFilter at index ${index}`;
                // Validate that the filter has required properties
                if (!filter.type) {
                    throw new aws_cdk_lib_1.ValidationError(`${prefix}: type is required`, this);
                }
                if (!filter.action) {
                    throw new aws_cdk_lib_1.ValidationError(`${prefix}: action is required`, this);
                }
                // Validate action values
                if (!aws_cdk_lib_1.Token.isUnresolved(filter.action) && !Object.values(filters.GuardrailAction).includes(filter.action)) {
                    throw new aws_cdk_lib_1.ValidationError(`${prefix}: action must be a valid GuardrailAction value`, this);
                }
                if (filter.inputAction &&
                    !aws_cdk_lib_1.Token.isUnresolved(filter.inputAction) &&
                    !Object.values(filters.GuardrailAction).includes(filter.inputAction)) {
                    throw new aws_cdk_lib_1.ValidationError(`${prefix}: inputAction must be a valid GuardrailAction value`, this);
                }
                if (filter.outputAction &&
                    !aws_cdk_lib_1.Token.isUnresolved(filter.outputAction) &&
                    !Object.values(filters.GuardrailAction).includes(filter.outputAction)) {
                    throw new aws_cdk_lib_1.ValidationError(`${prefix}: outputAction must be a valid GuardrailAction value`, this);
                }
                // Validate inputEnabled: must be a boolean (if provided)
                if (filter.inputEnabled !== undefined &&
                    !aws_cdk_lib_1.Token.isUnresolved(filter.inputEnabled) &&
                    typeof filter.inputEnabled !== 'boolean') {
                    throw new aws_cdk_lib_1.ValidationError(`${prefix}: inputEnabled must be a boolean value`, this);
                }
                // Validate outputEnabled: must be a boolean (if provided)
                if (filter.outputEnabled !== undefined &&
                    !aws_cdk_lib_1.Token.isUnresolved(filter.outputEnabled) &&
                    typeof filter.outputEnabled !== 'boolean') {
                    throw new aws_cdk_lib_1.ValidationError(`${prefix}: outputEnabled must be a boolean value`, this);
                }
                // Apply default values for optional properties if not provided
                if (filter.inputAction === undefined) {
                    filter.inputAction = filters.GuardrailAction.BLOCK;
                }
                if (filter.inputEnabled === undefined) {
                    filter.inputEnabled = true;
                }
                if (filter.outputAction === undefined) {
                    filter.outputAction = filters.GuardrailAction.BLOCK;
                }
                if (filter.outputEnabled === undefined) {
                    filter.outputEnabled = true;
                }
            });
        }
        /**
         * Validates regex filters array.
         * @param regexFilters The regex filters to validate.
         */
        validateRegexFilters(regexFilters) {
            if (!regexFilters)
                return;
            regexFilters.forEach((filter, index) => {
                this.validateRegexFilter(filter, index);
            });
        }
        /**
         * Validates denied topics array and applies default values for optional properties.
         * @param deniedTopics The denied topics to validate.
         */
        validateDeniedTopics(deniedTopics) {
            if (!deniedTopics)
                return;
            deniedTopics.forEach((topic, index) => {
                const prefix = `Invalid Topic at index ${index}`;
                // Validate that the topic has required properties
                if (!topic.name) {
                    throw new aws_cdk_lib_1.ValidationError(`${prefix}: name is required`, this);
                }
                if (!topic.definition) {
                    throw new aws_cdk_lib_1.ValidationError(`${prefix}: definition is required`, this);
                }
                // Validate name length
                if (!aws_cdk_lib_1.Token.isUnresolved(topic.name) && topic.name.length > 100) {
                    throw new aws_cdk_lib_1.ValidationError(`${prefix}: name must be 100 characters or less`, this);
                }
                // Validate definition length
                if (!aws_cdk_lib_1.Token.isUnresolved(topic.definition) && topic.definition.length > 1000) {
                    throw new aws_cdk_lib_1.ValidationError(`${prefix}: definition must be 1000 characters or less`, this);
                }
                // Validate examples if provided
                if (topic.examples) {
                    if (topic.examples.length > 100) {
                        throw new aws_cdk_lib_1.ValidationError(`${prefix}: examples array cannot contain more than 100 examples`, this);
                    }
                    topic.examples.forEach((example, exampleIndex) => {
                        if (!aws_cdk_lib_1.Token.isUnresolved(example) && example.length > 100) {
                            throw new aws_cdk_lib_1.ValidationError(`${prefix}: examples[${exampleIndex}] must be 100 characters or less`, this);
                        }
                    });
                }
                // Validate inputAction: must be a valid GuardrailAction value (if provided)
                if (topic.inputAction !== undefined &&
                    !aws_cdk_lib_1.Token.isUnresolved(topic.inputAction) &&
                    !Object.values(filters.GuardrailAction).includes(topic.inputAction)) {
                    throw new aws_cdk_lib_1.ValidationError(`${prefix}: inputAction must be a valid GuardrailAction value`, this);
                }
                // Validate outputAction: must be a valid GuardrailAction value (if provided)
                if (topic.outputAction !== undefined &&
                    !aws_cdk_lib_1.Token.isUnresolved(topic.outputAction) &&
                    !Object.values(filters.GuardrailAction).includes(topic.outputAction)) {
                    throw new aws_cdk_lib_1.ValidationError(`${prefix}: outputAction must be a valid GuardrailAction value`, this);
                }
                // Validate inputEnabled: must be a boolean (if provided)
                if (topic.inputEnabled !== undefined &&
                    !aws_cdk_lib_1.Token.isUnresolved(topic.inputEnabled) &&
                    typeof topic.inputEnabled !== 'boolean') {
                    throw new aws_cdk_lib_1.ValidationError(`${prefix}: inputEnabled must be a boolean value`, this);
                }
                // Validate outputEnabled: must be a boolean (if provided)
                if (topic.outputEnabled !== undefined &&
                    !aws_cdk_lib_1.Token.isUnresolved(topic.outputEnabled) &&
                    typeof topic.outputEnabled !== 'boolean') {
                    throw new aws_cdk_lib_1.ValidationError(`${prefix}: outputEnabled must be a boolean value`, this);
                }
                // Apply default values for optional properties if not provided
                if (topic.inputAction === undefined) {
                    topic.inputAction = filters.GuardrailAction.BLOCK;
                }
                if (topic.inputEnabled === undefined) {
                    topic.inputEnabled = true;
                }
                if (topic.outputAction === undefined) {
                    topic.outputAction = filters.GuardrailAction.BLOCK;
                }
                if (topic.outputEnabled === undefined) {
                    topic.outputEnabled = true;
                }
            });
        }
        /**
         * Validates contextual grounding filters array and applies default values for optional properties.
         * @param contextualGroundingFilters The contextual grounding filters to validate.
         */
        validateContextualGroundingFilters(contextualGroundingFilters) {
            if (!contextualGroundingFilters)
                return;
            contextualGroundingFilters.forEach((filter, index) => {
                const prefix = `Invalid ContextualGroundingFilter at index ${index}`;
                // Validate that the filter has required properties
                if (!filter.type) {
                    throw new aws_cdk_lib_1.ValidationError(`${prefix}: type is required`, this);
                }
                if (filter.threshold === undefined) {
                    throw new aws_cdk_lib_1.ValidationError(`${prefix}: threshold is required`, this);
                }
                // Validate type
                if (!Object.values(filters.ContextualGroundingFilterType).includes(filter.type)) {
                    throw new aws_cdk_lib_1.ValidationError(`${prefix}: type must be a valid ContextualGroundingFilterType value`, this);
                }
                // Validate threshold range
                if (!aws_cdk_lib_1.Token.isUnresolved(filter.threshold)) {
                    if (filter.threshold < 0 || filter.threshold > 0.99) {
                        throw new aws_cdk_lib_1.ValidationError(`${prefix}: threshold must be between 0 and 0.99`, this);
                    }
                }
                // Validate action: must be a valid GuardrailAction value (if provided)
                if (filter.action !== undefined &&
                    !aws_cdk_lib_1.Token.isUnresolved(filter.action) &&
                    !Object.values(filters.GuardrailAction).includes(filter.action)) {
                    throw new aws_cdk_lib_1.ValidationError(`${prefix}: action must be a valid GuardrailAction value`, this);
                }
                // Validate enabled: must be a boolean (if provided)
                if (filter.enabled !== undefined &&
                    !aws_cdk_lib_1.Token.isUnresolved(filter.enabled) &&
                    typeof filter.enabled !== 'boolean') {
                    throw new aws_cdk_lib_1.ValidationError(`${prefix}: enabled must be a boolean value`, this);
                }
                // Apply default values for optional properties if not provided
                if (filter.action === undefined) {
                    filter.action = filters.GuardrailAction.BLOCK;
                }
                if (filter.enabled === undefined) {
                    filter.enabled = true;
                }
            });
        }
        /**
         * Validates word filters array and applies default values for optional properties.
         * @param wordFilters The word filters to validate.
         */
        validateWordFilters(wordFilters) {
            if (!wordFilters)
                return;
            wordFilters.forEach((filter, index) => {
                const prefix = `Invalid WordFilter at index ${index}`;
                // Validate that the filter has required properties
                if (!filter.text) {
                    throw new aws_cdk_lib_1.ValidationError(`${prefix}: text is required`, this);
                }
                // Validate text length
                if (!aws_cdk_lib_1.Token.isUnresolved(filter.text) && filter.text.length > 100) {
                    throw new aws_cdk_lib_1.ValidationError(`${prefix}: text must be 100 characters or less`, this);
                }
                // Validate inputAction: must be a valid GuardrailAction value (if provided)
                if (filter.inputAction !== undefined &&
                    !aws_cdk_lib_1.Token.isUnresolved(filter.inputAction) &&
                    !Object.values(filters.GuardrailAction).includes(filter.inputAction)) {
                    throw new aws_cdk_lib_1.ValidationError(`${prefix}: inputAction must be a valid GuardrailAction value`, this);
                }
                // Validate outputAction: must be a valid GuardrailAction value (if provided)
                if (filter.outputAction !== undefined &&
                    !aws_cdk_lib_1.Token.isUnresolved(filter.outputAction) &&
                    !Object.values(filters.GuardrailAction).includes(filter.outputAction)) {
                    throw new aws_cdk_lib_1.ValidationError(`${prefix}: outputAction must be a valid GuardrailAction value`, this);
                }
                // Validate inputEnabled: must be a boolean (if provided)
                if (filter.inputEnabled !== undefined &&
                    !aws_cdk_lib_1.Token.isUnresolved(filter.inputEnabled) &&
                    typeof filter.inputEnabled !== 'boolean') {
                    throw new aws_cdk_lib_1.ValidationError(`${prefix}: inputEnabled must be a boolean value`, this);
                }
                // Validate outputEnabled: must be a boolean (if provided)
                if (filter.outputEnabled !== undefined &&
                    !aws_cdk_lib_1.Token.isUnresolved(filter.outputEnabled) &&
                    typeof filter.outputEnabled !== 'boolean') {
                    throw new aws_cdk_lib_1.ValidationError(`${prefix}: outputEnabled must be a boolean value`, this);
                }
                // Apply default values for optional properties if not provided
                if (filter.inputAction === undefined) {
                    filter.inputAction = filters.GuardrailAction.BLOCK;
                }
                if (filter.inputEnabled === undefined) {
                    filter.inputEnabled = true;
                }
                if (filter.outputAction === undefined) {
                    filter.outputAction = filters.GuardrailAction.BLOCK;
                }
                if (filter.outputEnabled === undefined) {
                    filter.outputEnabled = true;
                }
            });
        }
        /**
         * Validates managed word list filters array and applies default values for optional properties.
         * @param managedWordListFilters The managed word list filters to validate.
         */
        validateManagedWordListFilters(managedWordListFilters) {
            if (!managedWordListFilters)
                return;
            managedWordListFilters.forEach((filter, index) => {
                const prefix = `Invalid ManagedWordFilter at index ${index}`;
                // Validate type: must be a valid ManagedWordFilterType value (if provided)
                if (filter.type !== undefined && !Object.values(filters.ManagedWordFilterType).includes(filter.type)) {
                    throw new aws_cdk_lib_1.ValidationError(`${prefix}: type must be a valid ManagedWordFilterType value`, this);
                }
                // Validate inputAction: must be a valid GuardrailAction value (if provided)
                if (filter.inputAction !== undefined &&
                    !aws_cdk_lib_1.Token.isUnresolved(filter.inputAction) &&
                    !Object.values(filters.GuardrailAction).includes(filter.inputAction)) {
                    throw new aws_cdk_lib_1.ValidationError(`${prefix}: inputAction must be a valid GuardrailAction value`, this);
                }
                // Validate outputAction: must be a valid GuardrailAction value (if provided)
                if (filter.outputAction !== undefined &&
                    !aws_cdk_lib_1.Token.isUnresolved(filter.outputAction) &&
                    !Object.values(filters.GuardrailAction).includes(filter.outputAction)) {
                    throw new aws_cdk_lib_1.ValidationError(`${prefix}: outputAction must be a valid GuardrailAction value`, this);
                }
                // Validate inputEnabled: must be a boolean (if provided)
                if (filter.inputEnabled !== undefined &&
                    !aws_cdk_lib_1.Token.isUnresolved(filter.inputEnabled) &&
                    typeof filter.inputEnabled !== 'boolean') {
                    throw new aws_cdk_lib_1.ValidationError(`${prefix}: inputEnabled must be a boolean value`, this);
                }
                // Validate outputEnabled: must be a boolean (if provided)
                if (filter.outputEnabled !== undefined &&
                    !aws_cdk_lib_1.Token.isUnresolved(filter.outputEnabled) &&
                    typeof filter.outputEnabled !== 'boolean') {
                    throw new aws_cdk_lib_1.ValidationError(`${prefix}: outputEnabled must be a boolean value`, this);
                }
                // Apply default values for optional properties if not provided
                if (filter.type === undefined) {
                    filter.type = filters.ManagedWordFilterType.PROFANITY;
                }
                if (filter.inputAction === undefined) {
                    filter.inputAction = filters.GuardrailAction.BLOCK;
                }
                if (filter.inputEnabled === undefined) {
                    filter.inputEnabled = true;
                }
                if (filter.outputAction === undefined) {
                    filter.outputAction = filters.GuardrailAction.BLOCK;
                }
                if (filter.outputEnabled === undefined) {
                    filter.outputEnabled = true;
                }
            });
        }
        /**
         * Validates a single content filter and applies default values for optional properties.
         * @param filter The content filter to validate.
         */
        validateSingleContentFilter(filter) {
            // Use the existing validation logic but catch and re-throw with a clearer error message
            try {
                this.validateContentFilters([filter]);
            }
            catch (error) {
                if (error instanceof aws_cdk_lib_1.ValidationError) {
                    // Replace "at index 0" with a clearer message for single filter validation
                    const message = error.message.replace(' at index 0', '');
                    throw new aws_cdk_lib_1.ValidationError(message, this);
                }
                throw error;
            }
        }
        /**
         * Validates a single PII filter and applies default values for optional properties.
         * @param filter The PII filter to validate.
         */
        validateSinglePiiFilter(filter) {
            // Use the existing validation logic but catch and re-throw with a clearer error message
            try {
                this.validatePiiFilters([filter]);
            }
            catch (error) {
                if (error instanceof aws_cdk_lib_1.ValidationError) {
                    // Replace "at index 0" with a clearer message for single filter validation
                    const message = error.message.replace(' at index 0', '');
                    throw new aws_cdk_lib_1.ValidationError(message, this);
                }
                throw error;
            }
        }
        /**
         * Validates a single regex filter and applies default values for optional properties.
         * @param filter The regex filter to validate.
         */
        validateSingleRegexFilter(filter) {
            // Use the existing validation logic but catch and re-throw with a clearer error message
            try {
                this.validateRegexFilters([filter]);
            }
            catch (error) {
                if (error instanceof aws_cdk_lib_1.ValidationError) {
                    // Replace "at index 0" with a clearer message for single filter validation
                    const message = error.message.replace(' at index 0', '');
                    throw new aws_cdk_lib_1.ValidationError(message, this);
                }
                throw error;
            }
        }
        /**
         * Validates a single denied topic and applies default values for optional properties.
         * @param filter The denied topic to validate.
         */
        validateSingleDeniedTopic(filter) {
            // Use the existing validation logic but catch and re-throw with a clearer error message
            try {
                this.validateDeniedTopics([filter]);
            }
            catch (error) {
                if (error instanceof aws_cdk_lib_1.ValidationError) {
                    // Replace "at index 0" with a clearer message for single filter validation
                    const message = error.message.replace(' at index 0', '');
                    throw new aws_cdk_lib_1.ValidationError(message, this);
                }
                throw error;
            }
        }
        /**
         * Validates a single contextual grounding filter and applies default values for optional properties.
         * @param filter The contextual grounding filter to validate.
         */
        validateSingleContextualGroundingFilter(filter) {
            // Use the existing validation logic but catch and re-throw with a clearer error message
            try {
                this.validateContextualGroundingFilters([filter]);
            }
            catch (error) {
                if (error instanceof aws_cdk_lib_1.ValidationError) {
                    // Replace "at index 0" with a clearer message for single filter validation
                    const message = error.message.replace(' at index 0', '');
                    throw new aws_cdk_lib_1.ValidationError(message, this);
                }
                throw error;
            }
        }
        /**
         * Validates a single word filter and applies default values for optional properties.
         * @param filter The word filter to validate.
         */
        validateSingleWordFilter(filter) {
            // Use the existing validation logic but catch and re-throw with a clearer error message
            try {
                this.validateWordFilters([filter]);
            }
            catch (error) {
                if (error instanceof aws_cdk_lib_1.ValidationError) {
                    // Replace "at index 0" with a clearer message for single filter validation
                    const message = error.message.replace(' at index 0', '');
                    throw new aws_cdk_lib_1.ValidationError(message, this);
                }
                throw error;
            }
        }
        /**
         * Validates a single managed word list filter and applies default values for optional properties.
         * @param filter The managed word list filter to validate.
         */
        validateSingleManagedWordListFilter(filter) {
            // Use the existing validation logic but catch and re-throw with a clearer error message
            try {
                this.validateManagedWordListFilters([filter]);
            }
            catch (error) {
                if (error instanceof aws_cdk_lib_1.ValidationError) {
                    // Replace "at index 0" with a clearer message for single filter validation
                    const message = error.message.replace(' at index 0', '');
                    throw new aws_cdk_lib_1.ValidationError(message, this);
                }
                throw error;
            }
        }
        static {
            __runInitializers(_classThis, _classExtraInitializers);
        }
    };
    return Guardrail = _classThis;
})();
exports.Guardrail = Guardrail;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ3VhcmRyYWlscy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImd1YXJkcmFpbHMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUEseUJBQXlCO0FBQ3pCLDZDQUE2RztBQUM3RyxtREFBbUQ7QUFDbkQsK0RBQWdGO0FBQ2hGLDJDQUEyQztBQUMzQyxpREFBZ0Q7QUFDaEQsNEVBQWdFO0FBQ2hFLDhFQUE4RjtBQUM5RiwwRUFBMEU7QUFFMUUsZ0JBQWdCO0FBQ2hCLCtDQUErQztBQUMvQywyREFBdUQ7QUFpR3ZEOzs7R0FHRztBQUNILE1BQXNCLGFBQWMsU0FBUSxzQkFBUTs7SUFDbEQ7Ozs7O09BS0c7SUFDSSxNQUFNLENBQUMsU0FBUyxDQUFDLFVBQWtCLEVBQUUsS0FBcUI7UUFDL0QsT0FBTyxJQUFJLHVCQUFNLENBQUM7WUFDaEIsU0FBUyxFQUFFLHdCQUF3QjtZQUNuQyxhQUFhLEVBQUUsRUFBRSxTQUFTLEVBQUUsZ0JBQWdCLEVBQUU7WUFDOUMsVUFBVTtZQUNWLEdBQUcsS0FBSztTQUNULENBQUMsQ0FBQztLQUNKO0lBRUQ7O09BRUc7SUFDSSxNQUFNLENBQUMsb0JBQW9CLENBQUMsS0FBcUI7UUFDdEQsT0FBTyxJQUFJLENBQUMsU0FBUyxDQUFDLGFBQWEsRUFBRSxLQUFLLENBQUMsQ0FBQztLQUM3QztJQUVEOztPQUVHO0lBQ0ksTUFBTSxDQUFDLHNCQUFzQixDQUFDLEtBQXFCO1FBQ3hELE9BQU8sSUFBSSxDQUFDLFNBQVMsQ0FBQyxlQUFlLEVBQUUsS0FBSyxDQUFDLENBQUM7S0FDL0M7SUFFRDs7T0FFRztJQUNJLE1BQU0sQ0FBQyw4QkFBOEIsQ0FBQyxLQUFxQjtRQUNoRSxPQUFPLElBQUksQ0FBQyxTQUFTLENBQUMsdUJBQXVCLEVBQUUsS0FBSyxDQUFDLENBQUM7S0FDdkQ7SUFFRDs7T0FFRztJQUNJLE1BQU0sQ0FBQywwQkFBMEIsQ0FBQyxLQUFxQjtR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LCBBcm5Gb3JtYXQsIElSZXNvbHZhYmxlLCBJUmVzb3VyY2UsIExhenksIFJlc291cmNlLCBUb2tlbiwgVmFsaWRhdGlvbkVycm9yIH0gZnJvbSAnYXdzLWNkay1saWInO1xuaW1wb3J0ICogYXMgYmVkcm9jayBmcm9tICdhd3MtY2RrLWxpYi9hd3MtYmVkcm9jayc7XG5pbXBvcnQgeyBNZXRyaWMsIE1ldHJpY09wdGlvbnMsIE1ldHJpY1Byb3BzIH0gZnJvbSAnYXdzLWNkay1saWIvYXdzLWNsb3Vkd2F0Y2gnO1xuaW1wb3J0ICogYXMgaWFtIGZyb20gJ2F3cy1jZGstbGliL2F3cy1pYW0nO1xuaW1wb3J0IHsgSUtleSwgS2V5IH0gZnJvbSAnYXdzLWNkay1saWIvYXdzLWttcyc7XG5pbXBvcnQgeyBtZDVoYXNoIH0gZnJvbSAnYXdzLWNkay1saWIvY29yZS9saWIvaGVscGVycy1pbnRlcm5hbCc7XG5pbXBvcnQgeyBhZGRDb25zdHJ1Y3RNZXRhZGF0YSwgTWV0aG9kTWV0YWRhdGEgfSBmcm9tICdhd3MtY2RrLWxpYi9jb3JlL2xpYi9tZXRhZGF0YS1yZXNvdXJjZSc7XG5pbXBvcnQgeyBwcm9wZXJ0eUluamVjdGFibGUgfSBmcm9tICdhd3MtY2RrLWxpYi9jb3JlL2xpYi9wcm9wLWluamVjdGFibGUnO1xuaW1wb3J0IHsgQ29uc3RydWN0IH0gZnJvbSAnY29uc3RydWN0cyc7XG4vLyBJbnRlcm5hbCBMaWJzXG5pbXBvcnQgKiBhcyBmaWx0ZXJzIGZyb20gJy4vZ3VhcmRyYWlsLWZpbHRlcnMnO1xuaW1wb3J0IHsgR3VhcmRyYWlsVmVyc2lvbiB9IGZyb20gJy4vZ3VhcmRyYWlsLXZlcnNpb24nO1xuXG4vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENPTU1PTlxuICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuLyoqXG4gKiBHdWFyZHJhaWxDcm9zc1JlZ2lvbkNvbmZpZ1Byb3BlcnR5XG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgR3VhcmRyYWlsQ3Jvc3NSZWdpb25Db25maWdQcm9wZXJ0eSB7XG4gIC8qKlxuICAgKiBUaGUgYXJuIG9mIHRoZXN5c3RlbS1kZWZpbmVkIGd1YXJkcmFpbCBwcm9maWxlIHRoYXQgeW91J3JlIHVzaW5nIHdpdGggeW91ciBndWFyZHJhaWwuXG4gICAqIEd1YXJkcmFpbCBwcm9maWxlcyBkZWZpbmUgdGhlIGRlc3RpbmF0aW9uIEFXUyBSZWdpb25zIHdoZXJlIGd1YXJkcmFpbCBpbmZlcmVuY2UgcmVxdWVzdHMgY2FuIGJlIGF1dG9tYXRpY2FsbHkgcm91dGVkLlxuICAgKiBVc2luZyBndWFyZHJhaWwgcHJvZmlsZXMgaGVscHMgbWFpbnRhaW4gZ3VhcmRyYWlsIHBlcmZvcm1hbmNlIGFuZCByZWxpYWJpbGl0eSB3aGVuIGRlbWFuZCBpbmNyZWFzZXMuXG4gICAqIEBkZWZhdWx0IC0gTm8gY3Jvc3MtcmVnaW9uIGNvbmZpZ3VyYXRpb25cbiAgICovXG4gIHJlYWRvbmx5IGd1YXJkcmFpbFByb2ZpbGVBcm46IHN0cmluZztcbn1cblxuLyoqXG4gKiBSZXByZXNlbnRzIGEgR3VhcmRyYWlsLCBlaXRoZXIgY3JlYXRlZCB3aXRoIENESyBvciBpbXBvcnRlZC5cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBJR3VhcmRyYWlsIGV4dGVuZHMgSVJlc291cmNlIHtcbiAgLyoqXG4gICAqIFRoZSBBUk4gb2YgdGhlIGd1YXJkcmFpbC5cbiAgICogQGF0dHJpYnV0ZVxuICAgKi9cbiAgcmVhZG9ubHkgZ3VhcmRyYWlsQXJuOiBzdHJpbmc7XG4gIC8qKlxuICAgKiBUaGUgSUQgb2YgdGhlIGd1YXJkcmFpbC5cbiAgICogQGF0dHJpYnV0ZVxuICAgKi9cbiAgcmVhZG9ubHkgZ3VhcmRyYWlsSWQ6IHN0cmluZztcbiAgLyoqXG4gICAqIE9wdGlvbmFsIEtNUyBlbmNyeXB0aW9uIGtleSBhc3NvY2lhdGVkIHdpdGggdGhpcyBndWFyZHJhaWxcbiAgICovXG4gIHJlYWRvbmx5IGttc0tleT86IElLZXk7XG4gIC8qKlxuICAgKiBXaGVuIHRoaXMgZ3VhcmRyYWlsIHdhcyBsYXN0IHVwZGF0ZWQuXG4gICAqL1xuICByZWFkb25seSBsYXN0VXBkYXRlZD86IHN0cmluZztcbiAgLyoqXG4gICAqIFRoZSB2ZXJzaW9uIG9mIHRoZSBndWFyZHJhaWwuIElmIG5vIGV4cGxpY2l0IHZlcnNpb24gaXMgY3JlYXRlZCxcbiAgICogdGhpcyB3aWxsIGRlZmF1bHQgdG8gXCJEUkFGVFwiXG4gICAqIEBhdHRyaWJ1dGVcbiAgICovXG4gIHJlYWRvbmx5IGd1YXJkcmFpbFZlcnNpb246IHN0cmluZztcblxuICAvKipcbiAgICogR3JhbnQgdGhlIGdpdmVuIHByaW5jaXBhbCBpZGVudGl0eSBwZXJtaXNzaW9ucyB0byBwZXJmb3JtIGFjdGlvbnMgb24gdGhpcyBndWFyZHJhaWwuXG4gICAqL1xuICBncmFudChncmFudGVlOiBpYW0uSUdyYW50YWJsZSwgLi4uYWN0aW9uczogc3RyaW5nW10pOiBpYW0uR3JhbnQ7XG4gIC8qKlxuICAgKiBHcmFudCB0aGUgZ2l2ZW4gaWRlbnRpdHkgcGVybWlzc2lvbnMgdG8gYXBwbHkgdGhlIGd1YXJkcmFpbC5cbiAgICovXG4gIGdyYW50QXBwbHkoZ3JhbnRlZTogaWFtLklHcmFudGFibGUpOiBpYW0uR3JhbnQ7XG5cbiAgLyoqXG4gICAqIFJldHVybiB0aGUgZ2l2ZW4gbmFtZWQgbWV0cmljIGZvciB0aGlzIGd1YXJkcmFpbC5cbiAgICovXG4gIG1ldHJpYyhtZXRyaWNOYW1lOiBzdHJpbmcsIHByb3BzPzogTWV0cmljT3B0aW9ucyk6IE1ldHJpYztcblxuICAvKipcbiAgICogUmV0dXJuIHRoZSBpbnZvY2F0aW9ucyBtZXRyaWMgZm9yIHRoaXMgZ3VhcmRyYWlsLlxuICAgKi9cbiAgbWV0cmljSW52b2NhdGlvbnMocHJvcHM/OiBNZXRyaWNPcHRpb25zKTogTWV0cmljO1xuXG4gIC8qKlxuICAgKiBSZXR1cm4gdGhlIGludm9jYXRpb24gbGF0ZW5jeSBtZXRyaWMgZm9yIHRoaXMgZ3VhcmRyYWlsLlxuICAgKi9cbiAgbWV0cmljSW52b2NhdGlvbkxhdGVuY3kocHJvcHM/OiBNZXRyaWNPcHRpb25zKTogTWV0cmljO1xuXG4gIC8qKlxuICAgKiBSZXR1cm4gdGhlIGludm9jYXRpb24gY2xpZW50IGVycm9ycyBtZXRyaWMgZm9yIHRoaXMgZ3VhcmRyYWlsLlxuICAgKi9cbiAgbWV0cmljSW52b2NhdGlvbkNsaWVudEVycm9ycyhwcm9wcz86IE1ldHJpY09wdGlvbnMpOiBNZXRyaWM7XG5cbiAgLyoqXG4gICAqIFJldHVybiB0aGUgaW52b2NhdGlvbiBzZXJ2ZXIgZXJyb3JzIG1ldHJpYyBmb3IgdGhpcyBndWFyZHJhaWwuXG4gICAqL1xuICBtZXRyaWNJbnZvY2F0aW9uU2VydmVyRXJyb3JzKHByb3BzPzogTWV0cmljT3B0aW9ucyk6IE1ldHJpYztcblxuICAvKipcbiAgICogUmV0dXJuIHRoZSBpbnZvY2F0aW9uIHRocm90dGxlcyBtZXRyaWMgZm9yIHRoaXMgZ3VhcmRyYWlsLlxuICAgKi9cbiAgbWV0cmljSW52b2NhdGlvblRocm90dGxlcyhwcm9wcz86IE1ldHJpY09wdGlvbnMpOiBNZXRyaWM7XG5cbiAgLyoqXG4gICAqIFJldHVybiB0aGUgdGV4dCB1bml0IGNvdW50IG1ldHJpYyBmb3IgdGhpcyBndWFyZHJhaWwuXG4gICAqL1xuICBtZXRyaWNUZXh0VW5pdENvdW50KHByb3BzPzogTWV0cmljT3B0aW9ucyk6IE1ldHJpYztcblxuICAvKipcbiAgICogUmV0dXJuIHRoZSBpbnZvY2F0aW9ucyBpbnRlcnZlbmVkIG1ldHJpYyBmb3IgdGhpcyBndWFyZHJhaWwuXG4gICAqL1xuICBtZXRyaWNJbnZvY2F0aW9uc0ludGVydmVuZWQocHJvcHM/OiBNZXRyaWNPcHRpb25zKTogTWV0cmljO1xufVxuXG4vKipcbiAqIEFic3RyYWN0IGJhc2UgY2xhc3MgZm9yIGEgR3VhcmRyYWlsLlxuICogQ29udGFpbnMgbWV0aG9kcyBhbmQgYXR0cmlidXRlcyB2YWxpZCBmb3IgR3VhcmRyYWlscyBlaXRoZXIgY3JlYXRlZCB3aXRoIENESyBvciBpbXBvcnRlZC5cbiAqL1xuZXhwb3J0IGFic3RyYWN0IGNsYXNzIEd1YXJkcmFpbEJhc2UgZXh0ZW5kcyBSZXNvdXJjZSBpbXBsZW1lbnRzIElHdWFyZHJhaWwge1xuICAvKipcbiAgICogUmV0dXJuIHRoZSBnaXZlbiBuYW1lZCBtZXRyaWMgZm9yIGFsbCBndWFyZHJhaWxzLlxuICAgKlxuICAgKiBCeSBkZWZhdWx0LCB0aGUgbWV0cmljIHdpbGwgYmUgY2FsY3VsYXRlZCBhcyBhIHN1bSBvdmVyIGEgcGVyaW9kIG9mIDUgbWludXRlcy5cbiAgICogWW91IGNhbiBjdXN0b21pemUgdGhpcyBieSB1c2luZyB0aGUgYHN0YXRpc3RpY2AgYW5kIGBwZXJpb2RgIHByb3BlcnRpZXMuXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIG1ldHJpY0FsbChtZXRyaWNOYW1lOiBzdHJpbmcsIHByb3BzPzogTWV0cmljT3B0aW9ucyk6IE1ldHJpYyB7XG4gICAgcmV0dXJuIG5ldyBNZXRyaWMoe1xuICAgICAgbmFtZXNwYWNlOiAnQVdTL0JlZHJvY2svR3VhcmRyYWlscycsXG4gICAgICBkaW1lbnNpb25zTWFwOiB7IE9wZXJhdGlvbjogJ0FwcGx5R3VhcmRyYWlsJyB9LFxuICAgICAgbWV0cmljTmFtZSxcbiAgICAgIC4uLnByb3BzLFxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybiB0aGUgaW52b2NhdGlvbnMgbWV0cmljIGZvciBhbGwgZ3VhcmRyYWlscy5cbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgbWV0cmljQWxsSW52b2NhdGlvbnMocHJvcHM/OiBNZXRyaWNPcHRpb25zKTogTWV0cmljIHtcbiAgICByZXR1cm4gdGhpcy5tZXRyaWNBbGwoJ0ludm9jYXRpb25zJywgcHJvcHMpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybiB0aGUgdGV4dCB1bml0IGNvdW50IG1ldHJpYyBmb3IgYWxsIGd1YXJkcmFpbHMuXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIG1ldHJpY0FsbFRleHRVbml0Q291bnQocHJvcHM/OiBNZXRyaWNPcHRpb25zKTogTWV0cmljIHtcbiAgICByZXR1cm4gdGhpcy5tZXRyaWNBbGwoJ1RleHRVbml0Q291bnQnLCBwcm9wcyk7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJuIHRoZSBpbnZvY2F0aW9ucyBpbnRlcnZlbmVkIG1ldHJpYyBmb3IgYWxsIGd1YXJkcmFpbHMuXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIG1ldHJpY0FsbEludm9jYXRpb25zSW50ZXJ2ZW5lZChwcm9wcz86IE1ldHJpY09wdGlvbnMpOiBNZXRyaWMge1xuICAgIHJldHVybiB0aGlzLm1ldHJpY0FsbCgnSW52b2NhdGlvbnNJbnRlcnZlbmVkJywgcHJvcHMpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybiB0aGUgaW52b2NhdGlvbiBsYXRlbmN5IG1ldHJpYyBmb3IgYWxsIGd1YXJkcmFpbHMuXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIG1ldHJpY0FsbEludm9jYXRpb25MYXRlbmN5KHByb3BzPzogTWV0cmljT3B0aW9ucyk6IE1ldHJpYyB7XG4gICAgcmV0dXJuIHRoaXMubWV0cmljQWxsKCdJbnZvY2F0aW9uTGF0ZW5jeScsIHByb3BzKTtcbiAgfVxuXG4gIHByaXZhdGUgX3ZlcnNpb246IHN0cmluZyA9ICdEUkFGVCc7XG5cbiAgLyoqXG4gICAqIFRoZSBBUk4gb2YgdGhlIGd1YXJkcmFpbC5cbiAgICogQGF0dHJpYnV0ZVxuICAgKi9cbiAgcHVibGljIGFic3RyYWN0IHJlYWRvbmx5IGd1YXJkcmFpbEFybjogc3RyaW5nO1xuXG4gIC8qKlxuICAgKiBUaGUgSUQgb2YgdGhlIGd1YXJkcmFpbC5cbiAgICogQGF0dHJpYnV0ZVxuICAgKi9cbiAgcHVibGljIGFic3RyYWN0IHJlYWRvbmx5IGd1YXJkcmFpbElkOiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIE9wdGlvbmFsIEtNUyBlbmNyeXB0aW9uIGtleSBhc3NvY2lhdGVkIHdpdGggdGhpcyBndWFyZHJhaWxcbiAgICovXG4gIHB1YmxpYyBhYnN0cmFjdCByZWFkb25seSBrbXNLZXk/OiBJS2V5O1xuXG4gIC8qKlxuICAgKiBXaGVuIHRoaXMgZ3VhcmRyYWlsIHdhcyBsYXN0IHVwZGF0ZWQuXG4gICAqL1xuICBwdWJsaWMgYWJzdHJhY3QgcmVhZG9ubHkgbGFzdFVwZGF0ZWQ/OiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIFRoZSB2ZXJzaW9uIG9mIHRoZSBndWFyZHJhaWwuXG4gICAqIEBhdHRyaWJ1dGVcbiAgICovXG4gIHB1YmxpYyBnZXQgZ3VhcmRyYWlsVmVyc2lvbigpOiBzdHJpbmcge1xuICAgIHJldHVybiB0aGlzLl92ZXJzaW9uO1xuICB9XG5cbiAgcHJvdGVjdGVkIHVwZGF0ZVZlcnNpb24odmVyc2lvbjogc3RyaW5nKSB7XG4gICAgdGhpcy5fdmVyc2lvbiA9IHZlcnNpb247XG4gIH1cblxuICAvKipcbiAgICogR3JhbnQgdGhlIGdpdmVuIHByaW5jaXBhbCBpZGVudGl0eSBwZXJtaXNzaW9ucyB0byBwZXJmb3JtIGFjdGlvbnMgb24gdGhpcyBndWFyZHJhaWwuXG4gICAqIFtkaXNhYmxlLWF3c2xpbnQ6bm8tZ3JhbnRzXVxuICAgKi9cbiAgcHVibGljIGdyYW50KGdyYW50ZWU6IGlhbS5JR3JhbnRhYmxlLCAuLi5hY3Rpb25zOiBzdHJpbmdbXSkge1xuICAgIHJldHVybiBpYW0uR3JhbnQuYWRkVG9QcmluY2lwYWwoe1xuICAgICAgZ3JhbnRlZSxcbiAgICAgIGFjdGlvbnMsXG4gICAgICByZXNvdXJjZUFybnM6IFt0aGlzLmd1YXJkcmFpbEFybl0sXG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogR3JhbnQgdGhlIGdpdmVuIGlkZW50aXR5IHBlcm1pc3Npb25zIHRvIGFwcGx5IHRoZSBndWFyZHJhaWwuXG4gICAqIFtkaXNhYmxlLWF3c2xpbnQ6bm8tZ3JhbnRzXVxuICAgKi9cbiAgcHVibGljIGdyYW50QXBwbHkoZ3JhbnRlZTogaWFtLklHcmFudGFibGUpOiBpYW0uR3JhbnQge1xuICAgIGNvbnN0IGJhc2VHcmFudCA9IHRoaXMuZ3JhbnQoZ3JhbnRlZSwgJ2JlZHJvY2s6QXBwbHlHdWFyZHJhaWwnKTtcblxuICAgIGlmICh0aGlzLmttc0tleSkge1xuICAgICAgLy8gSWYgS01TIGtleSBleGlzdHMsIGNyZWF0ZSBlbmNyeXB0aW9uIGdyYW50IGFuZCBjb21iaW5lIHdpdGggYmFzZSBncmFudFxuICAgICAgY29uc3Qga21zR3JhbnQgPSB0aGlzLmttc0tleS5ncmFudEVuY3J5cHREZWNyeXB0KGdyYW50ZWUpO1xuICAgICAgcmV0dXJuIGttc0dyYW50LmNvbWJpbmUoYmFzZUdyYW50KTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gSWYgbm8gS01TIGtleSBleGlzdHMsIHJldHVybiBvbmx5IHRoZSBiYXNlIGdyYW50XG4gICAgICByZXR1cm4gYmFzZUdyYW50O1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm4gdGhlIGdpdmVuIG5hbWVkIG1ldHJpYyBmb3IgdGhpcyBndWFyZHJhaWwuXG4gICAqXG4gICAqIEJ5IGRlZmF1bHQsIHRoZSBtZXRyaWMgd2lsbCBiZSBjYWxjdWxhdGVkIGFzIGEgc3VtIG92ZXIgYSBwZXJpb2Qgb2YgNSBtaW51dGVzLlxuICAgKiBZb3UgY2FuIGN1c3RvbWl6ZSB0aGlzIGJ5IHVzaW5nIHRoZSBgc3RhdGlzdGljYCBhbmQgYHBlcmlvZGAgcHJvcGVydGllcy5cbiAgICovXG4gIHB1YmxpYyBtZXRyaWMobWV0cmljTmFtZTogc3RyaW5nLCBwcm9wcz86IE1ldHJpY09wdGlvbnMpOiBNZXRyaWMge1xuICAgIGNvbnN0IG1ldHJpY1Byb3BzOiBNZXRyaWNQcm9wcyA9IHtcbiAgICAgIG5hbWVzcGFjZTogJ0FXUy9CZWRyb2NrL0d1YXJkcmFpbHMnLFxuICAgICAgbWV0cmljTmFtZSxcbiAgICAgIGRpbWVuc2lvbnNNYXA6IHsgR3VhcmRyYWlsQXJuOiB0aGlzLmd1YXJkcmFpbEFybiwgR3VhcmRyYWlsVmVyc2lvbjogdGhpcy5ndWFyZHJhaWxWZXJzaW9uIH0sXG4gICAgICAuLi5wcm9wcyxcbiAgICB9O1xuICAgIHJldHVybiB0aGlzLmNvbmZpZ3VyZU1ldHJpYyhtZXRyaWNQcm9wcyk7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJuIHRoZSBpbnZvY2F0aW9ucyBtZXRyaWMgZm9yIHRoaXMgZ3VhcmRyYWlsLlxuICAgKi9cbiAgcHVibGljIG1ldHJpY0ludm9jYXRpb25zKHByb3BzPzogTWV0cmljT3B0aW9ucyk6IE1ldHJpYyB7XG4gICAgcmV0dXJuIHRoaXMubWV0cmljKCdJbnZvY2F0aW9ucycsIHByb3BzKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm4gdGhlIGludm9jYXRpb24gbGF0ZW5jeSBtZXRyaWMgZm9yIHRoaXMgZ3VhcmRyYWlsLlxuICAgKi9cbiAgcHVibGljIG1ldHJpY0ludm9jYXRpb25MYXRlbmN5KHByb3BzPzogTWV0cmljT3B0aW9ucyk6IE1ldHJpYyB7XG4gICAgcmV0dXJuIHRoaXMubWV0cmljKCdJbnZvY2F0aW9uTGF0ZW5jeScsIHByb3BzKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm4gdGhlIGludm9jYXRpb24gY2xpZW50IGVycm9ycyBtZXRyaWMgZm9yIHRoaXMgZ3VhcmRyYWlsLlxuICAgKi9cbiAgcHVibGljIG1ldHJpY0ludm9jYXRpb25DbGllbnRFcnJvcnMocHJvcHM/OiBNZXRyaWNPcHRpb25zKTogTWV0cmljIHtcbiAgICByZXR1cm4gdGhpcy5tZXRyaWMoJ0ludm9jYXRpb25DbGllbnRFcnJvcnMnLCBwcm9wcyk7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJuIHRoZSBpbnZvY2F0aW9uIHNlcnZlciBlcnJvcnMgbWV0cmljIGZvciB0aGlzIGd1YXJkcmFpbC5cbiAgICovXG4gIHB1YmxpYyBtZXRyaWNJbnZvY2F0aW9uU2VydmVyRXJyb3JzKHByb3BzPzogTWV0cmljT3B0aW9ucyk6IE1ldHJpYyB7XG4gICAgcmV0dXJuIHRoaXMubWV0cmljKCdJbnZvY2F0aW9uU2VydmVyRXJyb3JzJywgcHJvcHMpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybiB0aGUgaW52b2NhdGlvbiB0aHJvdHRsZXMgbWV0cmljIGZvciB0aGlzIGd1YXJkcmFpbC5cbiAgICovXG4gIHB1YmxpYyBtZXRyaWNJbnZvY2F0aW9uVGhyb3R0bGVzKHByb3BzPzogTWV0cmljT3B0aW9ucyk6IE1ldHJpYyB7XG4gICAgcmV0dXJuIHRoaXMubWV0cmljKCdJbnZvY2F0aW9uVGhyb3R0bGVzJywgcHJvcHMpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybiB0aGUgdGV4dCB1bml0IGNvdW50IG1ldHJpYyBmb3IgdGhpcyBndWFyZHJhaWwuXG4gICAqL1xuICBwdWJsaWMgbWV0cmljVGV4dFVuaXRDb3VudChwcm9wcz86IE1ldHJpY09wdGlvbnMpOiBNZXRyaWMge1xuICAgIHJldHVybiB0aGlzLm1ldHJpYygnVGV4dFVuaXRDb3VudCcsIHByb3BzKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm4gdGhlIGludm9jYXRpb25zIGludGVydmVuZWQgbWV0cmljIGZvciB0aGlzIGd1YXJkcmFpbC5cbiAgICovXG4gIHB1YmxpYyBtZXRyaWNJbnZvY2F0aW9uc0ludGVydmVuZWQocHJvcHM/OiBNZXRyaWNPcHRpb25zKTogTWV0cmljIHtcbiAgICByZXR1cm4gdGhpcy5tZXRyaWMoJ0ludm9jYXRpb25zSW50ZXJ2ZW5lZCcsIHByb3BzKTtcbiAgfVxuXG4gIHByaXZhdGUgY29uZmlndXJlTWV0cmljKHByb3BzOiBNZXRyaWNQcm9wcykge1xuICAgIHJldHVybiBuZXcgTWV0cmljKHtcbiAgICAgIC4uLnByb3BzLFxuICAgICAgcmVnaW9uOiBwcm9wcz8ucmVnaW9uID8/IHRoaXMuc3RhY2sucmVnaW9uLFxuICAgICAgYWNjb3VudDogcHJvcHM/LmFjY291bnQgPz8gdGhpcy5zdGFjay5hY2NvdW50LFxuICAgIH0pO1xuICB9XG59XG5cbi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAqICAgICAgICAgICAgICAgICAgICAgICAgUFJPUFMgRk9SIE5FVyBDT05TVFJVQ1RcbiAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbi8qKlxuICogUHJvcGVydGllcyBmb3IgY3JlYXRpbmcgYSBHdWFyZHJhaWwuXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgR3VhcmRyYWlsUHJvcHMge1xuICAvKipcbiAgICogVGhlIG5hbWUgb2YgdGhlIGd1YXJkcmFpbC5cbiAgICogVGhpcyB3aWxsIGJlIHVzZWQgYXMgdGhlIHBoeXNpY2FsIG5hbWUgb2YgdGhlIGd1YXJkcmFpbC5cbiAgICovXG4gIHJlYWRvbmx5IGd1YXJkcmFpbE5hbWU6IHN0cmluZztcbiAgLyoqXG4gICAqIFRoZSBkZXNjcmlwdGlvbiBvZiB0aGUgZ3VhcmRyYWlsLlxuICAgKiBAZGVmYXVsdCAtIE5vIGRlc2NyaXB0aW9uXG4gICAqL1xuICByZWFkb25seSBkZXNjcmlwdGlvbj86IHN0cmluZztcbiAgLyoqXG4gICAqIFRoZSBtZXNzYWdlIHRvIHJldHVybiB3aGVuIHRoZSBndWFyZHJhaWwgYmxvY2tzIGEgcHJvbXB0LlxuICAgKiBNdXN0IGJlIGJldHdlZW4gMSBhbmQgNTAwIGNoYXJhY3RlcnMuXG4gICAqIEBkZWZhdWx0IFwiU29ycnksIHlvdXIgcXVlcnkgdmlvbGF0ZXMgb3VyIHVzYWdlIHBvbGljeS5cIlxuICAgKi9cbiAgcmVhZG9ubHkgYmxvY2tlZElucHV0TWVzc2FnaW5nPzogc3RyaW5nO1xuICAvKipcbiAgICogVGhlIG1lc3NhZ2UgdG8gcmV0dXJuIHdoZW4gdGhlIGd1YXJkcmFpbCBibG9ja3MgYSBtb2RlbCByZXNwb25zZS5cbiAgICogTXVzdCBiZSBiZXR3ZWVuIDEgYW5kIDUwMCBjaGFyYWN0ZXJzLlxuICAgKiBAZGVmYXVsdCBcIlNvcnJ5LCBJIGFtIHVuYWJsZSB0byBhbnN3ZXIgeW91ciBxdWVzdGlvbiBiZWNhdXNlIG9mIG91ciB1c2FnZSBwb2xpY3kuXCJcbiAgICovXG4gIHJlYWRvbmx5IGJsb2NrZWRPdXRwdXRzTWVzc2FnaW5nPzogc3RyaW5nO1xuICAvKipcbiAgICogQSBjdXN0b20gS01TIGtleSB0byB1c2UgZm9yIGVuY3J5cHRpbmcgZGF0YS5cbiAgICogQGRlZmF1bHQgLSBEYXRhIGlzIGVuY3J5cHRlZCBieSBkZWZhdWx0IHdpdGggYSBrZXkgdGhhdCBBV1Mgb3ducyBhbmQgbWFuYWdlcyBmb3IgeW91XG4gICAqL1xuICByZWFkb25seSBrbXNLZXk/OiBJS2V5O1xuICAvKipcbiAgICogVGhlIGNvbnRlbnQgZmlsdGVycyB0byBhcHBseSB0byB0aGUgZ3VhcmRyYWlsLlxuICAgKiBAZGVmYXVsdCBbXVxuICAgKi9cbiAgcmVhZG9ubHkgY29udGVudEZpbHRlcnM/OiBmaWx0ZXJzLkNvbnRlbnRGaWx0ZXJbXTtcbiAgLyoqXG4gICAqIFRoZSB0aWVyIGNvbmZpZ3VyYXRpb24gdG8gYXBwbHkgdG8gdGhlIGd1YXJkcmFpbC5cbiAgICogQGRlZmF1bHQgZmlsdGVycy5UaWVyQ29uZmlnLkNMQVNTSUNcbiAgICovXG4gIHJlYWRvbmx5IGNvbnRlbnRGaWx0ZXJzVGllckNvbmZpZz86IGZpbHRlcnMuVGllckNvbmZpZztcbiAgLyoqXG4gICAqIEEgbGlzdCBvZiBwb2xpY2llcyByZWxhdGVkIHRvIHRvcGljcyB0aGF0IHRoZSBndWFyZHJhaWwgc2hvdWxkIGRlbnkuXG4gICAqIEBkZWZhdWx0IFtdXG4gICAqL1xuICByZWFkb25seSBkZW5pZWRUb3BpY3M/OiBmaWx0ZXJzLlRvcGljW107XG4gIC8qKlxuICAgKiBUaGUgdGllciBjb25maWd1cmF0aW9uIHRvIGFwcGx5IHRvIHRoZSBndWFyZHJhaWwuXG4gICAqIEBkZWZhdWx0IGZpbHRlcnMuVGllckNvbmZpZy5DTEFTU0lDXG4gICAqL1xuICByZWFkb25seSB0b3BpY3NUaWVyQ29uZmlnPzogZmlsdGVycy5UaWVyQ29uZmlnO1xuICAvKipcbiAgICogVGhlIHdvcmQgZmlsdGVycyB0byBhcHBseSB0byB0aGUgZ3VhcmRyYWlsLlxuICAgKiBAZGVmYXVsdCBbXVxuICAgKi9cbiAgcmVhZG9ubHkgd29yZEZpbHRlcnM/OiBmaWx0ZXJzLldvcmRGaWx0ZXJbXTtcbiAgLyoqXG4gICAqIFRoZSBtYW5hZ2VkIHdvcmQgZmlsdGVycyB0byBhcHBseSB0byB0aGUgZ3VhcmRyYWlsLlxuICAgKiBAZGVmYXVsdCBbXVxuICAgKi9cbiAgcmVhZG9ubHkgbWFuYWdlZFdvcmRMaXN0RmlsdGVycz86IGZpbHRlcnMuTWFuYWdlZFdvcmRGaWx0ZXJbXTtcbiAgLyoqXG4gICAqIFRoZSBQSUkgZmlsdGVycyB0byBhcHBseSB0byB0aGUgZ3VhcmRyYWlsLlxuICAgKiBAZGVmYXVsdCBbXVxuICAgKi9cbiAgcmVhZG9ubHkgcGlpRmlsdGVycz86IGZpbHRlcnMuUElJRmlsdGVyW107XG4gIC8qKlxuICAgKiBUaGUgcmVndWxhciBleHByZXNzaW9uIChyZWdleCkgZmlsdGVycyB0byBhcHBseSB0byB0aGUgZ3VhcmRyYWlsLlxuICAgKiBAZGVmYXVsdCBbXVxuICAgKi9cbiAgcmVhZG9ubHkgcmVnZXhGaWx0ZXJzPzogZmlsdGVycy5SZWdleEZpbHRlcltdO1xuICAvKipcbiAgICogVGhlIGNvbnRleHR1YWwgZ3JvdW5kaW5nIGZpbHRlcnMgdG8gYXBwbHkgdG8gdGhlIGd1YXJkcmFpbC5cbiAgICogQGRlZmF1bHQgW11cbiAgICovXG4gIHJlYWRvbmx5IGNvbnRleHR1YWxHcm91bmRpbmdGaWx0ZXJzPzogZmlsdGVycy5Db250ZXh0dWFsR3JvdW5kaW5nRmlsdGVyW107XG4gIC8qKlxuICAgKiBUaGUgY3Jvc3MtcmVnaW9uIGNvbmZpZ3VyYXRpb24gZm9yIHRoZSBndWFyZHJhaWwuXG4gICAqIFRoaXMgaXMgb3B0aW9uYWwgYW5kIHdoZW4gcHJvdmlkZWQsIGl0IHNob3VsZCBiZSBvZiB0eXBlIEd1YXJkcmFpbENyb3NzUmVnaW9uQ29uZmlnUHJvcGVydHkuXG4gICAqIEBkZWZhdWx0IC0gTm8gY3Jvc3MtcmVnaW9uIGNvbmZpZ3VyYXRpb25cbiAgICovXG4gIHJlYWRvbmx5IGNyb3NzUmVnaW9uQ29uZmlnPzogR3VhcmRyYWlsQ3Jvc3NSZWdpb25Db25maWdQcm9wZXJ0eTtcbn1cblxuLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICogICAgICAgICAgICAgICAgICAgICAgQVRUUlMgRk9SIElNUE9SVEVEIENPTlNUUlVDVFxuICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuZXhwb3J0IGludGVyZmFjZSBHdWFyZHJhaWxBdHRyaWJ1dGVzIHtcbiAgLyoqXG4gICAqIFRoZSBBUk4gb2YgdGhlIGd1YXJkcmFpbC4gQXQgbGVhc3Qgb25lIG9mIGd1YXJkcmFpbEFybiBvciBndWFyZHJhaWxJZCBtdXN0IGJlXG4gICAqIGRlZmluZWQgaW4gb3JkZXIgdG8gaW5pdGlhbGl6ZSBhIGd1YXJkcmFpbCByZWYuXG4gICAqL1xuICByZWFkb25seSBndWFyZHJhaWxBcm46IHN0cmluZztcbiAgLyoqXG4gICAqIFRoZSBLTVMga2V5IG9mIHRoZSBndWFyZHJhaWwgaWYgY3VzdG9tIGVuY3J5cHRpb24gaXMgY29uZmlndXJlZC5cbiAgICpcbiAgICogQGRlZmF1bHQgdW5kZWZpbmVkIC0gTWVhbnMgZGF0YSBpcyBlbmNyeXB0ZWQgYnkgZGVmYXVsdCB3aXRoIGEgQVdTLW1hbmFnZWQga2V5XG4gICAqL1xuICByZWFkb25seSBrbXNLZXk/OiBJS2V5O1xuICAvKipcbiAgICogVGhlIHZlcnNpb24gb2YgdGhlIGd1YXJkcmFpbC5cbiAgICpcbiAgICogQGRlZmF1bHQgXCJEUkFGVFwiXG4gICAqL1xuICByZWFkb25seSBndWFyZHJhaWxWZXJzaW9uPzogc3RyaW5nO1xufVxuXG4vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4gKiAgICAgICAgICAgICAgICAgICAgICAgIE5FVyBDT05TVFJVQ1QgREVGSU5JVElPTlxuICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuLyoqXG4gKiBDbGFzcyB0byBjcmVhdGUgYSBHdWFyZHJhaWwgd2l0aCBDREsuXG4gKiBAY2xvdWRmb3JtYXRpb25SZXNvdXJjZSBBV1M6OkJlZHJvY2s6Okd1YXJkcmFpbFxuICovXG5AcHJvcGVydHlJbmplY3RhYmxlXG5leHBvcnQgY2xhc3MgR3VhcmRyYWlsIGV4dGVuZHMgR3VhcmRyYWlsQmFzZSB7XG4gIC8qKiBVbmlxdWVseSBpZGVudGlmaWVzIHRoaXMgY2xhc3MuICovXG4gIHB1YmxpYyBzdGF0aWMgcmVhZG9ubHkgUFJPUEVSVFlfSU5KRUNUSU9OX0lEOiBzdHJpbmcgPSAnQGF3cy1jZGsuYXdzLWJlZHJvY2stYWxwaGEuR3VhcmRyYWlsJztcblxuICAvKipcbiAgICogSW1wb3J0IGEgZ3VhcmRyYWlsIGdpdmVuIGl0cyBhdHRyaWJ1dGVzXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIGZyb21HdWFyZHJhaWxBdHRyaWJ1dGVzKHNjb3BlOiBDb25zdHJ1Y3QsIGlkOiBzdHJpbmcsIGF0dHJzOiBHdWFyZHJhaWxBdHRyaWJ1dGVzKTogSUd1YXJkcmFpbCB7XG4gICAgY2xhc3MgSW1wb3J0IGV4dGVuZHMgR3VhcmRyYWlsQmFzZSB7XG4gICAgICBwdWJsaWMgcmVhZG9ubHkgZ3VhcmRyYWlsQXJuID0gYXR0cnMuZ3VhcmRyYWlsQXJuO1xuICAgICAgcHVibGljIHJlYWRvbmx5IGd1YXJkcmFpbElkID0gQXJuLnNwbGl0KGF0dHJzLmd1YXJkcmFpbEFybiwgQXJuRm9ybWF0LlNMQVNIX1JFU09VUkNFX05BTUUpLnJlc291cmNlTmFtZSE7XG4gICAgICBwdWJsaWMgcmVhZG9ubHkga21zS2V5ID0gYXR0cnMua21zS2V5O1xuICAgICAgcHVibGljIHJlYWRvbmx5IGxhc3RVcGRhdGVkID0gdW5kZWZpbmVkO1xuXG4gICAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgc3VwZXIoc2NvcGUsIGlkKTtcbiAgICAgICAgdGhpcy51cGRhdGVWZXJzaW9uKGF0dHJzLmd1YXJkcmFpbFZlcnNpb24gPz8gJ0RSQUZUJyk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIG5ldyBJbXBvcnQoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBJbXBvcnQgYSBsb3ctbGV2ZWwgTDEgQ2ZuIEd1YXJkcmFpbFxuICAgKi9cbiAgcHVibGljIHN0YXRpYyBmcm9tQ2ZuR3VhcmRyYWlsKGNmbkd1YXJkcmFpbDogYmVkcm9jay5DZm5HdWFyZHJhaWwpOiBJR3VhcmRyYWlsIHtcbiAgICByZXR1cm4gbmV3IChjbGFzcyBleHRlbmRzIEd1YXJkcmFpbEJhc2Uge1xuICAgICAgcHVibGljIHJlYWRvbmx5IGd1YXJkcmFpbEFybiA9IGNmbkd1YXJkcmFpbC5hdHRyR3VhcmRyYWlsQXJuO1xuICAgICAgcHVibGljIHJlYWRvbmx5IGd1YXJkcmFpbElkID0gY2ZuR3VhcmRyYWlsLmF0dHJHdWFyZHJhaWxJZDtcbiAgICAgIHB1YmxpYyByZWFkb25seSBrbXNLZXkgPSBjZm5HdWFyZHJhaWwua21zS2V5QXJuXG4gICAgICAgID8gS2V5LmZyb21LZXlBcm4odGhpcywgJ0BGcm9tQ2ZuR3VhcmRyYWlsS2V5JywgY2ZuR3VhcmRyYWlsLmttc0tleUFybilcbiAgICAgICAgOiB1bmRlZmluZWQ7XG4gICAgICBwdWJsaWMgcmVhZG9ubHkgbGFzdFVwZGF0ZWQgPSBjZm5HdWFyZHJhaWwuYXR0clVwZGF0ZWRBdDtcblxuICAgICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHN1cGVyKGNmbkd1YXJkcmFpbCwgJ0BGcm9tQ2ZuR3VhcmRyYWlsJyk7XG4gICAgICAgIHRoaXMudXBkYXRlVmVyc2lvbihjZm5HdWFyZHJhaWwuYXR0clZlcnNpb24pO1xuICAgICAgfVxuICAgIH0pKCk7XG4gIH1cblxuICAvKipcbiAgICogVGhlIEFSTiBvZiB0aGUgZ3VhcmRyYWlsLlxuICAgKiBAYXR0cmlidXRlXG4gICAqL1xuICBwdWJsaWMgcmVhZG9ubHkgZ3VhcmRyYWlsQXJuOiBzdHJpbmc7XG4gIC8qKlxuICAgKiBUaGUgSUQgb2YgdGhlIGd1YXJkcmFpbC5cbiAgICogQGF0dHJpYnV0ZVxuICAgKi9cbiAgcHVibGljIHJlYWRvbmx5IGd1YXJkcmFpbElkOiBzdHJpbmc7XG4gIC8qKlxuICAgKiBUaGUgbmFtZSBvZiB0aGUgZ3VhcmRyYWlsLlxuICAgKi9cbiAgcHVibGljIHJlYWRvbmx5IG5hbWU6IHN0cmluZztcbiAgLyoqXG4gICAqIFRoZSBLTVMga2V5IHVzZWQgdG8gZW5jcnlwdCBkYXRhLlxuICAgKlxuICAgKiBAZGVmYXVsdCB1bmRlZmluZWQgLSBcIkRhdGEgaXMgZW5jcnlwdGVkIGJ5IGRlZmF1bHQgd2l0aCBhIGtleSB0aGF0IEFXUyBvd25zIGFuZCBtYW5hZ2VzIGZvciB5b3VcIlxuICAgKi9cbiAgcHVibGljIHJlYWRvbmx5IGttc0tleT86IElLZXk7XG4gIC8qKlxuICAgKiBUaGUgY29udGVudCBmaWx0ZXJzIGFwcGxpZWQgYnkgdGhlIGd1YXJkcmFpbC5cbiAgICovXG4gIHB1YmxpYyByZWFkb25seSBjb250ZW50RmlsdGVyczogZmlsdGVycy5Db250ZW50RmlsdGVyW107XG4gIC8qKlxuICAgKiBUaGUgUElJIGZpbHRlcnMgYXBwbGllZCBieSB0aGUgZ3VhcmRyYWlsLlxuICAgKi9cbiAgcHVibGljIHJlYWRvbmx5IHBpaUZpbHRlcnM6IGZpbHRlcnMuUElJRmlsdGVyW107XG4gIC8qKlxuICAgKiBUaGUgcmVnZXggZmlsdGVycyBhcHBsaWVkIGJ5IHRoZSBndWFyZHJhaWwuXG4gICAqL1xuICBwdWJsaWMgcmVhZG9ubHkgcmVnZXhGaWx0ZXJzOiBmaWx0ZXJzLlJlZ2V4RmlsdGVyW107XG4gIC8qKlxuICAgKiBUaGUgZGVuaWVkIHRvcGljIGZpbHRlcnMgYXBwbGllZCBieSB0aGUgZ3VhcmRyYWlsLlxuICAgKi9cbiAgcHVibGljIHJlYWRvbmx5IGRlbmllZFRvcGljczogZmlsdGVycy5Ub3BpY1tdO1xuICAvKipcbiAgICogVGhlIGNvbnRleHR1YWwgZ3JvdW5kaW5nIGZpbHRlcnMgYXBwbGllZCBieSB0aGUgZ3VhcmRyYWlsLlxuICAgKi9cbiAgcHVibGljIHJlYWRvbmx5IGNvbnRleHR1YWxHcm91bmRpbmdGaWx0ZXJzOiBmaWx0ZXJzLkNvbnRleHR1YWxHcm91bmRpbmdGaWx0ZXJbXTtcbiAgLyoqXG4gICAqIFRoZSB3b3JkIGZpbHRlcnMgYXBwbGllZCBieSB0aGUgZ3VhcmRyYWlsLlxuICAgKi9cbiAgcHVibGljIHJlYWRvbmx5IHdvcmRGaWx0ZXJzOiBmaWx0ZXJzLldvcmRGaWx0ZXJbXTtcbiAgLyoqXG4gICAqIFRoZSBtYW5hZ2VkIHdvcmQgbGlzdCBmaWx0ZXJzIGFwcGxpZWQgYnkgdGhlIGd1YXJkcmFpbC5cbiAgICovXG4gIHB1YmxpYyByZWFkb25seSBtYW5hZ2VkV29yZExpc3RGaWx0ZXJzOiBmaWx0ZXJzLk1hbmFnZWRXb3JkRmlsdGVyW107XG4gIC8qKlxuICAgKiBXaGVuIHRoaXMgZ3VhcmRyYWlsIHdhcyBsYXN0IHVwZGF0ZWRcbiAgICovXG4gIHB1YmxpYyByZWFkb25seSBsYXN0VXBkYXRlZD86IHN0cmluZztcbiAgLyoqXG4gICAqIFRoZSBjb21wdXRlZCBoYXNoIG9mIHRoZSBndWFyZHJhaWwgcHJvcGVydGllcy5cbiAgICovXG4gIHB1YmxpYyByZWFkb25seSBoYXNoOiBzdHJpbmc7XG4gIC8qKlxuICAgKiBUaGUgTDEgcmVwcmVzZW50YXRpb24gb2YgdGhlIGd1YXJkcmFpbFxuICAgKi9cbiAgcHJpdmF0ZSByZWFkb25seSBfX3Jlc291cmNlOiBiZWRyb2NrLkNmbkd1YXJkcmFpbDtcblxuICAvKipcbiAgICogVGhlIHRpZXIgdGhhdCB5b3VyIGd1YXJkcmFpbCB1c2VzIGZvciBkZW5pZWQgdG9waWMgZmlsdGVycy5cbiAgICogQGRlZmF1bHQgZmlsdGVycy5UaWVyQ29uZmlnLkNMQVNTSUNcbiAgICovXG4gIHB1YmxpYyByZWFkb25seSB0b3BpY3NUaWVyQ29uZmlnOiBmaWx0ZXJzLlRpZXJDb25maWc7XG5cbiAgLyoqXG4gICAqIFRoZSB0aWVyIHRoYXQgeW91ciBndWFyZHJhaWwgdXNlcyBmb3IgY29udGVudCBmaWx0ZXJzLlxuICAgKiBDb25zaWRlciB1c2luZyBhIHRpZXIgdGhhdCBiYWxhbmNlcyBwZXJmb3JtYW5jZSwgYWNjdXJhY3ksIGFuZCBjb21wYXRpYmlsaXR5IHdpdGggeW91ciBleGlzdGluZyBnZW5lcmF0aXZlIEFJIHdvcmtmbG93cy5cbiAgICogQGRlZmF1bHQgZmlsdGVycy5UaWVyQ29uZmlnLkNMQVNTSUNcbiAgICovXG4gIHB1YmxpYyByZWFkb25seSBjb250ZW50RmlsdGVyc1RpZXJDb25maWc6IGZpbHRlcnMuVGllckNvbmZpZztcbiAgLyoqXG4gICAqIFRoZSBjcm9zcy1yZWdpb24gY29uZmlndXJhdGlvbiBmb3IgdGhlIGd1YXJkcmFpbC5cbiAgICovXG4gIHB1YmxpYyByZWFkb25seSBjcm9zc1JlZ2lvbkNvbmZpZz86IEd1YXJkcmFpbENyb3NzUmVnaW9uQ29uZmlnUHJvcGVydHk7XG5cbiAgLyoqXG4gICAqIFRoZSBtZXNzYWdlIHRvIHJldHVybiB3aGVuIHRoZSBndWFyZHJhaWwgYmxvY2tzIGEgcHJvbXB0LlxuICAgKiBAZGVmYXVsdCBcIlNvcnJ5LCB5b3VyIHF1ZXJ5IHZpb2xhdGVzIG91ciB1c2FnZSBwb2xpY3kuXCJcbiAgICovXG4gIHB1YmxpYyByZWFkb25seSBibG9ja2VkSW5wdXRNZXNzYWdpbmc6IHN0cmluZztcblxuICAvKipcbiAgICogVGhlIG1lc3NhZ2UgdG8gcmV0dXJuIHdoZW4gdGhlIGd1YXJkcmFpbCBibG9ja3MgYSBtb2RlbCByZXNwb25zZS5cbiAgICogQGRlZmF1bHQgXCJTb3JyeSwgSSBhbSB1bmFibGUgdG8gYW5zd2VyIHlvdXIgcXVlc3Rpb24gYmVjYXVzZSBvZiBvdXIgdXNhZ2UgcG9saWN5LlwiXG4gICAqL1xuICBwdWJsaWMgcmVhZG9ubHkgYmxvY2tlZE91dHB1dHNNZXNzYWdpbmc6IHN0cmluZztcblxuICBjb25zdHJ1Y3RvcihzY29wZTogQ29uc3RydWN0LCBpZDogc3RyaW5nLCBwcm9wczogR3VhcmRyYWlsUHJvcHMpIHtcbiAgICBzdXBlcihzY29wZSwgaWQsIHtcbiAgICAgIHBoeXNpY2FsTmFtZTogcHJvcHMuZ3VhcmRyYWlsTmFtZSxcbiAgICB9KTtcbiAgICAvLyBFbmhhbmNlZCBDREsgQW5hbHl0aWNzIFRlbGVtZXRyeVxuICAgIGFkZENvbnN0cnVjdE1ldGFkYXRhKHRoaXMsIHByb3BzKTtcblxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIFNldCBwcm9wZXJ0aWVzIG9yIGRlZmF1bHRzXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgdGhpcy5uYW1lID0gdGhpcy5waHlzaWNhbE5hbWU7XG4gICAgdGhpcy5jb250ZW50RmlsdGVycyA9IHByb3BzLmNvbnRlbnRGaWx0ZXJzID8/IFtdO1xuICAgIHRoaXMucGlpRmlsdGVycyA9IHByb3BzLnBpaUZpbHRlcnMgPz8gW107XG4gICAgdGhpcy5yZWdleEZpbHRlcnMgPSBwcm9wcy5yZWdleEZpbHRlcnMgPz8gW107XG4gICAgdGhpcy5kZW5pZWRUb3BpY3MgPSBwcm9wcy5kZW5pZWRUb3BpY3MgPz8gW107XG4gICAgdGhpcy5jb250ZXh0dWFsR3JvdW5kaW5nRmlsdGVycyA9IHByb3BzLmNvbnRleHR1YWxHcm91bmRpbmdGaWx0ZXJzID8/IFtdO1xuICAgIHRoaXMud29yZEZpbHRlcnMgPSBwcm9wcy53b3JkRmlsdGVycyA/PyBbXTtcbiAgICB0aGlzLm1hbmFnZWRXb3JkTGlzdEZpbHRlcnMgPSBwcm9wcy5tYW5hZ2VkV29yZExpc3RGaWx0ZXJzID8/IFtdO1xuICAgIHRoaXMudG9waWNzVGllckNvbmZpZyA9IHByb3BzLnRvcGljc1RpZXJDb25maWcgPz8gZmlsdGVycy5UaWVyQ29uZmlnLkNMQVNTSUM7XG4gICAgdGhpcy5jb250ZW50RmlsdGVyc1RpZXJDb25maWcgPSBwcm9wcy5jb250ZW50RmlsdGVyc1RpZXJDb25maWcgPz8gZmlsdGVycy5UaWVyQ29uZmlnLkNMQVNTSUM7XG4gICAgdGhpcy5jcm9zc1JlZ2lvbkNvbmZpZyA9IHByb3BzLmNyb3NzUmVnaW9uQ29uZmlnO1xuICAgIHRoaXMuYmxvY2tlZElucHV0TWVzc2FnaW5nID0gcHJvcHMuYmxvY2tlZElucHV0TWVzc2FnaW5nID8/ICdTb3JyeSwgeW91ciBxdWVyeSB2aW9sYXRlcyBvdXIgdXNhZ2UgcG9saWN5Lic7XG4gICAgdGhpcy5ibG9ja2VkT3V0cHV0c01lc3NhZ2luZyA9IHByb3BzLmJsb2NrZWRPdXRwdXRzTWVzc2FnaW5nID8/ICdTb3JyeSwgSSBhbSB1bmFibGUgdG8gYW5zd2VyIHlvdXIgcXVlc3Rpb24gYmVjYXVzZSBvZiBvdXIgdXNhZ2UgcG9saWN5Lic7XG5cbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBWYWxpZGF0ZSBhbGwgZmlsdGVyIGFycmF5c1xuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIHRoaXMudmFsaWRhdGVDb250ZW50RmlsdGVycyh0aGlzLmNvbnRlbnRGaWx0ZXJzKTtcbiAgICB0aGlzLnZhbGlkYXRlUGlpRmlsdGVycyh0aGlzLnBpaUZpbHRlcnMpO1xuICAgIHRoaXMudmFsaWRhdGVSZWdleEZpbHRlcnModGhpcy5yZWdleEZpbHRlcnMpO1xuICAgIHRoaXMudmFsaWRhdGVEZW5pZWRUb3BpY3ModGhpcy5kZW5pZWRUb3BpY3MpO1xuICAgIHRoaXMudmFsaWRhdGVDb250ZXh0dWFsR3JvdW5kaW5nRmlsdGVycyh0aGlzLmNvbnRleHR1YWxHcm91bmRpbmdGaWx0ZXJzKTtcbiAgICB0aGlzLnZhbGlkYXRlV29yZEZpbHRlcnModGhpcy53b3JkRmlsdGVycyk7XG4gICAgdGhpcy52YWxpZGF0ZU1hbmFnZWRXb3JkTGlzdEZpbHRlcnModGhpcy5tYW5hZ2VkV29yZExpc3RGaWx0ZXJzKTtcblxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIFZhbGlkYXRlIG1lc3NhZ2luZyBwcm9wZXJ0aWVzXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgdGhpcy52YWxpZGF0ZU1lc3NhZ2luZ1Byb3BlcnR5KHRoaXMuYmxvY2tlZElucHV0TWVzc2FnaW5nLCAnYmxvY2tlZElucHV0TWVzc2FnaW5nJyk7XG4gICAgdGhpcy52YWxpZGF0ZU1lc3NhZ2luZ1Byb3BlcnR5KHRoaXMuYmxvY2tlZE91dHB1dHNNZXNzYWdpbmcsICdibG9ja2VkT3V0cHV0c01lc3NhZ2luZycpO1xuXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gVmFsaWRhdGUgdGllciBjb25maWd1cmF0aW9uIHJlcXVpcmVtZW50c1xuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIHRoaXMudmFsaWRhdGVUaWVyQ29uZmlndXJhdGlvbihwcm9wcyk7XG5cbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBDRk4gUHJvcHMgLSBXaXRoIExhenkgc3VwcG9ydFxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIGxldCBjZm5Qcm9wczogYmVkcm9jay5DZm5HdWFyZHJhaWxQcm9wcyA9IHtcbiAgICAgIG5hbWU6IHByb3BzLmd1YXJkcmFpbE5hbWUsXG4gICAgICBkZXNjcmlwdGlvbjogcHJvcHMuZGVzY3JpcHRpb24sXG4gICAgICBrbXNLZXlBcm46IHByb3BzLmttc0tleT8ua2V5QXJuLFxuICAgICAgYmxvY2tlZElucHV0TWVzc2FnaW5nOiB0aGlzLmJsb2NrZWRJbnB1dE1lc3NhZ2luZyxcbiAgICAgIGJsb2NrZWRPdXRwdXRzTWVzc2FnaW5nOiB0aGlzLmJsb2NrZWRPdXRwdXRzTWVzc2FnaW5nLFxuICAgICAgLy8gTGF6eSBwcm9wc1xuICAgICAgY3Jvc3NSZWdpb25Db25maWc6IHRoaXMuZ2VuZXJhdGVDZm5Dcm9zc1JlZ2lvbkNvbmZpZygpLFxuICAgICAgY29udGVudFBvbGljeUNvbmZpZzogdGhpcy5nZW5lcmF0ZUNmbkNvbnRlbnRQb2xpY3lDb25maWcoKSxcbiAgICAgIGNvbnRleHR1YWxHcm91bmRpbmdQb2xpY3lDb25maWc6IHRoaXMuZ2VuZXJhdGVDZm5Db250ZXh0dWFsUG9saWN5Q29uZmlnKCksXG4gICAgICB0b3BpY1BvbGljeUNvbmZpZzogdGhpcy5nZW5lcmF0ZUNmblRvcGljUG9saWN5KCksXG4gICAgICB3b3JkUG9saWN5Q29uZmlnOiB0aGlzLmdlbmVyYXRlQ2ZuV29yZFBvbGljeUNvbmZpZygpLFxuICAgICAgc2Vuc2l0aXZlSW5mb3JtYXRpb25Qb2xpY3lDb25maWc6IHRoaXMuZ2VuZXJhdGVDZm5TZW5zaXRpdmVJbmZvcm1hdGlvblBvbGljeUNvbmZpZygpLFxuICAgIH07XG5cbiAgICAvLyBIYXNoIGNhbGN1bGF0aW9uIHVzZWZ1bCBmb3IgdmVyc2lvbmluZyBvZiB0aGUgZ3VhcmRyYWlsXG4gICAgdGhpcy5oYXNoID0gbWQ1aGFzaChKU09OLnN0cmluZ2lmeShjZm5Qcm9wcykpO1xuXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gTDEgSW5zdGFudGlhdGlvblxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIHRoaXMuX19yZXNvdXJjZSA9IG5ldyBiZWRyb2NrLkNmbkd1YXJkcmFpbCh0aGlzLCAnTXlHdWFyZHJhaWwnLCBjZm5Qcm9wcyk7XG5cbiAgICB0aGlzLmd1YXJkcmFpbElkID0gdGhpcy5fX3Jlc291cmNlLmF0dHJHdWFyZHJhaWxJZDtcbiAgICB0aGlzLmd1YXJkcmFpbEFybiA9IHRoaXMuX19yZXNvdXJjZS5hdHRyR3VhcmRyYWlsQXJuO1xuICAgIHRoaXMudXBkYXRlVmVyc2lvbih0aGlzLl9fcmVzb3VyY2UuYXR0clZlcnNpb24pO1xuICAgIHRoaXMubGFzdFVwZGF0ZWQgPSB0aGlzLl9fcmVzb3VyY2UuYXR0clVwZGF0ZWRBdDtcbiAgfVxuXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAvLyBNRVRIT0RTXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAvKipcbiAgICogQWRkcyBhIGNvbnRlbnQgZmlsdGVyIHRvIHRoZSBndWFyZHJhaWwuXG4gICAqIEBwYXJhbSBmaWx0ZXIgVGhlIGNvbnRlbnQgZmlsdGVyIHRvIGFkZC5cbiAgICovXG4gIEBNZXRob2RNZXRhZGF0YSgpXG4gIHB1YmxpYyBhZGRDb250ZW50RmlsdGVyKGZpbHRlcjogZmlsdGVycy5Db250ZW50RmlsdGVyKTogdm9pZCB7XG4gICAgdGhpcy52YWxpZGF0ZVNpbmdsZUNvbnRlbnRGaWx0ZXIoZmlsdGVyKTtcbiAgICB0aGlzLmNvbnRlbnRGaWx0ZXJzLnB1c2goZmlsdGVyKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBZGRzIGEgUElJIGZpbHRlciB0byB0aGUgZ3VhcmRyYWlsLlxuICAgKiBAcGFyYW0gZmlsdGVyIFRoZSBQSUkgZmlsdGVyIHRvIGFkZC5cbiAgICovXG4gIEBNZXRob2RNZXRhZGF0YSgpXG4gIHB1YmxpYyBhZGRQSUlGaWx0ZXIoZmlsdGVyOiBmaWx0ZXJzLlBJSUZpbHRlcik6IHZvaWQge1xuICAgIHRoaXMudmFsaWRhdGVTaW5nbGVQaWlGaWx0ZXIoZmlsdGVyKTtcbiAgICB0aGlzLnBpaUZpbHRlcnMucHVzaChmaWx0ZXIpO1xuICB9XG5cbiAgLyoqXG4gICAqIEFkZHMgYSByZWdleCBmaWx0ZXIgdG8gdGhlIGd1YXJkcmFpbC5cbiAgICogQHBhcmFtIGZpbHRlciBUaGUgcmVnZXggZmlsdGVyIHRvIGFkZC5cbiAgICovXG4gIEBNZXRob2RNZXRhZGF0YSgpXG4gIHB1YmxpYyBhZGRSZWdleEZpbHRlcihmaWx0ZXI6IGZpbHRlcnMuUmVnZXhGaWx0ZXIpOiB2b2lkIHtcbiAgICB0aGlzLnZhbGlkYXRlU2luZ2xlUmVnZXhGaWx0ZXIoZmlsdGVyKTtcbiAgICB0aGlzLnJlZ2V4RmlsdGVycy5wdXNoKGZpbHRlcik7XG4gIH1cblxuICAvKipcbiAgICogQWRkcyBhIGRlbmllZCB0b3BpYyBmaWx0ZXIgdG8gdGhlIGd1YXJkcmFpbC5cbiAgICogQHBhcmFtIGZpbHRlciBUaGUgZGVuaWVkIHRvcGljIGZpbHRlciB0byBhZGQuXG4gICAqL1xuICBATWV0aG9kTWV0YWRhdGEoKVxuICBwdWJsaWMgYWRkRGVuaWVkVG9waWNGaWx0ZXIoZmlsdGVyOiBmaWx0ZXJzLlRvcGljKTogdm9pZCB7XG4gICAgdGhpcy52YWxpZGF0ZVNpbmdsZURlbmllZFRvcGljKGZpbHRlcik7XG4gICAgdGhpcy5kZW5pZWRUb3BpY3MucHVzaChmaWx0ZXIpO1xuICB9XG5cbiAgLyoqXG4gICAqIEFkZHMgYSBjb250ZXh0dWFsIGdyb3VuZGluZyBmaWx0ZXIgdG8gdGhlIGd1YXJkcmFpbC5cbiAgICogQHBhcmFtIGZpbHRlciBUaGUgY29udGV4dHVhbCBncm91bmRpbmcgZmlsdGVyIHRvIGFkZC5cbiAgICovXG4gIEBNZXRob2RNZXRhZGF0YSgpXG4gIHB1YmxpYyBhZGRDb250ZXh0dWFsR3JvdW5kaW5nRmlsdGVyKGZpbHRlcjogZmlsdGVycy5Db250ZXh0dWFsR3JvdW5kaW5nRmlsdGVyKTogdm9pZCB7XG4gICAgdGhpcy52YWxpZGF0ZVNpbmdsZUNvbnRleHR1YWxHcm91bmRpbmdGaWx0ZXIoZmlsdGVyKTtcbiAgICB0aGlzLmNvbnRleHR1YWxHcm91bmRpbmdGaWx0ZXJzLnB1c2goZmlsdGVyKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBZGRzIGEgd29yZCBmaWx0ZXIgdG8gdGhlIGd1YXJkcmFpbC5cbiAgICogQHBhcmFtIGZpbHRlciBUaGUgd29yZCBmaWx0ZXIgdG8gYWRkLlxuICAgKi9cbiAgQE1ldGhvZE1ldGFkYXRhKClcbiAgcHVibGljIGFkZFdvcmRGaWx0ZXIoZmlsdGVyOiBmaWx0ZXJzLldvcmRGaWx0ZXIpOiB2b2lkIHtcbiAgICB0aGlzLnZhbGlkYXRlU2luZ2xlV29yZEZpbHRlcihmaWx0ZXIpO1xuICAgIHRoaXMud29yZEZpbHRlcnMucHVzaChmaWx0ZXIpO1xuICB9XG5cbiAgLyoqXG4gICAqIEFkZHMgYSB3b3JkIGZpbHRlciB0byB0aGUgZ3VhcmRyYWlsLlxuICAgKiBAcGFyYW0gZmlsZVBhdGggVGhlIGxvY2F0aW9uIG9mIHRoZSB3b3JkIGZpbHRlciBmaWxlLlxuICAgKi9cbiAgQE1ldGhvZE1ldGFkYXRhKClcbiAgcHVibGljIGFkZFdvcmRGaWx0ZXJGcm9tRmlsZShmaWxlUGF0aDogc3RyaW5nLFxuICAgIGlucHV0QWN0aW9uPzogZmlsdGVycy5HdWFyZHJhaWxBY3Rpb24sXG4gICAgb3V0cHV0QWN0aW9uPzogZmlsdGVycy5HdWFyZHJhaWxBY3Rpb24sXG4gICAgaW5wdXRFbmFibGVkPzogYm9vbGVhbixcbiAgICBvdXRwdXRFbmFibGVkPzogYm9vbGVhbik6IHZvaWQge1xuICAgIGNvbnN0IGZpbGVDb250ZW50cyA9IGZzLnJlYWRGaWxlU3luYyhmaWxlUGF0aCwgJ3V0ZjgnKTtcbiAgICBjb25zdCB3b3JkcyA9IGZpbGVDb250ZW50cy50cmltKCkuc3BsaXQoJywnKTtcbiAgICBmb3IgKGNvbnN0IHdvcmQgb2Ygd29yZHMpIHRoaXMuYWRkV29yZEZpbHRlcih7IHRleHQ6IHdvcmQsIGlucHV0QWN0aW9uLCBvdXRwdXRBY3Rpb24sIGlucHV0RW5hYmxlZCwgb3V0cHV0RW5hYmxlZCB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBZGRzIGEgbWFuYWdlZCB3b3JkIGxpc3QgZmlsdGVyIHRvIHRoZSBndWFyZHJhaWwuXG4gICAqIEBwYXJhbSBmaWx0ZXIgVGhlIG1hbmFnZWQgd29yZCBsaXN0IGZpbHRlciB0byBhZGQuXG4gICAqL1xuICBATWV0aG9kTWV0YWRhdGEoKVxuICBwdWJsaWMgYWRkTWFuYWdlZFdvcmRMaXN0RmlsdGVyKGZpbHRlcjogZmlsdGVycy5NYW5hZ2VkV29yZEZpbHRlcik6IHZvaWQge1xuICAgIHRoaXMudmFsaWRhdGVTaW5nbGVNYW5hZ2VkV29yZExpc3RGaWx0ZXIoZmlsdGVyKTtcbiAgICB0aGlzLm1hbmFnZWRXb3JkTGlzdEZpbHRlcnMucHVzaChmaWx0ZXIpO1xuICB9XG5cbiAgLyoqXG4gICAqIENyZWF0ZSBhIHZlcnNpb24gZm9yIHRoZSBndWFyZHJhaWwuXG4gICAqIEBwYXJhbSBkZXNjcmlwdGlvbiBUaGUgZGVzY3JpcHRpb24gb2YgdGhlIHZlcnNpb24uXG4gICAqIEByZXR1cm5zIFRoZSBndWFyZHJhaWwgdmVyc2lvbi5cbiAgICovXG4gIEBNZXRob2RNZXRhZGF0YSgpXG4gIHB1YmxpYyBjcmVhdGVWZXJzaW9uKGRlc2NyaXB0aW9uPzogc3RyaW5nKTogc3RyaW5nIHtcbiAgICBjb25zdCBjZm5WZXJzaW9uID0gbmV3IEd1YXJkcmFpbFZlcnNpb24odGhpcywgYEd1YXJkcmFpbFZlcnNpb24tJHt0aGlzLmhhc2guc2xpY2UoMCwgMTYpfWAsIHtcbiAgICAgIGRlc2NyaXB0aW9uOiBkZXNjcmlwdGlvbixcbiAgICAgIGd1YXJkcmFpbDogdGhpcyxcbiAgICB9KTtcblxuICAgIHRoaXMudXBkYXRlVmVyc2lvbihjZm5WZXJzaW9uLmd1YXJkcmFpbFZlcnNpb24pO1xuICAgIHJldHVybiB0aGlzLmd1YXJkcmFpbFZlcnNpb247XG4gIH1cblxuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgLy8gQ0ZOIEdlbmVyYXRvcnNcbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIC8qKlxuICAgKiBSZXR1cm5zIHRoZSBjb250ZW50IGZpbHRlcnMgYXBwbGllZCB0byB0aGUgZ3VhcmRyYWlsLiBUaGlzIG1ldGhvZCBkZWZlcnMgdGhlIGNvbXB1dGF0aW9uXG4gICAqIHRvIHN5bnRoIHRpbWUuXG4gICAqL1xuICBwcml2YXRlIGdlbmVyYXRlQ2ZuQ29udGVudFBvbGljeUNvbmZpZygpOiBJUmVzb2x2YWJsZSB7XG4gICAgcmV0dXJuIExhenkuYW55KHtcbiAgICAgIHByb2R1Y2U6ICgpID0+IHtcbiAgICAgICAgaWYgKHRoaXMuY29udGVudEZpbHRlcnMubGVuZ3RoID4gMCkge1xuICAgICAgICAgIGNvbnN0IGNvbnRlbnRQb2xpY3lDb25maWc6IGJlZHJvY2suQ2ZuR3VhcmRyYWlsLkNvbnRlbnRQb2xpY3lDb25maWdQcm9wZXJ0eSA9IHtcbiAgICAgICAgICAgIGZpbHRlcnNDb25maWc6IHRoaXMuY29udGVudEZpbHRlcnMsXG4gICAgICAgICAgICAuLi4odGhpcy5jb250ZW50RmlsdGVyc1RpZXJDb25maWcgJiYge1xuICAgICAgICAgICAgICBjb250ZW50RmlsdGVyc1RpZXJDb25maWc6IHtcbiAgICAgICAgICAgICAgICB0aWVyTmFtZTogdGhpcy5jb250ZW50RmlsdGVyc1RpZXJDb25maWcsXG4gICAgICAgICAgICAgIH0gYXMgYmVkcm9jay5DZm5HdWFyZHJhaWwuQ29udGVudEZpbHRlcnNUaWVyQ29uZmlnUHJvcGVydHksXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICB9O1xuXG4gICAgICAgICAgcmV0dXJuIGNvbnRlbnRQb2xpY3lDb25maWc7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIHRoZSB0b3BpYyBmaWx0ZXJzIGFwcGxpZWQgdG8gdGhlIGd1YXJkcmFpbC4gVGhpcyBtZXRob2QgZGVmZXJzIHRoZSBjb21wdXRhdGlvblxuICAgKiB0byBzeW50aCB0aW1lLlxuICAgKi9cbiAgcHJpdmF0ZSBnZW5lcmF0ZUNmblRvcGljUG9saWN5KCk6IElSZXNvbHZhYmxlIHtcbiAgICByZXR1cm4gTGF6eS5hbnkoe1xuICAgICAgcHJvZHVjZTogKCkgPT4ge1xuICAgICAgICBpZiAodGhpcy5kZW5pZWRUb3BpY3MubGVuZ3RoID4gMCkge1xuICAgICAgICAgIGNvbnN0IHRvcGljUG9saWN5Q29uZmlnOiBiZWRyb2NrLkNmbkd1YXJkcmFpbC5Ub3BpY1BvbGljeUNvbmZpZ1Byb3BlcnR5ID0ge1xuICAgICAgICAgICAgdG9waWNzQ29uZmlnOiB0aGlzLmRlbmllZFRvcGljcy5mbGF0TWFwKCh0b3BpYzogZmlsdGVycy5Ub3BpYykgPT4ge1xuICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGRlZmluaXRpb246IHRvcGljLmRlZmluaXRpb24sXG4gICAgICAgICAgICAgICAgbmFtZTogdG9waWMubmFtZSxcbiAgICAgICAgICAgICAgICBleGFtcGxlczogdG9waWMuZXhhbXBsZXMsXG4gICAgICAgICAgICAgICAgdHlwZTogJ0RFTlknLFxuICAgICAgICAgICAgICAgIGlucHV0QWN0aW9uOiB0b3BpYy5pbnB1dEFjdGlvbixcbiAgICAgICAgICAgICAgICBpbnB1dEVuYWJsZWQ6IHRvcGljLmlucHV0RW5hYmxlZCxcbiAgICAgICAgICAgICAgICBvdXRwdXRBY3Rpb246IHRvcGljLm91dHB1dEFjdGlvbixcbiAgICAgICAgICAgICAgICBvdXRwdXRFbmFibGVkOiB0b3BpYy5vdXRwdXRFbmFibGVkLFxuICAgICAgICAgICAgICB9IGFzIGJlZHJvY2suQ2ZuR3VhcmRyYWlsLlRvcGljQ29uZmlnUHJvcGVydHk7XG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIC4uLih0aGlzLnRvcGljc1RpZXJDb25maWcgJiYge1xuICAgICAgICAgICAgICB0b3BpY3NUaWVyQ29uZmlnOiB7XG4gICAgICAgICAgICAgICAgdGllck5hbWU6IHRoaXMudG9waWNzVGllckNvbmZpZyxcbiAgICAgICAgICAgICAgfSBhcyBiZWRyb2NrLkNmbkd1YXJkcmFpbC5Ub3BpY3NUaWVyQ29uZmlnUHJvcGVydHksXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICB9O1xuXG4gICAgICAgICAgcmV0dXJuIHRvcGljUG9saWN5Q29uZmlnO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyB0aGUgY29udGVjdHVhbCBmaWx0ZXJzIGFwcGxpZWQgdG8gdGhlIGd1YXJkcmFpbC4gVGhpcyBtZXRob2QgZGVmZXJzIHRoZSBjb21wdXRhdGlvblxuICAgKiB0byBzeW50aCB0aW1lLlxuICAgKi9cbiAgcHJpdmF0ZSBnZW5lcmF0ZUNmbkNvbnRleHR1YWxQb2xpY3lDb25maWcoKTogSVJlc29sdmFibGUge1xuICAgIHJldHVybiBMYXp5LmFueSh7XG4gICAgICBwcm9kdWNlOiAoKSA9PiB7XG4gICAgICAgIGlmICh0aGlzLmNvbnRleHR1YWxHcm91bmRpbmdGaWx0ZXJzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgZmlsdGVyc0NvbmZpZzogdGhpcy5jb250ZXh0dWFsR3JvdW5kaW5nRmlsdGVycy5mbGF0TWFwKChmaWx0ZXI6IGZpbHRlcnMuQ29udGV4dHVhbEdyb3VuZGluZ0ZpbHRlcikgPT4ge1xuICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHR5cGU6IGZpbHRlci50eXBlLFxuICAgICAgICAgICAgICAgIHRocmVzaG9sZDogZmlsdGVyLnRocmVzaG9sZCxcbiAgICAgICAgICAgICAgICBhY3Rpb246IGZpbHRlci5hY3Rpb24sXG4gICAgICAgICAgICAgICAgZW5hYmxlZDogZmlsdGVyLmVuYWJsZWQsXG4gICAgICAgICAgICAgIH0gYXMgYmVkcm9jay5DZm5HdWFyZHJhaWwuQ29udGV4dHVhbEdyb3VuZGluZ0ZpbHRlckNvbmZpZ1Byb3BlcnR5O1xuICAgICAgICAgICAgfSksXG4gICAgICAgICAgfTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgdGhlIHdvcmQgY29uZmlnIGFwcGxpZWQgdG8gdGhlIGd1YXJkcmFpbC4gVGhpcyBtZXRob2QgZGVmZXJzIHRoZSBjb21wdXRhdGlvblxuICAgKiB0byBzeW50aCB0aW1lLlxuICAgKi9cbiAgcHJpdmF0ZSBnZW5lcmF0ZUNmbldvcmRQb2xpY3lDb25maWcoKTogSVJlc29sdmFibGUge1xuICAgIHJldHVybiBMYXp5LmFueSh7XG4gICAgICBwcm9kdWNlOiAoKSA9PiB7XG4gICAgICAgIGlmICh0aGlzLndvcmRGaWx0ZXJzLmxlbmd0aCA+IDAgfHwgdGhpcy5tYW5hZ2VkV29yZExpc3RGaWx0ZXJzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgd29yZHNDb25maWc6IHRoaXMuZ2VuZXJhdGVDZm5Xb3JkQ29uZmlnKCksXG4gICAgICAgICAgICBtYW5hZ2VkV29yZExpc3RzQ29uZmlnOiB0aGlzLmdlbmVyYXRlQ2ZuTWFuYWdlZFdvcmRMaXN0c0NvbmZpZygpLFxuICAgICAgICAgIH0gYXMgYmVkcm9jay5DZm5HdWFyZHJhaWwuV29yZFBvbGljeUNvbmZpZ1Byb3BlcnR5O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyB0aGUgd29yZCBmaWx0ZXJzIGFwcGxpZWQgdG8gdGhlIGd1YXJkcmFpbC4gVGhpcyBtZXRob2QgZGVmZXJzIHRoZSBjb21wdXRhdGlvblxuICAgKiB0byBzeW50aCB0aW1lLlxuICAgKi9cbiAgcHJpdmF0ZSBnZW5lcmF0ZUNmbldvcmRDb25maWcoKTogSVJlc29sdmFibGUge1xuICAgIHJldHVybiBMYXp5LmFueShcbiAgICAgIHtcbiAgICAgICAgcHJvZHVjZTogKCkgPT4ge1xuICAgICAgICAgIHJldHVybiB0aGlzLndvcmRGaWx0ZXJzLmZsYXRNYXAoKHdvcmQ6IGZpbHRlcnMuV29yZEZpbHRlcikgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgdGV4dDogd29yZC50ZXh0LFxuICAgICAgICAgICAgICBpbnB1dEFjdGlvbjogd29yZC5pbnB1dEFjdGlvbixcbiAgICAgICAgICAgICAgaW5wdXRFbmFibGVkOiB3b3JkLmlucHV0RW5hYmxlZCxcbiAgICAgICAgICAgICAgb3V0cHV0QWN0aW9uOiB3b3JkLm91dHB1dEFjdGlvbixcbiAgICAgICAgICAgICAgb3V0cHV0RW5hYmxlZDogd29yZC5vdXRwdXRFbmFibGVkLFxuICAgICAgICAgICAgfSBhcyBiZWRyb2NrLkNmbkd1YXJkcmFpbC5Xb3JkQ29uZmlnUHJvcGVydHk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAgeyBvbWl0RW1wdHlBcnJheTogdHJ1ZSB9LFxuICAgICk7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyB0aGUgd29yZCBmaWx0ZXJzIGFwcGxpZWQgdG8gdGhlIGd1YXJkcmFpbC4gVGhpcyBtZXRob2QgZGVmZXJzIHRoZSBjb21wdXRhdGlvblxuICAgKiB0byBzeW50aCB0aW1lLlxuICAgKi9cbiAgcHJpdmF0ZSBnZW5lcmF0ZUNmbk1hbmFnZWRXb3JkTGlzdHNDb25maWcoKTogSVJlc29sdmFibGUge1xuICAgIHJldHVybiBMYXp5LmFueShcbiAgICAgIHtcbiAgICAgICAgcHJvZHVjZTogKCkgPT4ge1xuICAgICAgICAgIHJldHVybiB0aGlzLm1hbmFnZWRXb3JkTGlzdEZpbHRlcnMuZmxhdE1hcCgoZmlsdGVyOiBmaWx0ZXJzLk1hbmFnZWRXb3JkRmlsdGVyKSA9PiB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICB0eXBlOiBmaWx0ZXIudHlwZSxcbiAgICAgICAgICAgICAgaW5wdXRBY3Rpb246IGZpbHRlci5pbnB1dEFjdGlvbixcbiAgICAgICAgICAgICAgaW5wdXRFbmFibGVkOiBmaWx0ZXIuaW5wdXRFbmFibGVkLFxuICAgICAgICAgICAgICBvdXRwdXRBY3Rpb246IGZpbHRlci5vdXRwdXRBY3Rpb24sXG4gICAgICAgICAgICAgIG91dHB1dEVuYWJsZWQ6IGZpbHRlci5vdXRwdXRFbmFibGVkLFxuICAgICAgICAgICAgfSBhcyBiZWRyb2NrLkNmbkd1YXJkcmFpbC5NYW5hZ2VkV29yZHNDb25maWdQcm9wZXJ0eTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgICB7IG9taXRFbXB0eUFycmF5OiB0cnVlIH0sXG4gICAgKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIHRoZSBzZW5zaXRpdmUgaW5mb3JtYXRpb24gY29uZmlnIGFwcGxpZWQgdG8gdGhlIGd1YXJkcmFpbC4gVGhpcyBtZXRob2QgZGVmZXJzIHRoZSBjb21wdXRhdGlvblxuICAgKiB0byBzeW50aCB0aW1lLlxuICAgKi9cbiAgcHJpdmF0ZSBnZW5lcmF0ZUNmblNlbnNpdGl2ZUluZm9ybWF0aW9uUG9saWN5Q29uZmlnKCk6IElSZXNvbHZhYmxlIHtcbiAgICByZXR1cm4gTGF6eS5hbnkoXG4gICAgICB7XG4gICAgICAgIHByb2R1Y2U6ICgpID0+IHtcbiAgICAgICAgICBpZiAodGhpcy5yZWdleEZpbHRlcnMubGVuZ3RoID4gMCB8fCB0aGlzLnBpaUZpbHRlcnMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgcmVnZXhlc0NvbmZpZzogdGhpcy5nZW5lcmF0ZUNmblJlZ2V4ZXNDb25maWcoKSxcbiAgICAgICAgICAgICAgcGlpRW50aXRpZXNDb25maWc6IHRoaXMuZ2VuZXJhdGVDZm5QaWlFbnRpdGllc0NvbmZpZygpLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAgeyBvbWl0RW1wdHlBcnJheTogdHJ1ZSB9LFxuICAgICk7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyB0aGUgcmVnZXggZmlsdGVycyBhcHBsaWVkIHRvIHRoZSBndWFyZHJhaWwuIFRoaXMgbWV0aG9kIGRlZmVycyB0aGUgY29tcHV0YXRpb25cbiAgICogdG8gc3ludGggdGltZS5cbiAgICovXG4gIHByaXZhdGUgZ2VuZXJhdGVDZm5SZWdleGVzQ29uZmlnKCk6IElSZXNvbHZhYmxlIHtcbiAgICByZXR1cm4gTGF6eS5hbnkoXG4gICAgICB7XG4gICAgICAgIHByb2R1Y2U6ICgpID0+IHtcbiAgICAgICAgICByZXR1cm4gdGhpcy5yZWdleEZpbHRlcnMuZmxhdE1hcCgocmVnZXg6IGZpbHRlcnMuUmVnZXhGaWx0ZXIpID0+IHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgIG5hbWU6IHJlZ2V4Lm5hbWUsXG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiByZWdleC5kZXNjcmlwdGlvbixcbiAgICAgICAgICAgICAgcGF0dGVybjogcmVnZXgucGF0dGVybixcbiAgICAgICAgICAgICAgYWN0aW9uOiByZWdleC5hY3Rpb24sXG4gICAgICAgICAgICAgIGlucHV0QWN0aW9uOiByZWdleC5pbnB1dEFjdGlvbixcbiAgICAgICAgICAgICAgaW5wdXRFbmFibGVkOiByZWdleC5pbnB1dEVuYWJsZWQsXG4gICAgICAgICAgICAgIG91dHB1dEFjdGlvbjogcmVnZXgub3V0cHV0QWN0aW9uLFxuICAgICAgICAgICAgICBvdXRwdXRFbmFibGVkOiByZWdleC5vdXRwdXRFbmFibGVkLFxuICAgICAgICAgICAgfSBhcyBiZWRyb2NrLkNmbkd1YXJkcmFpbC5SZWdleENvbmZpZ1Byb3BlcnR5O1xuICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuICAgICAgfSxcbiAgICAgIHsgb21pdEVtcHR5QXJyYXk6IHRydWUgfSxcbiAgICApO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgdGhlIFBpaSBmaWx0ZXJzIGFwcGxpZWQgdG8gdGhlIGd1YXJkcmFpbC4gVGhpcyBtZXRob2QgZGVmZXJzIHRoZSBjb21wdXRhdGlvblxuICAgKiB0byBzeW50aCB0aW1lLlxuICAgKi9cbiAgcHJpdmF0ZSBnZW5lcmF0ZUNmblBpaUVudGl0aWVzQ29uZmlnKCk6IElSZXNvbHZhYmxlIHtcbiAgICByZXR1cm4gTGF6eS5hbnkoXG4gICAgICB7XG4gICAgICAgIHByb2R1Y2U6ICgpID0+IHtcbiAgICAgICAgICByZXR1cm4gdGhpcy5waWlGaWx0ZXJzLmZsYXRNYXAoKGZpbHRlcjogZmlsdGVycy5QSUlGaWx0ZXIpID0+IHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgIHR5cGU6IGZpbHRlci50eXBlLnZhbHVlLFxuICAgICAgICAgICAgICBhY3Rpb246IGZpbHRlci5hY3Rpb24sXG4gICAgICAgICAgICAgIGlucHV0QWN0aW9uOiBmaWx0ZXIuaW5wdXRBY3Rpb24sXG4gICAgICAgICAgICAgIGlucHV0RW5hYmxlZDogZmlsdGVyLmlucHV0RW5hYmxlZCxcbiAgICAgICAgICAgICAgb3V0cHV0QWN0aW9uOiBmaWx0ZXIub3V0cHV0QWN0aW9uLFxuICAgICAgICAgICAgICBvdXRwdXRFbmFibGVkOiBmaWx0ZXIub3V0cHV0RW5hYmxlZCxcbiAgICAgICAgICAgIH0gYXMgYmVkcm9jay5DZm5HdWFyZHJhaWwuUGlpRW50aXR5Q29uZmlnUHJvcGVydHk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAgeyBvbWl0RW1wdHlBcnJheTogdHJ1ZSB9LFxuICAgICk7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyB0aGUgY3Jvc3MtcmVnaW9uIGNvbmZpZ3VyYXRpb24gZm9yIHRoZSBndWFyZHJhaWwuIFRoaXMgbWV0aG9kIGRlZmVycyB0aGUgY29tcHV0YXRpb25cbiAgICogdG8gc3ludGggdGltZS5cbiAgICovXG4gIHByaXZhdGUgZ2VuZXJhdGVDZm5Dcm9zc1JlZ2lvbkNvbmZpZygpOiBJUmVzb2x2YWJsZSB7XG4gICAgcmV0dXJuIExhenkuYW55KHtcbiAgICAgIHByb2R1Y2U6ICgpID0+IHtcbiAgICAgICAgaWYgKHRoaXMuY3Jvc3NSZWdpb25Db25maWcpIHtcbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgZ3VhcmRyYWlsUHJvZmlsZUFybjogdGhpcy5jcm9zc1JlZ2lvbkNvbmZpZy5ndWFyZHJhaWxQcm9maWxlQXJuLFxuICAgICAgICAgIH0gYXMgYmVkcm9jay5DZm5HdWFyZHJhaWwuR3VhcmRyYWlsQ3Jvc3NSZWdpb25Db25maWdQcm9wZXJ0eTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFZhbGlkYXRlcyBhIFJlZ2V4RmlsdGVyIG9iamVjdCBhbmQgYXBwbGllcyBkZWZhdWx0IHZhbHVlcyBmb3Igb3B0aW9uYWwgcHJvcGVydGllcy5cbiAgICogQHBhcmFtIGZpbHRlciBUaGUgcmVnZXggZmlsdGVyIHRvIHZhbGlkYXRlLlxuICAgKiBAcGFyYW0gaW5kZXggT3B0aW9uYWwgaW5kZXggZm9yIGVycm9yIG1lc3NhZ2VzIHdoZW4gdmFsaWRhdGluZyBhcnJheXMuXG4gICAqL1xuICBwcml2YXRlIHZhbGlkYXRlUmVnZXhGaWx0ZXIoZmlsdGVyOiBmaWx0ZXJzLlJlZ2V4RmlsdGVyLCBpbmRleD86IG51bWJlcik6IHZvaWQge1xuICAgIGNvbnN0IHByZWZpeCA9IGluZGV4ICE9PSB1bmRlZmluZWQgPyBgSW52YWxpZCBSZWdleEZpbHRlciBhdCBpbmRleCAke2luZGV4fWAgOiAnSW52YWxpZCBSZWdleEZpbHRlcic7XG5cbiAgICAvLyBWYWxpZGF0ZSBuYW1lOiBiZXR3ZWVuIDEgYW5kIDEwMCBjaGFyYWN0ZXJzXG4gICAgaWYgKGZpbHRlci5uYW1lICE9PSB1bmRlZmluZWQgJiYgIVRva2VuLmlzVW5yZXNvbHZlZChmaWx0ZXIubmFtZSkpIHtcbiAgICAgIGlmIChmaWx0ZXIubmFtZS5sZW5ndGggPCAxKSB7XG4gICAgICAgIHRocm93IG5ldyBWYWxpZGF0aW9uRXJyb3IoYCR7cHJlZml4fTogVGhlIGZpZWxkIG5hbWUgaXMgJHtmaWx0ZXIubmFtZS5sZW5ndGh9IGNoYXJhY3RlcnMgbG9uZyBidXQgbXVzdCBiZSBhdCBsZWFzdCAxIGNoYXJhY3RlcnNgLCB0aGlzKTtcbiAgICAgIH1cbiAgICAgIGlmIChmaWx0ZXIubmFtZS5sZW5ndGggPiAxMDApIHtcbiAgICAgICAgdGhyb3cgbmV3IFZhbGlkYXRpb25FcnJvcihgJHtwcmVmaXh9OiBUaGUgZmllbGQgbmFtZSBpcyAke2ZpbHRlci5uYW1lLmxlbmd0aH0gY2hhcmFjdGVycyBsb25nIGJ1dCBtdXN0IGJlIGxlc3MgdGhhbiBvciBlcXVhbCB0byAxMDAgY2hhcmFjdGVyc2AsIHRoaXMpO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIFZhbGlkYXRlIGRlc2NyaXB0aW9uOiBiZXR3ZWVuIDEgYW5kIDEwMDAgY2hhcmFjdGVycyAoaWYgcHJvdmlkZWQpXG4gICAgaWYgKGZpbHRlci5kZXNjcmlwdGlvbiAhPT0gdW5kZWZpbmVkICYmICFUb2tlbi5pc1VucmVzb2x2ZWQoZmlsdGVyLmRlc2NyaXB0aW9uKSkge1xuICAgICAgaWYgKGZpbHRlci5kZXNjcmlwdGlvbi5sZW5ndGggPCAxKSB7XG4gICAgICAgIHRocm93IG5ldyBWYWxpZGF0aW9uRXJyb3IoYCR7cHJlZml4fTogVGhlIGZpZWxkIGRlc2NyaXB0aW9uIGlzICR7ZmlsdGVyLmRlc2NyaXB0aW9uLmxlbmd0aH0gY2hhcmFjdGVycyBsb25nIGJ1dCBtdXN0IGJlIGF0IGxlYXN0IDEgY2hhcmFjdGVyc2AsIHRoaXMpO1xuICAgICAgfVxuICAgICAgaWYgKGZpbHRlci5kZXNjcmlwdGlvbi5sZW5ndGggPiAxMDAwKSB7XG4gICAgICAgIHRocm93IG5ldyBWYWxpZGF0aW9uRXJyb3IoYCR7cHJlZml4fTogVGhlIGZpZWxkIGRlc2NyaXB0aW9uIGlzICR7ZmlsdGVyLmRlc2NyaXB0aW9uLmxlbmd0aH0gY2hhcmFjdGVycyBsb25nIGJ1dCBtdXN0IGJlIGxlc3MgdGhhbiBvciBlcXVhbCB0byAxMDAwIGNoYXJhY3RlcnNgLCB0aGlzKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBWYWxpZGF0ZSBwYXR0ZXJuOiBhdCBsZWFzdCBvbmUgY2hhcmFjdGVyXG4gICAgaWYgKGZpbHRlci5wYXR0ZXJuICE9PSB1bmRlZmluZWQgJiYgIVRva2VuLmlzVW5yZXNvbHZlZChmaWx0ZXIucGF0dGVybikpIHtcbiAgICAgIGlmIChmaWx0ZXIucGF0dGVybi5sZW5ndGggPCAxKSB7XG4gICAgICAgIHRocm93IG5ldyBWYWxpZGF0aW9uRXJyb3IoYCR7cHJlZml4fTogVGhlIGZpZWxkIHBhdHRlcm4gaXMgJHtmaWx0ZXIucGF0dGVybi5sZW5ndGh9IGNoYXJhY3RlcnMgbG9uZyBidXQgbXVzdCBiZSBhdCBsZWFzdCAxIGNoYXJhY3RlcnNgLCB0aGlzKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBWYWxpZGF0ZSBhY3Rpb246IG11c3QgYmUgYSB2YWxpZCBHdWFyZHJhaWxBY3Rpb24gdmFsdWVcbiAgICBpZiAoZmlsdGVyLmFjdGlvbiAhPT0gdW5kZWZpbmVkICYmICFUb2tlbi5pc1VucmVzb2x2ZWQoZmlsdGVyLmFjdGlvbikgJiYgIU9iamVjdC52YWx1ZXMoZmlsdGVycy5HdWFyZHJhaWxBY3Rpb24pLmluY2x1ZGVzKGZpbHRlci5hY3Rpb24pKSB7XG4gICAgICB0aHJvdyBuZXcgVmFsaWRhdGlvbkVycm9yKGAke3ByZWZpeH06IGFjdGlvbiBtdXN0IGJlIGEgdmFsaWQgR3VhcmRyYWlsQWN0aW9uIHZhbHVlYCwgdGhpcyk7XG4gICAgfVxuXG4gICAgLy8gVmFsaWRhdGUgaW5wdXRBY3Rpb246IG11c3QgYmUgYSB2YWxpZCBHdWFyZHJhaWxBY3Rpb24gdmFsdWUgKGlmIHByb3ZpZGVkKVxuICAgIGlmIChmaWx0ZXIuaW5wdXRBY3Rpb24gIT09IHVuZGVmaW5lZCAmJlxuICAgICAgICAhVG9rZW4uaXNVbnJlc29sdmVkKGZpbHRlci5pbnB1dEFjdGlvbikgJiZcbiAgICAgICAgIU9iamVjdC52YWx1ZXMoZmlsdGVycy5HdWFyZHJhaWxBY3Rpb24pLmluY2x1ZGVzKGZpbHRlci5pbnB1dEFjdGlvbikpIHtcbiAgICAgIHRocm93IG5ldyBWYWxpZGF0aW9uRXJyb3IoYCR7cHJlZml4fTogaW5wdXRBY3Rpb24gbXVzdCBiZSBhIHZhbGlkIEd1YXJkcmFpbEFjdGlvbiB2YWx1ZWAsIHRoaXMpO1xuICAgIH1cblxuICAgIC8vIFZhbGlkYXRlIG91dHB1dEFjdGlvbjogbXVzdCBiZSBhIHZhbGlkIEd1YXJkcmFpbEFjdGlvbiB2YWx1ZSAoaWYgcHJvdmlkZWQpXG4gICAgaWYgKGZpbHRlci5vdXRwdXRBY3Rpb24gIT09IHVuZGVmaW5lZCAmJlxuICAgICAgICAhVG9rZW4uaXNVbnJlc29sdmVkKGZpbHRlci5vdXRwdXRBY3Rpb24pICYmXG4gICAgICAgICFPYmplY3QudmFsdWVzKGZpbHRlcnMuR3VhcmRyYWlsQWN0aW9uKS5pbmNsdWRlcyhmaWx0ZXIub3V0cHV0QWN0aW9uKSkge1xuICAgICAgdGhyb3cgbmV3IFZhbGlkYXRpb25FcnJvcihgJHtwcmVmaXh9OiBvdXRwdXRBY3Rpb24gbXVzdCBiZSBhIHZhbGlkIEd1YXJkcmFpbEFjdGlvbiB2YWx1ZWAsIHRoaXMpO1xuICAgIH1cblxuICAgIC8vIFZhbGlkYXRlIGlucHV0RW5hYmxlZDogbXVzdCBiZSBhIGJvb2xlYW4gKGlmIHByb3ZpZGVkKVxuICAgIGlmIChmaWx0ZXIuaW5wdXRFbmFibGVkICE9PSB1bmRlZmluZWQgJiZcbiAgICAgICAgIVRva2VuLmlzVW5yZXNvbHZlZChmaWx0ZXIuaW5wdXRFbmFibGVkKSAmJlxuICAgICAgICB0eXBlb2YgZmlsdGVyLmlucHV0RW5hYmxlZCAhPT0gJ2Jvb2xlYW4nKSB7XG4gICAgICB0aHJvdyBuZXcgVmFsaWRhdGlvbkVycm9yKGAke3ByZWZpeH06IGlucHV0RW5hYmxlZCBtdXN0IGJlIGEgYm9vbGVhbiB2YWx1ZWAsIHRoaXMpO1xuICAgIH1cblxuICAgIC8vIFZhbGlkYXRlIG91dHB1dEVuYWJsZWQ6IG11c3QgYmUgYSBib29sZWFuIChpZiBwcm92aWRlZClcbiAgICBpZiAoZmlsdGVyLm91dHB1dEVuYWJsZWQgIT09IHVuZGVmaW5lZCAmJlxuICAgICAgICAhVG9rZW4uaXNVbnJlc29sdmVkKGZpbHRlci5vdXRwdXRFbmFibGVkKSAmJlxuICAgICAgICB0eXBlb2YgZmlsdGVyLm91dHB1dEVuYWJsZWQgIT09ICdib29sZWFuJykge1xuICAgICAgdGhyb3cgbmV3IFZhbGlkYXRpb25FcnJvcihgJHtwcmVmaXh9OiBvdXRwdXRFbmFibGVkIG11c3QgYmUgYSBib29sZWFuIHZhbHVlYCwgdGhpcyk7XG4gICAgfVxuXG4gICAgLy8gQXBwbHkgZGVmYXVsdCB2YWx1ZXMgZm9yIG9wdGlvbmFsIHByb3BlcnRpZXMgaWYgbm90IHByb3ZpZGVkXG4gICAgaWYgKGZpbHRlci5pbnB1dEFjdGlvbiA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAoZmlsdGVyIGFzIGFueSkuaW5wdXRBY3Rpb24gPSBmaWx0ZXJzLkd1YXJkcmFpbEFjdGlvbi5CTE9DSztcbiAgICB9XG4gICAgaWYgKGZpbHRlci5pbnB1dEVuYWJsZWQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgKGZpbHRlciBhcyBhbnkpLmlucHV0RW5hYmxlZCA9IHRydWU7XG4gICAgfVxuICAgIGlmIChmaWx0ZXIub3V0cHV0QWN0aW9uID09PSB1bmRlZmluZWQpIHtcbiAgICAgIChmaWx0ZXIgYXMgYW55KS5vdXRwdXRBY3Rpb24gPSBmaWx0ZXJzLkd1YXJkcmFpbEFjdGlvbi5CTE9DSztcbiAgICB9XG4gICAgaWYgKGZpbHRlci5vdXRwdXRFbmFibGVkID09PSB1bmRlZmluZWQpIHtcbiAgICAgIChmaWx0ZXIgYXMgYW55KS5vdXRwdXRFbmFibGVkID0gdHJ1ZTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogVmFsaWRhdGVzIGEgbWVzc2FnaW5nIHByb3BlcnR5IChibG9ja2VkSW5wdXRNZXNzYWdpbmcgb3IgYmxvY2tlZE91dHB1dHNNZXNzYWdpbmcpLlxuICAgKiBAcGFyYW0gdmFsdWUgVGhlIG1lc3NhZ2luZyB2YWx1ZSB0byB2YWxpZGF0ZS5cbiAgICogQHBhcmFtIHByb3BlcnR5TmFtZSBUaGUgbmFtZSBvZiB0aGUgcHJvcGVydHkgYmVpbmcgdmFsaWRhdGVkLlxuICAgKi9cbiAgcHJpdmF0ZSB2YWxpZGF0ZU1lc3NhZ2luZ1Byb3BlcnR5KHZhbHVlOiBzdHJpbmcgfCB1bmRlZmluZWQsIHByb3BlcnR5TmFtZTogc3RyaW5nKTogdm9pZCB7XG4gICAgaWYgKHZhbHVlICE9PSB1bmRlZmluZWQgJiYgIVRva2VuLmlzVW5yZXNvbHZlZCh2YWx1ZSkpIHtcbiAgICAgIGlmICh2YWx1ZS5sZW5ndGggPCAxKSB7XG4gICAgICAgIHRocm93IG5ldyBWYWxpZGF0aW9uRXJyb3IoYEludmFsaWQgJHtwcm9wZXJ0eU5hbWV9OiBUaGUgZmllbGQgJHtwcm9wZXJ0eU5hbWV9IGlzICR7dmFsdWUubGVuZ3RofSBjaGFyYWN0ZXJzIGxvbmcgYnV0IG11c3QgYmUgYXQgbGVhc3QgMSBjaGFyYWN0ZXJzYCwgdGhpcyk7XG4gICAgICB9XG4gICAgICBpZiAodmFsdWUubGVuZ3RoID4gNTAwKSB7XG4gICAgICAgIHRocm93IG5ldyBWYWxpZGF0aW9uRXJyb3IoYEludmFsaWQgJHtwcm9wZXJ0eU5hbWV9OiBUaGUgZmllbGQgJHtwcm9wZXJ0eU5hbWV9IGlzICR7dmFsdWUubGVuZ3RofSBjaGFyYWN0ZXJzIGxvbmcgYnV0IG11c3QgYmUgbGVzcyB0aGFuIG9yIGVxdWFsIHRvIDUwMCBjaGFyYWN0ZXJzYCwgdGhpcyk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFZhbGlkYXRlcyB0aGF0IGNyb3NzLXJlZ2lvbiBjb25maWd1cmF0aW9uIGlzIHByb3ZpZGVkIHdoZW4gU1RBTkRBUkQgdGllciBpcyB1c2VkLlxuICAgKiBAcGFyYW0gcHJvcHMgVGhlIGd1YXJkcmFpbCBwcm9wZXJ0aWVzIHRvIHZhbGlkYXRlLlxuICAgKi9cbiAgcHJpdmF0ZSB2YWxpZGF0ZVRpZXJDb25maWd1cmF0aW9uKHByb3BzOiBHdWFyZHJhaWxQcm9wcyk6IHZvaWQge1xuICAgIGNvbnN0IGNvbnRlbnRUaWVyQ29uZmlnID0gcHJvcHMuY29udGVudEZpbHRlcnNUaWVyQ29uZmlnID8/IGZpbHRlcnMuVGllckNvbmZpZy5DTEFTU0lDO1xuICAgIGNvbnN0IHRvcGljc1RpZXJDb25maWcgPSBwcm9wcy50b3BpY3NUaWVyQ29uZmlnID8/IGZpbHRlcnMuVGllckNvbmZpZy5DTEFTU0lDO1xuICAgIGNvbnN0IGhhc0Nyb3NzUmVnaW9uQ29uZmlnID0gcHJvcHMuY3Jvc3NSZWdpb25Db25maWcgIT09IHVuZGVmaW5lZDtcblxuICAgIC8vIENoZWNrIGlmIFNUQU5EQVJEIHRpZXIgaXMgdXNlZCBmb3IgY29udGVudCBmaWx0ZXJzXG4gICAgaWYgKGNvbnRlbnRUaWVyQ29uZmlnID09PSBmaWx0ZXJzLlRpZXJDb25maWcuU1RBTkRBUkQgJiYgIWhhc0Nyb3NzUmVnaW9uQ29uZmlnKSB7XG4gICAgICB0aHJvdyBuZXcgVmFsaWRhdGlvbkVycm9yKFxuICAgICAgICAnQ3Jvc3MtcmVnaW9uIGNvbmZpZ3VyYXRpb24gaXMgcmVxdWlyZWQgd2hlbiB1c2luZyBTVEFOREFSRCB0aWVyIGZvciBjb250ZW50IGZpbHRlcnMuICcgK1xuICAgICAgICAnUGxlYXNlIHByb3ZpZGUgYSBjcm9zc1JlZ2lvbkNvbmZpZyBwcm9wZXJ0eSB3aXRoIGEgdmFsaWQgZ3VhcmRyYWlsUHJvZmlsZUFybi4nLFxuICAgICAgICB0aGlzLFxuICAgICAgKTtcbiAgICB9XG5cbiAgICAvLyBDaGVjayBpZiBTVEFOREFSRCB0aWVyIGlzIHVzZWQgZm9yIHRvcGljIGZpbHRlcnNcbiAgICBpZiAodG9waWNzVGllckNvbmZpZyA9PT0gZmlsdGVycy5UaWVyQ29uZmlnLlNUQU5EQVJEICYmICFoYXNDcm9zc1JlZ2lvbkNvbmZpZykge1xuICAgICAgdGhyb3cgbmV3IFZhbGlkYXRpb25FcnJvcihcbiAgICAgICAgJ0Nyb3NzLXJlZ2lvbiBjb25maWd1cmF0aW9uIGlzIHJlcXVpcmVkIHdoZW4gdXNpbmcgU1RBTkRBUkQgdGllciBmb3IgdG9waWMgZmlsdGVycy4gJyArXG4gICAgICAgICdQbGVhc2UgcHJvdmlkZSBhIGNyb3NzUmVnaW9uQ29uZmlnIHByb3BlcnR5IHdpdGggYSB2YWxpZCBndWFyZHJhaWxQcm9maWxlQXJuLicsXG4gICAgICAgIHRoaXMsXG4gICAgICApO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBWYWxpZGF0ZXMgY29udGVudCBmaWx0ZXJzIGFycmF5IGFuZCBhcHBsaWVzIGRlZmF1bHQgdmFsdWVzIGZvciBvcHRpb25hbCBwcm9wZXJ0aWVzLlxuICAgKiBAcGFyYW0gY29udGVudEZpbHRlcnMgVGhlIGNvbnRlbnQgZmlsdGVycyB0byB2YWxpZGF0ZS5cbiAgICovXG4gIHByaXZhdGUgdmFsaWRhdGVDb250ZW50RmlsdGVycyhjb250ZW50RmlsdGVycz86IGZpbHRlcnMuQ29udGVudEZpbHRlcltdKTogdm9pZCB7XG4gICAgaWYgKCFjb250ZW50RmlsdGVycykgcmV0dXJuO1xuXG4gICAgY29udGVudEZpbHRlcnMuZm9yRWFjaCgoZmlsdGVyLCBpbmRleCkgPT4ge1xuICAgICAgY29uc3QgcHJlZml4ID0gYEludmFsaWQgQ29udGVudEZpbHRlciBhdCBpbmRleCAke2luZGV4fWA7XG5cbiAgICAgIC8vIFZhbGlkYXRlIHRoYXQgdGhlIGZpbHRlciBoYXMgcmVxdWlyZWQgcHJvcGVydGllc1xuICAgICAgaWYgKCFmaWx0ZXIudHlwZSkge1xuICAgICAgICB0aHJvdyBuZXcgVmFsaWRhdGlvbkVycm9yKGAke3ByZWZpeH06IHR5cGUgaXMgcmVxdWlyZWRgLCB0aGlzKTtcbiAgICAgIH1cblxuICAgICAgLy8gVmFsaWRhdGUgaW5wdXQgc3RyZW5ndGhcbiAgICAgIGlmIChmaWx0ZXIuaW5wdXRTdHJlbmd0aCAhPT0gdW5kZWZpbmVkICYmICFUb2tlbi5pc1VucmVzb2x2ZWQoZmlsdGVyLmlucHV0U3RyZW5ndGgpKSB7XG4gICAgICAgIGlmICghT2JqZWN0LnZhbHVlcyhmaWx0ZXJzLkNvbnRlbnRGaWx0ZXJTdHJlbmd0aCkuaW5jbHVkZXMoZmlsdGVyLmlucHV0U3RyZW5ndGgpKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IFZhbGlkYXRpb25FcnJvcihgJHtwcmVmaXh9OiBpbnB1dFN0cmVuZ3RoIG11c3QgYmUgYSB2YWxpZCBDb250ZW50RmlsdGVyU3RyZW5ndGggdmFsdWVgLCB0aGlzKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBWYWxpZGF0ZSBvdXRwdXQgc3RyZW5ndGhcbiAgICAgIGlmIChmaWx0ZXIub3V0cHV0U3RyZW5ndGggIT09IHVuZGVmaW5lZCAmJiAhVG9rZW4uaXNVbnJlc29sdmVkKGZpbHRlci5vdXRwdXRTdHJlbmd0aCkpIHtcbiAgICAgICAgaWYgKCFPYmplY3QudmFsdWVzKGZpbHRlcnMuQ29udGVudEZpbHRlclN0cmVuZ3RoKS5pbmNsdWRlcyhmaWx0ZXIub3V0cHV0U3RyZW5ndGgpKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IFZhbGlkYXRpb25FcnJvcihgJHtwcmVmaXh9OiBvdXRwdXRTdHJlbmd0aCBtdXN0IGJlIGEgdmFsaWQgQ29udGVudEZpbHRlclN0cmVuZ3RoIHZhbHVlYCwgdGhpcyk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gVmFsaWRhdGUgaW5wdXQgbW9kYWxpdGllc1xuICAgICAgaWYgKGZpbHRlci5pbnB1dE1vZGFsaXRpZXMpIHtcbiAgICAgICAgZmlsdGVyLmlucHV0TW9kYWxpdGllcy5mb3JFYWNoKChtb2RhbGl0eSwgbW9kYWxpdHlJbmRleCkgPT4ge1xuICAgICAgICAgIGlmICghT2JqZWN0LnZhbHVlcyhmaWx0ZXJzLk1vZGFsaXR5VHlwZSkuaW5jbHVkZXMobW9kYWxpdHkpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgVmFsaWRhdGlvbkVycm9yKGAke3ByZWZpeH06IGlucHV0TW9kYWxpdGllc1ske21vZGFsaXR5SW5kZXh9XSBtdXN0IGJlIGEgdmFsaWQgTW9kYWxpdHlUeXBlIHZhbHVlYCwgdGhpcyk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgLy8gVmFsaWRhdGUgb3V0cHV0IG1vZGFsaXRpZXNcbiAgICAgIGlmIChmaWx0ZXIub3V0cHV0TW9kYWxpdGllcykge1xuICAgICAgICBmaWx0ZXIub3V0cHV0TW9kYWxpdGllcy5mb3JFYWNoKChtb2RhbGl0eSwgbW9kYWxpdHlJbmRleCkgPT4ge1xuICAgICAgICAgIGlmICghT2JqZWN0LnZhbHVlcyhmaWx0ZXJzLk1vZGFsaXR5VHlwZSkuaW5jbHVkZXMobW9kYWxpdHkpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgVmFsaWRhdGlvbkVycm9yKGAke3ByZWZpeH06IG91dHB1dE1vZGFsaXRpZXNbJHttb2RhbGl0eUluZGV4fV0gbXVzdCBiZSBhIHZhbGlkIE1vZGFsaXR5VHlwZSB2YWx1ZWAsIHRoaXMpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIC8vIFZhbGlkYXRlIGlucHV0QWN0aW9uOiBtdXN0IGJlIGEgdmFsaWQgR3VhcmRyYWlsQWN0aW9uIHZhbHVlIChpZiBwcm92aWRlZClcbiAgICAgIGlmIChmaWx0ZXIuaW5wdXRBY3Rpb24gIT09IHVuZGVmaW5lZCAmJlxuICAgICAgICAgICFUb2tlbi5pc1VucmVzb2x2ZWQoZmlsdGVyLmlucHV0QWN0aW9uKSAmJlxuICAgICAgICAgICFPYmplY3QudmFsdWVzKGZpbHRlcnMuR3VhcmRyYWlsQWN0aW9uKS5pbmNsdWRlcyhmaWx0ZXIuaW5wdXRBY3Rpb24pKSB7XG4gICAgICAgIHRocm93IG5ldyBWYWxpZGF0aW9uRXJyb3IoYCR7cHJlZml4fTogaW5wdXRBY3Rpb24gbXVzdCBiZSBhIHZhbGlkIEd1YXJkcmFpbEFjdGlvbiB2YWx1ZWAsIHRoaXMpO1xuICAgICAgfVxuXG4gICAgICAvLyBWYWxpZGF0ZSBvdXRwdXRBY3Rpb246IG11c3QgYmUgYSB2YWxpZCBHdWFyZHJhaWxBY3Rpb24gdmFsdWUgKGlmIHByb3ZpZGVkKVxuICAgICAgaWYgKGZpbHRlci5vdXRwdXRBY3Rpb24gIT09IHVuZGVmaW5lZCAmJlxuICAgICAgICAgICFUb2tlbi5pc1VucmVzb2x2ZWQoZmlsdGVyLm91dHB1dEFjdGlvbikgJiZcbiAgICAgICAgICAhT2JqZWN0LnZhbHVlcyhmaWx0ZXJzLkd1YXJkcmFpbEFjdGlvbikuaW5jbHVkZXMoZmlsdGVyLm91dHB1dEFjdGlvbikpIHtcbiAgICAgICAgdGhyb3cgbmV3IFZhbGlkYXRpb25FcnJvcihgJHtwcmVmaXh9OiBvdXRwdXRBY3Rpb24gbXVzdCBiZSBhIHZhbGlkIEd1YXJkcmFpbEFjdGlvbiB2YWx1ZWAsIHRoaXMpO1xuICAgICAgfVxuXG4gICAgICAvLyBWYWxpZGF0ZSBpbnB1dEVuYWJsZWQ6IG11c3QgYmUgYSBib29sZWFuIChpZiBwcm92aWRlZClcbiAgICAgIGlmIChmaWx0ZXIuaW5wdXRFbmFibGVkICE9PSB1bmRlZmluZWQgJiZcbiAgICAgICAgICAhVG9rZW4uaXNVbnJlc29sdmVkKGZpbHRlci5pbnB1dEVuYWJsZWQpICYmXG4gICAgICAgICAgdHlwZW9mIGZpbHRlci5pbnB1dEVuYWJsZWQgIT09ICdib29sZWFuJykge1xuICAgICAgICB0aHJvdyBuZXcgVmFsaWRhdGlvbkVycm9yKGAke3ByZWZpeH06IGlucHV0RW5hYmxlZCBtdXN0IGJlIGEgYm9vbGVhbiB2YWx1ZWAsIHRoaXMpO1xuICAgICAgfVxuXG4gICAgICAvLyBWYWxpZGF0ZSBvdXRwdXRFbmFibGVkOiBtdXN0IGJlIGEgYm9vbGVhbiAoaWYgcHJvdmlkZWQpXG4gICAgICBpZiAoZmlsdGVyLm91dHB1dEVuYWJsZWQgIT09IHVuZGVmaW5lZCAmJlxuICAgICAgICAgICFUb2tlbi5pc1VucmVzb2x2ZWQoZmlsdGVyLm91dHB1dEVuYWJsZWQpICYmXG4gICAgICAgICAgdHlwZW9mIGZpbHRlci5vdXRwdXRFbmFibGVkICE9PSAnYm9vbGVhbicpIHtcbiAgICAgICAgdGhyb3cgbmV3IFZhbGlkYXRpb25FcnJvcihgJHtwcmVmaXh9OiBvdXRwdXRFbmFibGVkIG11c3QgYmUgYSBib29sZWFuIHZhbHVlYCwgdGhpcyk7XG4gICAgICB9XG5cbiAgICAgIC8vIEFwcGx5IGRlZmF1bHQgdmFsdWVzIGZvciBvcHRpb25hbCBwcm9wZXJ0aWVzIGlmIG5vdCBwcm92aWRlZFxuICAgICAgaWYgKGZpbHRlci5pbnB1dEFjdGlvbiA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIChmaWx0ZXIgYXMgYW55KS5pbnB1dEFjdGlvbiA9IGZpbHRlcnMuR3VhcmRyYWlsQWN0aW9uLkJMT0NLO1xuICAgICAgfVxuICAgICAgaWYgKGZpbHRlci5pbnB1dEVuYWJsZWQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAoZmlsdGVyIGFzIGFueSkuaW5wdXRFbmFibGVkID0gdHJ1ZTtcbiAgICAgIH1cbiAgICAgIGlmIChmaWx0ZXIub3V0cHV0QWN0aW9uID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgKGZpbHRlciBhcyBhbnkpLm91dHB1dEFjdGlvbiA9IGZpbHRlcnMuR3VhcmRyYWlsQWN0aW9uLkJMT0NLO1xuICAgICAgfVxuICAgICAgaWYgKGZpbHRlci5vdXRwdXRFbmFibGVkID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgKGZpbHRlciBhcyBhbnkpLm91dHB1dEVuYWJsZWQgPSB0cnVlO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFZhbGlkYXRlcyBQSUkgZmlsdGVycyBhcnJheSBhbmQgYXBwbGllcyBkZWZhdWx0IHZhbHVlcyBmb3Igb3B0aW9uYWwgcHJvcGVydGllcy5cbiAgICogQHBhcmFtIHBpaUZpbHRlcnMgVGhlIFBJSSBmaWx0ZXJzIHRvIHZhbGlkYXRlLlxuICAgKi9cbiAgcHJpdmF0ZSB2YWxpZGF0ZVBpaUZpbHRlcnMocGlpRmlsdGVycz86IGZpbHRlcnMuUElJRmlsdGVyW10pOiB2b2lkIHtcbiAgICBpZiAoIXBpaUZpbHRlcnMpIHJldHVybjtcblxuICAgIHBpaUZpbHRlcnMuZm9yRWFjaCgoZmlsdGVyLCBpbmRleCkgPT4ge1xuICAgICAgY29uc3QgcHJlZml4ID0gYEludmFsaWQgUElJRmlsdGVyIGF0IGluZGV4ICR7aW5kZXh9YDtcblxuICAgICAgLy8gVmFsaWRhdGUgdGhhdCB0aGUgZmlsdGVyIGhhcyByZXF1aXJlZCBwcm9wZXJ0aWVzXG4gICAgICBpZiAoIWZpbHRlci50eXBlKSB7XG4gICAgICAgIHRocm93IG5ldyBWYWxpZGF0aW9uRXJyb3IoYCR7cHJlZml4fTogdHlwZSBpcyByZXF1aXJlZGAsIHRoaXMpO1xuICAgICAgfVxuXG4gICAgICBpZiAoIWZpbHRlci5hY3Rpb24pIHtcbiAgICAgICAgdGhyb3cgbmV3IFZhbGlkYXRpb25FcnJvcihgJHtwcmVmaXh9OiBhY3Rpb24gaXMgcmVxdWlyZWRgLCB0aGlzKTtcbiAgICAgIH1cblxuICAgICAgLy8gVmFsaWRhdGUgYWN0aW9uIHZhbHVlc1xuICAgICAgaWYgKCFUb2tlbi5pc1VucmVzb2x2ZWQoZmlsdGVyLmFjdGlvbikgJiYgIU9iamVjdC52YWx1ZXMoZmlsdGVycy5HdWFyZHJhaWxBY3Rpb24pLmluY2x1ZGVzKGZpbHRlci5hY3Rpb24pKSB7XG4gICAgICAgIHRocm93IG5ldyBWYWxpZGF0aW9uRXJyb3IoYCR7cHJlZml4fTogYWN0aW9uIG11c3QgYmUgYSB2YWxpZCBHdWFyZHJhaWxBY3Rpb24gdmFsdWVgLCB0aGlzKTtcbiAgICAgIH1cblxuICAgICAgaWYgKGZpbHRlci5pbnB1dEFjdGlvbiAmJlxuICAgICAgICAgICFUb2tlbi5pc1VucmVzb2x2ZWQoZmlsdGVyLmlucHV0QWN0aW9uKSAmJlxuICAgICAgICAgICFPYmplY3QudmFsdWVzKGZpbHRlcnMuR3VhcmRyYWlsQWN0aW9uKS5pbmNsdWRlcyhmaWx0ZXIuaW5wdXRBY3Rpb24pKSB7XG4gICAgICAgIHRocm93IG5ldyBWYWxpZGF0aW9uRXJyb3IoYCR7cHJlZml4fTogaW5wdXRBY3Rpb24gbXVzdCBiZSBhIHZhbGlkIEd1YXJkcmFpbEFjdGlvbiB2YWx1ZWAsIHRoaXMpO1xuICAgICAgfVxuXG4gICAgICBpZiAoZmlsdGVyLm91dHB1dEFjdGlvbiAmJlxuICAgICAgICAgICFUb2tlbi5pc1VucmVzb2x2ZWQoZmlsdGVyLm91dHB1dEFjdGlvbikgJiZcbiAgICAgICAgICAhT2JqZWN0LnZhbHVlcyhmaWx0ZXJzLkd1YXJkcmFpbEFjdGlvbikuaW5jbHVkZXMoZmlsdGVyLm91dHB1dEFjdGlvbikpIHtcbiAgICAgICAgdGhyb3cgbmV3IFZhbGlkYXRpb25FcnJvcihgJHtwcmVmaXh9OiBvdXRwdXRBY3Rpb24gbXVzdCBiZSBhIHZhbGlkIEd1YXJkcmFpbEFjdGlvbiB2YWx1ZWAsIHRoaXMpO1xuICAgICAgfVxuXG4gICAgICAvLyBWYWxpZGF0ZSBpbnB1dEVuYWJsZWQ6IG11c3QgYmUgYSBib29sZWFuIChpZiBwcm92aWRlZClcbiAgICAgIGlmIChmaWx0ZXIuaW5wdXRFbmFibGVkICE9PSB1bmRlZmluZWQgJiZcbiAgICAgICAgICAhVG9rZW4uaXNVbnJlc29sdmVkKGZpbHRlci5pbnB1dEVuYWJsZWQpICYmXG4gICAgICAgICAgdHlwZW9mIGZpbHRlci5pbnB1dEVuYWJsZWQgIT09ICdib29sZWFuJykge1xuICAgICAgICB0aHJvdyBuZXcgVmFsaWRhdGlvbkVycm9yKGAke3ByZWZpeH06IGlucHV0RW5hYmxlZCBtdXN0IGJlIGEgYm9vbGVhbiB2YWx1ZWAsIHRoaXMpO1xuICAgICAgfVxuXG4gICAgICAvLyBWYWxpZGF0ZSBvdXRwdXRFbmFibGVkOiBtdXN0IGJlIGEgYm9vbGVhbiAoaWYgcHJvdmlkZWQpXG4gICAgICBpZiAoZmlsdGVyLm91dHB1dEVuYWJsZWQgIT09IHVuZGVmaW5lZCAmJlxuICAgICAgICAgICFUb2tlbi5pc1VucmVzb2x2ZWQoZmlsdGVyLm91dHB1dEVuYWJsZWQpICYmXG4gICAgICAgICAgdHlwZW9mIGZpbHRlci5vdXRwdXRFbmFibGVkICE9PSAnYm9vbGVhbicpIHtcbiAgICAgICAgdGhyb3cgbmV3IFZhbGlkYXRpb25FcnJvcihgJHtwcmVmaXh9OiBvdXRwdXRFbmFibGVkIG11c3QgYmUgYSBib29sZWFuIHZhbHVlYCwgdGhpcyk7XG4gICAgICB9XG5cbiAgICAgIC8vIEFwcGx5IGRlZmF1bHQgdmFsdWVzIGZvciBvcHRpb25hbCBwcm9wZXJ0aWVzIGlmIG5vdCBwcm92aWRlZFxuICAgICAgaWYgKGZpbHRlci5pbnB1dEFjdGlvbiA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIChmaWx0ZXIgYXMgYW55KS5pbnB1dEFjdGlvbiA9IGZpbHRlcnMuR3VhcmRyYWlsQWN0aW9uLkJMT0NLO1xuICAgICAgfVxuICAgICAgaWYgKGZpbHRlci5pbnB1dEVuYWJsZWQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAoZmlsdGVyIGFzIGFueSkuaW5wdXRFbmFibGVkID0gdHJ1ZTtcbiAgICAgIH1cbiAgICAgIGlmIChmaWx0ZXIub3V0cHV0QWN0aW9uID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgKGZpbHRlciBhcyBhbnkpLm91dHB1dEFjdGlvbiA9IGZpbHRlcnMuR3VhcmRyYWlsQWN0aW9uLkJMT0NLO1xuICAgICAgfVxuICAgICAgaWYgKGZpbHRlci5vdXRwdXRFbmFibGVkID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgKGZpbHRlciBhcyBhbnkpLm91dHB1dEVuYWJsZWQgPSB0cnVlO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFZhbGlkYXRlcyByZWdleCBmaWx0ZXJzIGFycmF5LlxuICAgKiBAcGFyYW0gcmVnZXhGaWx0ZXJzIFRoZSByZWdleCBmaWx0ZXJzIHRvIHZhbGlkYXRlLlxuICAgKi9cbiAgcHJpdmF0ZSB2YWxpZGF0ZVJlZ2V4RmlsdGVycyhyZWdleEZpbHRlcnM/OiBmaWx0ZXJzLlJlZ2V4RmlsdGVyW10pOiB2b2lkIHtcbiAgICBpZiAoIXJlZ2V4RmlsdGVycykgcmV0dXJuO1xuXG4gICAgcmVnZXhGaWx0ZXJzLmZvckVhY2goKGZpbHRlciwgaW5kZXgpID0+IHtcbiAgICAgIHRoaXMudmFsaWRhdGVSZWdleEZpbHRlcihmaWx0ZXIsIGluZGV4KTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBWYWxpZGF0ZXMgZGVuaWVkIHRvcGljcyBhcnJheSBhbmQgYXBwbGllcyBkZWZhdWx0IHZhbHVlcyBmb3Igb3B0aW9uYWwgcHJvcGVydGllcy5cbiAgICogQHBhcmFtIGRlbmllZFRvcGljcyBUaGUgZGVuaWVkIHRvcGljcyB0byB2YWxpZGF0ZS5cbiAgICovXG4gIHByaXZhdGUgdmFsaWRhdGVEZW5pZWRUb3BpY3MoZGVuaWVkVG9waWNzPzogZmlsdGVycy5Ub3BpY1tdKTogdm9pZCB7XG4gICAgaWYgKCFkZW5pZWRUb3BpY3MpIHJldHVybjtcblxuICAgIGRlbmllZFRvcGljcy5mb3JFYWNoKCh0b3BpYywgaW5kZXgpID0+IHtcbiAgICAgIGNvbnN0IHByZWZpeCA9IGBJbnZhbGlkIFRvcGljIGF0IGluZGV4ICR7aW5kZXh9YDtcblxuICAgICAgLy8gVmFsaWRhdGUgdGhhdCB0aGUgdG9waWMgaGFzIHJlcXVpcmVkIHByb3BlcnRpZXNcbiAgICAgIGlmICghdG9waWMubmFtZSkge1xuICAgICAgICB0aHJvdyBuZXcgVmFsaWRhdGlvbkVycm9yKGAke3ByZWZpeH06IG5hbWUgaXMgcmVxdWlyZWRgLCB0aGlzKTtcbiAgICAgIH1cblxuICAgICAgaWYgKCF0b3BpYy5kZWZpbml0aW9uKSB7XG4gICAgICAgIHRocm93IG5ldyBWYWxpZGF0aW9uRXJyb3IoYCR7cHJlZml4fTogZGVmaW5pdGlvbiBpcyByZXF1aXJlZGAsIHRoaXMpO1xuICAgICAgfVxuXG4gICAgICAvLyBWYWxpZGF0ZSBuYW1lIGxlbmd0aFxuICAgICAgaWYgKCFUb2tlbi5pc1VucmVzb2x2ZWQodG9waWMubmFtZSkgJiYgdG9waWMubmFtZS5sZW5ndGggPiAxMDApIHtcbiAgICAgICAgdGhyb3cgbmV3IFZhbGlkYXRpb25FcnJvcihgJHtwcmVmaXh9OiBuYW1lIG11c3QgYmUgMTAwIGNoYXJhY3RlcnMgb3IgbGVzc2AsIHRoaXMpO1xuICAgICAgfVxuXG4gICAgICAvLyBWYWxpZGF0ZSBkZWZpbml0aW9uIGxlbmd0aFxuICAgICAgaWYgKCFUb2tlbi5pc1VucmVzb2x2ZWQodG9waWMuZGVmaW5pdGlvbikgJiYgdG9waWMuZGVmaW5pdGlvbi5sZW5ndGggPiAxMDAwKSB7XG4gICAgICAgIHRocm93IG5ldyBWYWxpZGF0aW9uRXJyb3IoYCR7cHJlZml4fTogZGVmaW5pdGlvbiBtdXN0IGJlIDEwMDAgY2hhcmFjdGVycyBvciBsZXNzYCwgdGhpcyk7XG4gICAgICB9XG5cbiAgICAgIC8vIFZhbGlkYXRlIGV4YW1wbGVzIGlmIHByb3ZpZGVkXG4gICAgICBpZiAodG9waWMuZXhhbXBsZXMpIHtcbiAgICAgICAgaWYgKHRvcGljLmV4YW1wbGVzLmxlbmd0aCA+IDEwMCkge1xuICAgICAgICAgIHRocm93IG5ldyBWYWxpZGF0aW9uRXJyb3IoYCR7cHJlZml4fTogZXhhbXBsZXMgYXJyYXkgY2Fubm90IGNvbnRhaW4gbW9yZSB0aGFuIDEwMCBleGFtcGxlc2AsIHRoaXMpO1xuICAgICAgICB9XG5cbiAgICAgICAgdG9waWMuZXhhbXBsZXMuZm9yRWFjaCgoZXhhbXBsZSwgZXhhbXBsZUluZGV4KSA9PiB7XG4gICAgICAgICAgaWYgKCFUb2tlbi5pc1VucmVzb2x2ZWQoZXhhbXBsZSkgJiYgZXhhbXBsZS5sZW5ndGggPiAxMDApIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBWYWxpZGF0aW9uRXJyb3IoYCR7cHJlZml4fTogZXhhbXBsZXNbJHtleGFtcGxlSW5kZXh9XSBtdXN0IGJlIDEwMCBjaGFyYWN0ZXJzIG9yIGxlc3NgLCB0aGlzKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICAvLyBWYWxpZGF0ZSBpbnB1dEFjdGlvbjogbXVzdCBiZSBhIHZhbGlkIEd1YXJkcmFpbEFjdGlvbiB2YWx1ZSAoaWYgcHJvdmlkZWQpXG4gICAgICBpZiAodG9waWMuaW5wdXRBY3Rpb24gIT09IHVuZGVmaW5lZCAmJlxuICAgICAgICAgICFUb2tlbi5pc1VucmVzb2x2ZWQodG9waWMuaW5wdXRBY3Rpb24pICYmXG4gICAgICAgICAgIU9iamVjdC52YWx1ZXMoZmlsdGVycy5HdWFyZHJhaWxBY3Rpb24pLmluY2x1ZGVzKHRvcGljLmlucHV0QWN0aW9uKSkge1xuICAgICAgICB0aHJvdyBuZXcgVmFsaWRhdGlvbkVycm9yKGAke3ByZWZpeH06IGlucHV0QWN0aW9uIG11c3QgYmUgYSB2YWxpZCBHdWFyZHJhaWxBY3Rpb24gdmFsdWVgLCB0aGlzKTtcbiAgICAgIH1cblxuICAgICAgLy8gVmFsaWRhdGUgb3V0cHV0QWN0aW9uOiBtdXN0IGJlIGEgdmFsaWQgR3VhcmRyYWlsQWN0aW9uIHZhbHVlIChpZiBwcm92aWRlZClcbiAgICAgIGlmICh0b3BpYy5vdXRwdXRBY3Rpb24gIT09IHVuZGVmaW5lZCAmJlxuICAgICAgICAgICFUb2tlbi5pc1VucmVzb2x2ZWQodG9waWMub3V0cHV0QWN0aW9uKSAmJlxuICAgICAgICAgICFPYmplY3QudmFsdWVzKGZpbHRlcnMuR3VhcmRyYWlsQWN0aW9uKS5pbmNsdWRlcyh0b3BpYy5vdXRwdXRBY3Rpb24pKSB7XG4gICAgICAgIHRocm93IG5ldyBWYWxpZGF0aW9uRXJyb3IoYCR7cHJlZml4fTogb3V0cHV0QWN0aW9uIG11c3QgYmUgYSB2YWxpZCBHdWFyZHJhaWxBY3Rpb24gdmFsdWVgLCB0aGlzKTtcbiAgICAgIH1cblxuICAgICAgLy8gVmFsaWRhdGUgaW5wdXRFbmFibGVkOiBtdXN0IGJlIGEgYm9vbGVhbiAoaWYgcHJvdmlkZWQpXG4gICAgICBpZiAodG9waWMuaW5wdXRFbmFibGVkICE9PSB1bmRlZmluZWQgJiZcbiAgICAgICAgICAhVG9rZW4uaXNVbnJlc29sdmVkKHRvcGljLmlucHV0RW5hYmxlZCkgJiZcbiAgICAgICAgICB0eXBlb2YgdG9waWMuaW5wdXRFbmFibGVkICE9PSAnYm9vbGVhbicpIHtcbiAgICAgICAgdGhyb3cgbmV3IFZhbGlkYXRpb25FcnJvcihgJHtwcmVmaXh9OiBpbnB1dEVuYWJsZWQgbXVzdCBiZSBhIGJvb2xlYW4gdmFsdWVgLCB0aGlzKTtcbiAgICAgIH1cblxuICAgICAgLy8gVmFsaWRhdGUgb3V0cHV0RW5hYmxlZDogbXVzdCBiZSBhIGJvb2xlYW4gKGlmIHByb3ZpZGVkKVxuICAgICAgaWYgKHRvcGljLm91dHB1dEVuYWJsZWQgIT09IHVuZGVmaW5lZCAmJlxuICAgICAgICAgICFUb2tlbi5pc1VucmVzb2x2ZWQodG9waWMub3V0cHV0RW5hYmxlZCkgJiZcbiAgICAgICAgICB0eXBlb2YgdG9waWMub3V0cHV0RW5hYmxlZCAhPT0gJ2Jvb2xlYW4nKSB7XG4gICAgICAgIHRocm93IG5ldyBWYWxpZGF0aW9uRXJyb3IoYCR7cHJlZml4fTogb3V0cHV0RW5hYmxlZCBtdXN0IGJlIGEgYm9vbGVhbiB2YWx1ZWAsIHRoaXMpO1xuICAgICAgfVxuXG4gICAgICAvLyBBcHBseSBkZWZhdWx0IHZhbHVlcyBmb3Igb3B0aW9uYWwgcHJvcGVydGllcyBpZiBub3QgcHJvdmlkZWRcbiAgICAgIGlmICh0b3BpYy5pbnB1dEFjdGlvbiA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICh0b3BpYyBhcyBhbnkpLmlucHV0QWN0aW9uID0gZmlsdGVycy5HdWFyZHJhaWxBY3Rpb24uQkxPQ0s7XG4gICAgICB9XG4gICAgICBpZiAodG9waWMuaW5wdXRFbmFibGVkID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgKHRvcGljIGFzIGFueSkuaW5wdXRFbmFibGVkID0gdHJ1ZTtcbiAgICAgIH1cbiAgICAgIGlmICh0b3BpYy5vdXRwdXRBY3Rpb24gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAodG9waWMgYXMgYW55KS5vdXRwdXRBY3Rpb24gPSBmaWx0ZXJzLkd1YXJkcmFpbEFjdGlvbi5CTE9DSztcbiAgICAgIH1cbiAgICAgIGlmICh0b3BpYy5vdXRwdXRFbmFibGVkID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgKHRvcGljIGFzIGFueSkub3V0cHV0RW5hYmxlZCA9IHRydWU7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogVmFsaWRhdGVzIGNvbnRleHR1YWwgZ3JvdW5kaW5nIGZpbHRlcnMgYXJyYXkgYW5kIGFwcGxpZXMgZGVmYXVsdCB2YWx1ZXMgZm9yIG9wdGlvbmFsIHByb3BlcnRpZXMuXG4gICAqIEBwYXJhbSBjb250ZXh0dWFsR3JvdW5kaW5nRmlsdGVycyBUaGUgY29udGV4dHVhbCBncm91bmRpbmcgZmlsdGVycyB0byB2YWxpZGF0ZS5cbiAgICovXG4gIHByaXZhdGUgdmFsaWRhdGVDb250ZXh0dWFsR3JvdW5kaW5nRmlsdGVycyhjb250ZXh0dWFsR3JvdW5kaW5nRmlsdGVycz86IGZpbHRlcnMuQ29udGV4dHVhbEdyb3VuZGluZ0ZpbHRlcltdKTogdm9pZCB7XG4gICAgaWYgKCFjb250ZXh0dWFsR3JvdW5kaW5nRmlsdGVycykgcmV0dXJuO1xuXG4gICAgY29udGV4dHVhbEdyb3VuZGluZ0ZpbHRlcnMuZm9yRWFjaCgoZmlsdGVyLCBpbmRleCkgPT4ge1xuICAgICAgY29uc3QgcHJlZml4ID0gYEludmFsaWQgQ29udGV4dHVhbEdyb3VuZGluZ0ZpbHRlciBhdCBpbmRleCAke2luZGV4fWA7XG5cbiAgICAgIC8vIFZhbGlkYXRlIHRoYXQgdGhlIGZpbHRlciBoYXMgcmVxdWlyZWQgcHJvcGVydGllc1xuICAgICAgaWYgKCFmaWx0ZXIudHlwZSkge1xuICAgICAgICB0aHJvdyBuZXcgVmFsaWRhdGlvbkVycm9yKGAke3ByZWZpeH06IHR5cGUgaXMgcmVxdWlyZWRgLCB0aGlzKTtcbiAgICAgIH1cblxuICAgICAgaWYgKGZpbHRlci50aHJlc2hvbGQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICB0aHJvdyBuZXcgVmFsaWRhdGlvbkVycm9yKGAke3ByZWZpeH06IHRocmVzaG9sZCBpcyByZXF1aXJlZGAsIHRoaXMpO1xuICAgICAgfVxuXG4gICAgICAvLyBWYWxpZGF0ZSB0eXBlXG4gICAgICBpZiAoIU9iamVjdC52YWx1ZXMoZmlsdGVycy5Db250ZXh0dWFsR3JvdW5kaW5nRmlsdGVyVHlwZSkuaW5jbHVkZXMoZmlsdGVyLnR5cGUpKSB7XG4gICAgICAgIHRocm93IG5ldyBWYWxpZGF0aW9uRXJyb3IoYCR7cHJlZml4fTogdHlwZSBtdXN0IGJlIGEgdmFsaWQgQ29udGV4dHVhbEdyb3VuZGluZ0ZpbHRlclR5cGUgdmFsdWVgLCB0aGlzKTtcbiAgICAgIH1cblxuICAgICAgLy8gVmFsaWRhdGUgdGhyZXNob2xkIHJhbmdlXG4gICAgICBpZiAoIVRva2VuLmlzVW5yZXNvbHZlZChmaWx0ZXIudGhyZXNob2xkKSkge1xuICAgICAgICBpZiAoZmlsdGVyLnRocmVzaG9sZCA8IDAgfHwgZmlsdGVyLnRocmVzaG9sZCA+IDAuOTkpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgVmFsaWRhdGlvbkVycm9yKGAke3ByZWZpeH06IHRocmVzaG9sZCBtdXN0IGJlIGJldHdlZW4gMCBhbmQgMC45OWAsIHRoaXMpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIFZhbGlkYXRlIGFjdGlvbjogbXVzdCBiZSBhIHZhbGlkIEd1YXJkcmFpbEFjdGlvbiB2YWx1ZSAoaWYgcHJvdmlkZWQpXG4gICAgICBpZiAoZmlsdGVyLmFjdGlvbiAhPT0gdW5kZWZpbmVkICYmXG4gICAgICAgICAgIVRva2VuLmlzVW5yZXNvbHZlZChmaWx0ZXIuYWN0aW9uKSAmJlxuICAgICAgICAgICFPYmplY3QudmFsdWVzKGZpbHRlcnMuR3VhcmRyYWlsQWN0aW9uKS5pbmNsdWRlcyhmaWx0ZXIuYWN0aW9uKSkge1xuICAgICAgICB0aHJvdyBuZXcgVmFsaWRhdGlvbkVycm9yKGAke3ByZWZpeH06IGFjdGlvbiBtdXN0IGJlIGEgdmFsaWQgR3VhcmRyYWlsQWN0aW9uIHZhbHVlYCwgdGhpcyk7XG4gICAgICB9XG5cbiAgICAgIC8vIFZhbGlkYXRlIGVuYWJsZWQ6IG11c3QgYmUgYSBib29sZWFuIChpZiBwcm92aWRlZClcbiAgICAgIGlmIChmaWx0ZXIuZW5hYmxlZCAhPT0gdW5kZWZpbmVkICYmXG4gICAgICAgICAgIVRva2VuLmlzVW5yZXNvbHZlZChmaWx0ZXIuZW5hYmxlZCkgJiZcbiAgICAgICAgICB0eXBlb2YgZmlsdGVyLmVuYWJsZWQgIT09ICdib29sZWFuJykge1xuICAgICAgICB0aHJvdyBuZXcgVmFsaWRhdGlvbkVycm9yKGAke3ByZWZpeH06IGVuYWJsZWQgbXVzdCBiZSBhIGJvb2xlYW4gdmFsdWVgLCB0aGlzKTtcbiAgICAgIH1cblxuICAgICAgLy8gQXBwbHkgZGVmYXVsdCB2YWx1ZXMgZm9yIG9wdGlvbmFsIHByb3BlcnRpZXMgaWYgbm90IHByb3ZpZGVkXG4gICAgICBpZiAoZmlsdGVyLmFjdGlvbiA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIChmaWx0ZXIgYXMgYW55KS5hY3Rpb24gPSBmaWx0ZXJzLkd1YXJkcmFpbEFjdGlvbi5CTE9DSztcbiAgICAgIH1cbiAgICAgIGlmIChmaWx0ZXIuZW5hYmxlZCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIChmaWx0ZXIgYXMgYW55KS5lbmFibGVkID0gdHJ1ZTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBWYWxpZGF0ZXMgd29yZCBmaWx0ZXJzIGFycmF5IGFuZCBhcHBsaWVzIGRlZmF1bHQgdmFsdWVzIGZvciBvcHRpb25hbCBwcm9wZXJ0aWVzLlxuICAgKiBAcGFyYW0gd29yZEZpbHRlcnMgVGhlIHdvcmQgZmlsdGVycyB0byB2YWxpZGF0ZS5cbiAgICovXG4gIHByaXZhdGUgdmFsaWRhdGVXb3JkRmlsdGVycyh3b3JkRmlsdGVycz86IGZpbHRlcnMuV29yZEZpbHRlcltdKTogdm9pZCB7XG4gICAgaWYgKCF3b3JkRmlsdGVycykgcmV0dXJuO1xuXG4gICAgd29yZEZpbHRlcnMuZm9yRWFjaCgoZmlsdGVyLCBpbmRleCkgPT4ge1xuICAgICAgY29uc3QgcHJlZml4ID0gYEludmFsaWQgV29yZEZpbHRlciBhdCBpbmRleCAke2luZGV4fWA7XG5cbiAgICAgIC8vIFZhbGlkYXRlIHRoYXQgdGhlIGZpbHRlciBoYXMgcmVxdWlyZWQgcHJvcGVydGllc1xuICAgICAgaWYgKCFmaWx0ZXIudGV4dCkge1xuICAgICAgICB0aHJvdyBuZXcgVmFsaWRhdGlvbkVycm9yKGAke3ByZWZpeH06IHRleHQgaXMgcmVxdWlyZWRgLCB0aGlzKTtcbiAgICAgIH1cblxuICAgICAgLy8gVmFsaWRhdGUgdGV4dCBsZW5ndGhcbiAgICAgIGlmICghVG9rZW4uaXNVbnJlc29sdmVkKGZpbHRlci50ZXh0KSAmJiBmaWx0ZXIudGV4dC5sZW5ndGggPiAxMDApIHtcbiAgICAgICAgdGhyb3cgbmV3IFZhbGlkYXRpb25FcnJvcihgJHtwcmVmaXh9OiB0ZXh0IG11c3QgYmUgMTAwIGNoYXJhY3RlcnMgb3IgbGVzc2AsIHRoaXMpO1xuICAgICAgfVxuXG4gICAgICAvLyBWYWxpZGF0ZSBpbnB1dEFjdGlvbjogbXVzdCBiZSBhIHZhbGlkIEd1YXJkcmFpbEFjdGlvbiB2YWx1ZSAoaWYgcHJvdmlkZWQpXG4gICAgICBpZiAoZmlsdGVyLmlucHV0QWN0aW9uICE9PSB1bmRlZmluZWQgJiZcbiAgICAgICAgICAhVG9rZW4uaXNVbnJlc29sdmVkKGZpbHRlci5pbnB1dEFjdGlvbikgJiZcbiAgICAgICAgICAhT2JqZWN0LnZhbHVlcyhmaWx0ZXJzLkd1YXJkcmFpbEFjdGlvbikuaW5jbHVkZXMoZmlsdGVyLmlucHV0QWN0aW9uKSkge1xuICAgICAgICB0aHJvdyBuZXcgVmFsaWRhdGlvbkVycm9yKGAke3ByZWZpeH06IGlucHV0QWN0aW9uIG11c3QgYmUgYSB2YWxpZCBHdWFyZHJhaWxBY3Rpb24gdmFsdWVgLCB0aGlzKTtcbiAgICAgIH1cblxuICAgICAgLy8gVmFsaWRhdGUgb3V0cHV0QWN0aW9uOiBtdXN0IGJlIGEgdmFsaWQgR3VhcmRyYWlsQWN0aW9uIHZhbHVlIChpZiBwcm92aWRlZClcbiAgICAgIGlmIChmaWx0ZXIub3V0cHV0QWN0aW9uICE9PSB1bmRlZmluZWQgJiZcbiAgICAgICAgICAhVG9rZW4uaXNVbnJlc29sdmVkKGZpbHRlci5vdXRwdXRBY3Rpb24pICYmXG4gICAgICAgICAgIU9iamVjdC52YWx1ZXMoZmlsdGVycy5HdWFyZHJhaWxBY3Rpb24pLmluY2x1ZGVzKGZpbHRlci5vdXRwdXRBY3Rpb24pKSB7XG4gICAgICAgIHRocm93IG5ldyBWYWxpZGF0aW9uRXJyb3IoYCR7cHJlZml4fTogb3V0cHV0QWN0aW9uIG11c3QgYmUgYSB2YWxpZCBHdWFyZHJhaWxBY3Rpb24gdmFsdWVgLCB0aGlzKTtcbiAgICAgIH1cblxuICAgICAgLy8gVmFsaWRhdGUgaW5wdXRFbmFibGVkOiBtdXN0IGJlIGEgYm9vbGVhbiAoaWYgcHJvdmlkZWQpXG4gICAgICBpZiAoZmlsdGVyLmlucHV0RW5hYmxlZCAhPT0gdW5kZWZpbmVkICYmXG4gICAgICAgICAgIVRva2VuLmlzVW5yZXNvbHZlZChmaWx0ZXIuaW5wdXRFbmFibGVkKSAmJlxuICAgICAgICAgIHR5cGVvZiBmaWx0ZXIuaW5wdXRFbmFibGVkICE9PSAnYm9vbGVhbicpIHtcbiAgICAgICAgdGhyb3cgbmV3IFZhbGlkYXRpb25FcnJvcihgJHtwcmVmaXh9OiBpbnB1dEVuYWJsZWQgbXVzdCBiZSBhIGJvb2xlYW4gdmFsdWVgLCB0aGlzKTtcbiAgICAgIH1cblxuICAgICAgLy8gVmFsaWRhdGUgb3V0cHV0RW5hYmxlZDogbXVzdCBiZSBhIGJvb2xlYW4gKGlmIHByb3ZpZGVkKVxuICAgICAgaWYgKGZpbHRlci5vdXRwdXRFbmFibGVkICE9PSB1bmRlZmluZWQgJiZcbiAgICAgICAgICAhVG9rZW4uaXNVbnJlc29sdmVkKGZpbHRlci5vdXRwdXRFbmFibGVkKSAmJlxuICAgICAgICAgIHR5cGVvZiBmaWx0ZXIub3V0cHV0RW5hYmxlZCAhPT0gJ2Jvb2xlYW4nKSB7XG4gICAgICAgIHRocm93IG5ldyBWYWxpZGF0aW9uRXJyb3IoYCR7cHJlZml4fTogb3V0cHV0RW5hYmxlZCBtdXN0IGJlIGEgYm9vbGVhbiB2YWx1ZWAsIHRoaXMpO1xuICAgICAgfVxuXG4gICAgICAvLyBBcHBseSBkZWZhdWx0IHZhbHVlcyBmb3Igb3B0aW9uYWwgcHJvcGVydGllcyBpZiBub3QgcHJvdmlkZWRcbiAgICAgIGlmIChmaWx0ZXIuaW5wdXRBY3Rpb24gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAoZmlsdGVyIGFzIGFueSkuaW5wdXRBY3Rpb24gPSBmaWx0ZXJzLkd1YXJkcmFpbEFjdGlvbi5CTE9DSztcbiAgICAgIH1cbiAgICAgIGlmIChmaWx0ZXIuaW5wdXRFbmFibGVkID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgKGZpbHRlciBhcyBhbnkpLmlucHV0RW5hYmxlZCA9IHRydWU7XG4gICAgICB9XG4gICAgICBpZiAoZmlsdGVyLm91dHB1dEFjdGlvbiA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIChmaWx0ZXIgYXMgYW55KS5vdXRwdXRBY3Rpb24gPSBmaWx0ZXJzLkd1YXJkcmFpbEFjdGlvbi5CTE9DSztcbiAgICAgIH1cbiAgICAgIGlmIChmaWx0ZXIub3V0cHV0RW5hYmxlZCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIChmaWx0ZXIgYXMgYW55KS5vdXRwdXRFbmFibGVkID0gdHJ1ZTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBWYWxpZGF0ZXMgbWFuYWdlZCB3b3JkIGxpc3QgZmlsdGVycyBhcnJheSBhbmQgYXBwbGllcyBkZWZhdWx0IHZhbHVlcyBmb3Igb3B0aW9uYWwgcHJvcGVydGllcy5cbiAgICogQHBhcmFtIG1hbmFnZWRXb3JkTGlzdEZpbHRlcnMgVGhlIG1hbmFnZWQgd29yZCBsaXN0IGZpbHRlcnMgdG8gdmFsaWRhdGUuXG4gICAqL1xuICBwcml2YXRlIHZhbGlkYXRlTWFuYWdlZFdvcmRMaXN0RmlsdGVycyhtYW5hZ2VkV29yZExpc3RGaWx0ZXJzPzogZmlsdGVycy5NYW5hZ2VkV29yZEZpbHRlcltdKTogdm9pZCB7XG4gICAgaWYgKCFtYW5hZ2VkV29yZExpc3RGaWx0ZXJzKSByZXR1cm47XG5cbiAgICBtYW5hZ2VkV29yZExpc3RGaWx0ZXJzLmZvckVhY2goKGZpbHRlciwgaW5kZXgpID0+IHtcbiAgICAgIGNvbnN0IHByZWZpeCA9IGBJbnZhbGlkIE1hbmFnZWRXb3JkRmlsdGVyIGF0IGluZGV4ICR7aW5kZXh9YDtcblxuICAgICAgLy8gVmFsaWRhdGUgdHlwZTogbXVzdCBiZSBhIHZhbGlkIE1hbmFnZWRXb3JkRmlsdGVyVHlwZSB2YWx1ZSAoaWYgcHJvdmlkZWQpXG4gICAgICBpZiAoZmlsdGVyLnR5cGUgIT09IHVuZGVmaW5lZCAmJiAhT2JqZWN0LnZhbHVlcyhmaWx0ZXJzLk1hbmFnZWRXb3JkRmlsdGVyVHlwZSkuaW5jbHVkZXMoZmlsdGVyLnR5cGUpKSB7XG4gICAgICAgIHRocm93IG5ldyBWYWxpZGF0aW9uRXJyb3IoYCR7cHJlZml4fTogdHlwZSBtdXN0IGJlIGEgdmFsaWQgTWFuYWdlZFdvcmRGaWx0ZXJUeXBlIHZhbHVlYCwgdGhpcyk7XG4gICAgICB9XG5cbiAgICAgIC8vIFZhbGlkYXRlIGlucHV0QWN0aW9uOiBtdXN0IGJlIGEgdmFsaWQgR3VhcmRyYWlsQWN0aW9uIHZhbHVlIChpZiBwcm92aWRlZClcbiAgICAgIGlmIChmaWx0ZXIuaW5wdXRBY3Rpb24gIT09IHVuZGVmaW5lZCAmJlxuICAgICAgICAgICFUb2tlbi5pc1VucmVzb2x2ZWQoZmlsdGVyLmlucHV0QWN0aW9uKSAmJlxuICAgICAgICAgICFPYmplY3QudmFsdWVzKGZpbHRlcnMuR3VhcmRyYWlsQWN0aW9uKS5pbmNsdWRlcyhmaWx0ZXIuaW5wdXRBY3Rpb24pKSB7XG4gICAgICAgIHRocm93IG5ldyBWYWxpZGF0aW9uRXJyb3IoYCR7cHJlZml4fTogaW5wdXRBY3Rpb24gbXVzdCBiZSBhIHZhbGlkIEd1YXJkcmFpbEFjdGlvbiB2YWx1ZWAsIHRoaXMpO1xuICAgICAgfVxuXG4gICAgICAvLyBWYWxpZGF0ZSBvdXRwdXRBY3Rpb246IG11c3QgYmUgYSB2YWxpZCBHdWFyZHJhaWxBY3Rpb24gdmFsdWUgKGlmIHByb3ZpZGVkKVxuICAgICAgaWYgKGZpbHRlci5vdXRwdXRBY3Rpb24gIT09IHVuZGVmaW5lZCAmJlxuICAgICAgICAgICFUb2tlbi5pc1VucmVzb2x2ZWQoZmlsdGVyLm91dHB1dEFjdGlvbikgJiZcbiAgICAgICAgICAhT2JqZWN0LnZhbHVlcyhmaWx0ZXJzLkd1YXJkcmFpbEFjdGlvbikuaW5jbHVkZXMoZmlsdGVyLm91dHB1dEFjdGlvbikpIHtcbiAgICAgICAgdGhyb3cgbmV3IFZhbGlkYXRpb25FcnJvcihgJHtwcmVmaXh9OiBvdXRwdXRBY3Rpb24gbXVzdCBiZSBhIHZhbGlkIEd1YXJkcmFpbEFjdGlvbiB2YWx1ZWAsIHRoaXMpO1xuICAgICAgfVxuXG4gICAgICAvLyBWYWxpZGF0ZSBpbnB1dEVuYWJsZWQ6IG11c3QgYmUgYSBib29sZWFuIChpZiBwcm92aWRlZClcbiAgICAgIGlmIChmaWx0ZXIuaW5wdXRFbmFibGVkICE9PSB1bmRlZmluZWQgJiZcbiAgICAgICAgICAhVG9rZW4uaXNVbnJlc29sdmVkKGZpbHRlci5pbnB1dEVuYWJsZWQpICYmXG4gICAgICAgICAgdHlwZW9mIGZpbHRlci5pbnB1dEVuYWJsZWQgIT09ICdib29sZWFuJykge1xuICAgICAgICB0aHJvdyBuZXcgVmFsaWRhdGlvbkVycm9yKGAke3ByZWZpeH06IGlucHV0RW5hYmxlZCBtdXN0IGJlIGEgYm9vbGVhbiB2YWx1ZWAsIHRoaXMpO1xuICAgICAgfVxuXG4gICAgICAvLyBWYWxpZGF0ZSBvdXRwdXRFbmFibGVkOiBtdXN0IGJlIGEgYm9vbGVhbiAoaWYgcHJvdmlkZWQpXG4gICAgICBpZiAoZmlsdGVyLm91dHB1dEVuYWJsZWQgIT09IHVuZGVmaW5lZCAmJlxuICAgICAgICAgICFUb2tlbi5pc1VucmVzb2x2ZWQoZmlsdGVyLm91dHB1dEVuYWJsZWQpICYmXG4gICAgICAgICAgdHlwZW9mIGZpbHRlci5vdXRwdXRFbmFibGVkICE9PSAnYm9vbGVhbicpIHtcbiAgICAgICAgdGhyb3cgbmV3IFZhbGlkYXRpb25FcnJvcihgJHtwcmVmaXh9OiBvdXRwdXRFbmFibGVkIG11c3QgYmUgYSBib29sZWFuIHZhbHVlYCwgdGhpcyk7XG4gICAgICB9XG5cbiAgICAgIC8vIEFwcGx5IGRlZmF1bHQgdmFsdWVzIGZvciBvcHRpb25hbCBwcm9wZXJ0aWVzIGlmIG5vdCBwcm92aWRlZFxuICAgICAgaWYgKGZpbHRlci50eXBlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgKGZpbHRlciBhcyBhbnkpLnR5cGUgPSBmaWx0ZXJzLk1hbmFnZWRXb3JkRmlsdGVyVHlwZS5QUk9GQU5JVFk7XG4gICAgICB9XG4gICAgICBpZiAoZmlsdGVyLmlucHV0QWN0aW9uID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgKGZpbHRlciBhcyBhbnkpLmlucHV0QWN0aW9uID0gZmlsdGVycy5HdWFyZHJhaWxBY3Rpb24uQkxPQ0s7XG4gICAgICB9XG4gICAgICBpZiAoZmlsdGVyLmlucHV0RW5hYmxlZCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIChmaWx0ZXIgYXMgYW55KS5pbnB1dEVuYWJsZWQgPSB0cnVlO1xuICAgICAgfVxuICAgICAgaWYgKGZpbHRlci5vdXRwdXRBY3Rpb24gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAoZmlsdGVyIGFzIGFueSkub3V0cHV0QWN0aW9uID0gZmlsdGVycy5HdWFyZHJhaWxBY3Rpb24uQkxPQ0s7XG4gICAgICB9XG4gICAgICBpZiAoZmlsdGVyLm91dHB1dEVuYWJsZWQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAoZmlsdGVyIGFzIGFueSkub3V0cHV0RW5hYmxlZCA9IHRydWU7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogVmFsaWRhdGVzIGEgc2luZ2xlIGNvbnRlbnQgZmlsdGVyIGFuZCBhcHBsaWVzIGRlZmF1bHQgdmFsdWVzIGZvciBvcHRpb25hbCBwcm9wZXJ0aWVzLlxuICAgKiBAcGFyYW0gZmlsdGVyIFRoZSBjb250ZW50IGZpbHRlciB0byB2YWxpZGF0ZS5cbiAgICovXG4gIHByaXZhdGUgdmFsaWRhdGVTaW5nbGVDb250ZW50RmlsdGVyKGZpbHRlcjogZmlsdGVycy5Db250ZW50RmlsdGVyKTogdm9pZCB7XG4gICAgLy8gVXNlIHRoZSBleGlzdGluZyB2YWxpZGF0aW9uIGxvZ2ljIGJ1dCBjYXRjaCBhbmQgcmUtdGhyb3cgd2l0aCBhIGNsZWFyZXIgZXJyb3IgbWVzc2FnZVxuICAgIHRyeSB7XG4gICAgICB0aGlzLnZhbGlkYXRlQ29udGVudEZpbHRlcnMoW2ZpbHRlcl0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBWYWxpZGF0aW9uRXJyb3IpIHtcbiAgICAgICAgLy8gUmVwbGFjZSBcImF0IGluZGV4IDBcIiB3aXRoIGEgY2xlYXJlciBtZXNzYWdlIGZvciBzaW5nbGUgZmlsdGVyIHZhbGlkYXRpb25cbiAgICAgICAgY29uc3QgbWVzc2FnZSA9IGVycm9yLm1lc3NhZ2UucmVwbGFjZSgnIGF0IGluZGV4IDAnLCAnJyk7XG4gICAgICAgIHRocm93IG5ldyBWYWxpZGF0aW9uRXJyb3IobWVzc2FnZSwgdGhpcyk7XG4gICAgICB9XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogVmFsaWRhdGVzIGEgc2luZ2xlIFBJSSBmaWx0ZXIgYW5kIGFwcGxpZXMgZGVmYXVsdCB2YWx1ZXMgZm9yIG9wdGlvbmFsIHByb3BlcnRpZXMuXG4gICAqIEBwYXJhbSBmaWx0ZXIgVGhlIFBJSSBmaWx0ZXIgdG8gdmFsaWRhdGUuXG4gICAqL1xuICBwcml2YXRlIHZhbGlkYXRlU2luZ2xlUGlpRmlsdGVyKGZpbHRlcjogZmlsdGVycy5QSUlGaWx0ZXIpOiB2b2lkIHtcbiAgICAvLyBVc2UgdGhlIGV4aXN0aW5nIHZhbGlkYXRpb24gbG9naWMgYnV0IGNhdGNoIGFuZCByZS10aHJvdyB3aXRoIGEgY2xlYXJlciBlcnJvciBtZXNzYWdlXG4gICAgdHJ5IHtcbiAgICAgIHRoaXMudmFsaWRhdGVQaWlGaWx0ZXJzKFtmaWx0ZXJdKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgaWYgKGVycm9yIGluc3RhbmNlb2YgVmFsaWRhdGlvbkVycm9yKSB7XG4gICAgICAgIC8vIFJlcGxhY2UgXCJhdCBpbmRleCAwXCIgd2l0aCBhIGNsZWFyZXIgbWVzc2FnZSBmb3Igc2luZ2xlIGZpbHRlciB2YWxpZGF0aW9uXG4gICAgICAgIGNvbnN0IG1lc3NhZ2UgPSBlcnJvci5tZXNzYWdlLnJlcGxhY2UoJyBhdCBpbmRleCAwJywgJycpO1xuICAgICAgICB0aHJvdyBuZXcgVmFsaWRhdGlvbkVycm9yKG1lc3NhZ2UsIHRoaXMpO1xuICAgICAgfVxuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFZhbGlkYXRlcyBhIHNpbmdsZSByZWdleCBmaWx0ZXIgYW5kIGFwcGxpZXMgZGVmYXVsdCB2YWx1ZXMgZm9yIG9wdGlvbmFsIHByb3BlcnRpZXMuXG4gICAqIEBwYXJhbSBmaWx0ZXIgVGhlIHJlZ2V4IGZpbHRlciB0byB2YWxpZGF0ZS5cbiAgICovXG4gIHByaXZhdGUgdmFsaWRhdGVTaW5nbGVSZWdleEZpbHRlcihmaWx0ZXI6IGZpbHRlcnMuUmVnZXhGaWx0ZXIpOiB2b2lkIHtcbiAgICAvLyBVc2UgdGhlIGV4aXN0aW5nIHZhbGlkYXRpb24gbG9naWMgYnV0IGNhdGNoIGFuZCByZS10aHJvdyB3aXRoIGEgY2xlYXJlciBlcnJvciBtZXNzYWdlXG4gICAgdHJ5IHtcbiAgICAgIHRoaXMudmFsaWRhdGVSZWdleEZpbHRlcnMoW2ZpbHRlcl0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBWYWxpZGF0aW9uRXJyb3IpIHtcbiAgICAgICAgLy8gUmVwbGFjZSBcImF0IGluZGV4IDBcIiB3aXRoIGEgY2xlYXJlciBtZXNzYWdlIGZvciBzaW5nbGUgZmlsdGVyIHZhbGlkYXRpb25cbiAgICAgICAgY29uc3QgbWVzc2FnZSA9IGVycm9yLm1lc3NhZ2UucmVwbGFjZSgnIGF0IGluZGV4IDAnLCAnJyk7XG4gICAgICAgIHRocm93IG5ldyBWYWxpZGF0aW9uRXJyb3IobWVzc2FnZSwgdGhpcyk7XG4gICAgICB9XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogVmFsaWRhdGVzIGEgc2luZ2xlIGRlbmllZCB0b3BpYyBhbmQgYXBwbGllcyBkZWZhdWx0IHZhbHVlcyBmb3Igb3B0aW9uYWwgcHJvcGVydGllcy5cbiAgICogQHBhcmFtIGZpbHRlciBUaGUgZGVuaWVkIHRvcGljIHRvIHZhbGlkYXRlLlxuICAgKi9cbiAgcHJpdmF0ZSB2YWxpZGF0ZVNpbmdsZURlbmllZFRvcGljKGZpbHRlcjogZmlsdGVycy5Ub3BpYyk6IHZvaWQge1xuICAgIC8vIFVzZSB0aGUgZXhpc3RpbmcgdmFsaWRhdGlvbiBsb2dpYyBidXQgY2F0Y2ggYW5kIHJlLXRocm93IHdpdGggYSBjbGVhcmVyIGVycm9yIG1lc3NhZ2VcbiAgICB0cnkge1xuICAgICAgdGhpcy52YWxpZGF0ZURlbmllZFRvcGljcyhbZmlsdGVyXSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIFZhbGlkYXRpb25FcnJvcikge1xuICAgICAgICAvLyBSZXBsYWNlIFwiYXQgaW5kZXggMFwiIHdpdGggYSBjbGVhcmVyIG1lc3NhZ2UgZm9yIHNpbmdsZSBmaWx0ZXIgdmFsaWRhdGlvblxuICAgICAgICBjb25zdCBtZXNzYWdlID0gZXJyb3IubWVzc2FnZS5yZXBsYWNlKCcgYXQgaW5kZXggMCcsICcnKTtcbiAgICAgICAgdGhyb3cgbmV3IFZhbGlkYXRpb25FcnJvcihtZXNzYWdlLCB0aGlzKTtcbiAgICAgIH1cbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBWYWxpZGF0ZXMgYSBzaW5nbGUgY29udGV4dHVhbCBncm91bmRpbmcgZmlsdGVyIGFuZCBhcHBsaWVzIGRlZmF1bHQgdmFsdWVzIGZvciBvcHRpb25hbCBwcm9wZXJ0aWVzLlxuICAgKiBAcGFyYW0gZmlsdGVyIFRoZSBjb250ZXh0dWFsIGdyb3VuZGluZyBmaWx0ZXIgdG8gdmFsaWRhdGUuXG4gICAqL1xuICBwcml2YXRlIHZhbGlkYXRlU2luZ2xlQ29udGV4dHVhbEdyb3VuZGluZ0ZpbHRlcihmaWx0ZXI6IGZpbHRlcnMuQ29udGV4dHVhbEdyb3VuZGluZ0ZpbHRlcik6IHZvaWQge1xuICAgIC8vIFVzZSB0aGUgZXhpc3RpbmcgdmFsaWRhdGlvbiBsb2dpYyBidXQgY2F0Y2ggYW5kIHJlLXRocm93IHdpdGggYSBjbGVhcmVyIGVycm9yIG1lc3NhZ2VcbiAgICB0cnkge1xuICAgICAgdGhpcy52YWxpZGF0ZUNvbnRleHR1YWxHcm91bmRpbmdGaWx0ZXJzKFtmaWx0ZXJdKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgaWYgKGVycm9yIGluc3RhbmNlb2YgVmFsaWRhdGlvbkVycm9yKSB7XG4gICAgICAgIC8vIFJlcGxhY2UgXCJhdCBpbmRleCAwXCIgd2l0aCBhIGNsZWFyZXIgbWVzc2FnZSBmb3Igc2luZ2xlIGZpbHRlciB2YWxpZGF0aW9uXG4gICAgICAgIGNvbnN0IG1lc3NhZ2UgPSBlcnJvci5tZXNzYWdlLnJlcGxhY2UoJyBhdCBpbmRleCAwJywgJycpO1xuICAgICAgICB0aHJvdyBuZXcgVmFsaWRhdGlvbkVycm9yKG1lc3NhZ2UsIHRoaXMpO1xuICAgICAgfVxuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFZhbGlkYXRlcyBhIHNpbmdsZSB3b3JkIGZpbHRlciBhbmQgYXBwbGllcyBkZWZhdWx0IHZhbHVlcyBmb3Igb3B0aW9uYWwgcHJvcGVydGllcy5cbiAgICogQHBhcmFtIGZpbHRlciBUaGUgd29yZCBmaWx0ZXIgdG8gdmFsaWRhdGUuXG4gICAqL1xuICBwcml2YXRlIHZhbGlkYXRlU2luZ2xlV29yZEZpbHRlcihmaWx0ZXI6IGZpbHRlcnMuV29yZEZpbHRlcik6IHZvaWQge1xuICAgIC8vIFVzZSB0aGUgZXhpc3RpbmcgdmFsaWRhdGlvbiBsb2dpYyBidXQgY2F0Y2ggYW5kIHJlLXRocm93IHdpdGggYSBjbGVhcmVyIGVycm9yIG1lc3NhZ2VcbiAgICB0cnkge1xuICAgICAgdGhpcy52YWxpZGF0ZVdvcmRGaWx0ZXJzKFtmaWx0ZXJdKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgaWYgKGVycm9yIGluc3RhbmNlb2YgVmFsaWRhdGlvbkVycm9yKSB7XG4gICAgICAgIC8vIFJlcGxhY2UgXCJhdCBpbmRleCAwXCIgd2l0aCBhIGNsZWFyZXIgbWVzc2FnZSBmb3Igc2luZ2xlIGZpbHRlciB2YWxpZGF0aW9uXG4gICAgICAgIGNvbnN0IG1lc3NhZ2UgPSBlcnJvci5tZXNzYWdlLnJlcGxhY2UoJyBhdCBpbmRleCAwJywgJycpO1xuICAgICAgICB0aHJvdyBuZXcgVmFsaWRhdGlvbkVycm9yKG1lc3NhZ2UsIHRoaXMpO1xuICAgICAgfVxuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFZhbGlkYXRlcyBhIHNpbmdsZSBtYW5hZ2VkIHdvcmQgbGlzdCBmaWx0ZXIgYW5kIGFwcGxpZXMgZGVmYXVsdCB2YWx1ZXMgZm9yIG9wdGlvbmFsIHByb3BlcnRpZXMuXG4gICAqIEBwYXJhbSBmaWx0ZXIgVGhlIG1hbmFnZWQgd29yZCBsaXN0IGZpbHRlciB0byB2YWxpZGF0ZS5cbiAgICovXG4gIHByaXZhdGUgdmFsaWRhdGVTaW5nbGVNYW5hZ2VkV29yZExpc3RGaWx0ZXIoZmlsdGVyOiBmaWx0ZXJzLk1hbmFnZWRXb3JkRmlsdGVyKTogdm9pZCB7XG4gICAgLy8gVXNlIHRoZSBleGlzdGluZyB2YWxpZGF0aW9uIGxvZ2ljIGJ1dCBjYXRjaCBhbmQgcmUtdGhyb3cgd2l0aCBhIGNsZWFyZXIgZXJyb3IgbWVzc2FnZVxuICAgIHRyeSB7XG4gICAgICB0aGlzLnZhbGlkYXRlTWFuYWdlZFdvcmRMaXN0RmlsdGVycyhbZmlsdGVyXSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIFZhbGlkYXRpb25FcnJvcikge1xuICAgICAgICAvLyBSZXBsYWNlIFwiYXQgaW5kZXggMFwiIHdpdGggYSBjbGVhcmVyIG1lc3NhZ2UgZm9yIHNpbmdsZSBmaWx0ZXIgdmFsaWRhdGlvblxuICAgICAgICBjb25zdCBtZXNzYWdlID0gZXJyb3IubWVzc2FnZS5yZXBsYWNlKCcgYXQgaW5kZXggMCcsICcnKTtcbiAgICAgICAgdGhyb3cgbmV3IFZhbGlkYXRpb25FcnJvcihtZXNzYWdlLCB0aGlzKTtcbiAgICAgIH1cbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfVxufVxuIl19